(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{1462:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n(0),o=n.n(r),a=n(1441),i=n(1442),c=n.n(i),l=n(1496),s=n.n(l);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var n=m(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function m(e,t){if(null==e)return{};var n={},r=Object.keys(e),o,a;for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),e}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}function g(e,t){return(g=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function v(e){var t=_();return function n(){var r=O(e),o;if(t){var a=O(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return E(this,o)}}function E(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?w(e):t}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var S=function(e){b(n,e);var t=v(n);function n(){return d(this,n),t.apply(this,arguments)}return h(n,[{key:"render",value:function e(){var t=this.props,n=t.fileName,r=t.className,i=p(t,["fileName","className"]),c=a.a(n),l=a.a("demo.text");return o.a.createElement("span",f({className:"".concat(r," ").concat(c||l," file-name-icon")},i))}}]),n}(o.a.Component)},1471:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n(0),o=n.n(r),a=n(1),i=n.n(a),c=n(166),l=n.n(c),s=n(1481),u=n.n(s);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),e}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function b(e){var t=E();return function n(){var r=w(e),o;if(t){var a=w(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return g(this,o)}}function g(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?v(e):t}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var _=a.Tag.Colorable,O=function(e){y(n,e);var t=b(n);function n(){return p(this,n),t.apply(this,arguments)}return d(n,[{key:"render",value:function e(){var t;return this.props.hasAvatar?o.a.createElement(o.a.Fragment,null,o.a.createElement(l.a,{image:"https://img.alicdn.com/tfs/TB1WYSpIQL0gK0jSZFtXXXQCXXa-400-401.png",text:"\u4e91\u8c46",needAddedText:!0,size:"xs"}),o.a.createElement("span",{className:"log-item-title-author-tag"},o.a.createElement(_,{color:"gray"},"bot"))):o.a.createElement("span",{className:"yundou-name-inline"},"\u4e91\u8c46",o.a.createElement("span",{className:"log-item-title-author-tag"},o.a.createElement(_,{color:"gray"},"bot")))}}]),n}(o.a.PureComponent)},1481:function(e,t,n){},1493:function(e,t,n){},1496:function(e,t,n){},1501:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var r=n(0),o=n.n(r),a=n(3),i=n.n(a),c=n(1502),l=n.n(c);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function y(e){var t=g();return function n(){var r=v(e),o;if(t){var a=v(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return h(this,o)}}function h(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?b(e):t}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(e){m(n,e);var t=y(n);function n(){return u(this,n),t.apply(this,arguments)}return p(n,[{key:"render",value:function e(){var t=this.props,n=t.pictureUrl,r=t.title,a=t.desc,i="message-page";return o.a.createElement("div",{className:i},o.a.createElement("img",{className:"".concat(i,"-img"),src:n,alt:r}),r?o.a.createElement("div",{className:"".concat(i,"-title")},r):null,a?o.a.createElement("div",{className:"".concat(i,"-desc")},a):null)}}]),n}(o.a.Component);E(w,"propTypes",{pictureUrl:i.a.string,title:i.a.string,desc:i.a.string}),E(w,"defaultProps",{pictureUrl:"",title:"",desc:""})},1502:function(e,t,n){},1503:function(e,t,n){},1504:function(e,t,n){},1505:function(e,t,n){},1506:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var r=n(0),o=n.n(r),a=n(47),i=n.n(a),c=n(1),l=n.n(c),s=n(1622),u=n.n(s);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),e}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function b(e){var t=E();return function n(){var r=w(e),o;if(t){var a=w(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return g(this,o)}}function g(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?v(e):t}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function O(e,t){return T(e)||N(e,t)||R(e,t)||S()}function S(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function R(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function N(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var r=[],o=!0,a=!1,i,c;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(e){a=!0,c=e}finally{try{o||null==n.return||n.return()}finally{if(a)throw c}}return r}}function T(e){if(Array.isArray(e))return e}function k(e){var t=e.comment,n=e.maxWidth,r=void 0===n?"100px":n;if(!t)return null;var a=t.line,l=t.side,s=t.path,u=t.outdated,f="";if(s&&u&&t.range_context){var p,m=O(t.range_context.split(" "),2),d=m[0],y=m[1];d&&!y&&(y=d),y&&!d&&(d=y),f="&from_commit=".concat(d,"&to_commit=").concat(y)}var h=t.path?t.path.split("."):[];if(!t.path)return null;var b=o.a.createElement(c.Button,{component:"a",className:"line-info-href",text:!0,type:"primary"},o.a.createElement("span",{className:"one-line-ellipsis line-info-pathname",title:h[0],style:{maxWidth:r}},h[0]),!!h[1]&&o.a.createElement("span",{style:{display:"inline-block",verticalAlign:"middle"}},".",h[1]));return u&&"issue"===t._comment_type?b:o.a.createElement("span",null,u?o.a.createElement(j,{updateData:e.updateData,trigger:b,hash:"#file=".concat(i()(t.path)).concat(f)}):o.a.createElement(c.Button,{component:"a",type:"primary",className:"line-info-href",text:!0,onClick:function n(r){r.preventDefault(),t.is_draft&&e.closeDropdown&&e.closeDropdown();var o=window.location.hash,c="#file=".concat(i()(t.path),"&line=").concat(a,"&side=").concat(l).concat(f),s=document.getElementById("anchor_line_".concat(i()(t.path),"_").concat(l,"_").concat(a));if(o===c&&s){var u=document.querySelector("#mr-content-body"),p=s.offsetParent?s.offsetParent.offsetTop:0;u.scrollTop=s.offsetTop+p}else window.location.hash=c}},o.a.createElement("span",{className:"one-line-ellipsis line-info-pathname",title:h[0],style:{maxWidth:r}},h[0]),o.a.createElement("span",{style:{display:"inline-block",verticalAlign:"middle"}},!!h[1]&&o.a.createElement("span",null,".",h[1]),"\xa0 \xb7 \xa0",o.a.createElement("span",null,"\u7b2c",a,"\u884c"))))}var j=function(e){y(n,e);var t=b(n);function n(){var e;p(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return _(v(e=t.call.apply(t,[this].concat(o))),"state",{visible:!1}),_(v(e),"onCancel",(function(){e.setState({visible:!1})})),_(v(e),"onConfirm",(function(){e.setState({visible:!1}),e.props.updateData&&e.props.updateData({isShowComment:!1}),window.location.hash=e.props.hash})),_(v(e),"onVisibleChange",(function(t){e.setState({visible:t})})),e}return d(n,[{key:"render",value:function e(){var t=this.state.visible;return o.a.createElement(c.Balloon.PopConfirm,{triggerType:"click",align:"b",title:"",content:"\u8bc4\u8bba\u5df2\u8fc7\u671f\uff0c\u662f\u5426\u9700\u8981\u5207\u6362\u5230\u53d1\u5e03\u8be5\u8bc4\u8bba\u7684\u63d0\u4ea4\u7248\u672c\uff1f",onConfirm:this.onConfirm,onCancel:this.onCancel,visible:t,onVisibleChange:this.onVisibleChange,trigger:this.props.trigger,followTrigger:!0,size:"small"})}}]),n}(o.a.Component)},1514:function(e,t,n){"use strict";var r=n(0),o=n(1503);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function u(e,t){return(u=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function f(e){var t=d();return function n(){var r=y(e),o;if(t){var a=y(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return p(this,o)}}function p(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?m(e):t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b,g=function(e){s(n,e);var t=f(n);function n(e){var o;return i(this,n),h(m(o=t.call(this,e)),"scrollToMyRef",(function(){o.myRef&&o.myRef.current&&o.myRef.current.scrollIntoView({behavior:"smooth"})})),o.state={},o.myRef=r.createRef(),o}return l(n,[{key:"componentDidMount",value:function e(){console.log("current",this.myRef.current),this.scrollToMyRef()}},{key:"render",value:function e(){var t=this.props,n=t.message,o=t.shine;return r.createElement("div",{className:"YunDouTalk",ref:this.myRef},r.createElement("div",{className:"YunDouIcon"}),r.createElement("div",{className:"YunDouMessage".concat(o?"YunDouMessageShine":"")},n.map((function(e,t){return r.createElement("div",{key:t},e.title&&r.createElement("div",{className:"YunDouMessageTitle"},e.title),e.content&&r.createElement("div",{className:"YunDouMessageContent"},e.content))}))))}}]),n}(r.Component),v=n(1504),E=n(1432);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t,n){return t&&O(e.prototype,t),n&&O(e,n),e}function R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}function C(e,t){return(C=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function N(e){var t=j();return function n(){var r=P(e),o;if(t){var a=P(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return T(this,o)}}function T(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?k(e):t}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var B,D=function(e){R(n,e);var t=N(n);function n(e){var o;return _(this,n),x(k(o=t.call(this,e)),"getOffsetTop",(function(e){var t=document.getElementById("step-".concat(e));return t&&t.offsetTop})),x(k(o),"scrollSmooth",(function(e){var t=o.getOffsetTop(e);t&&t>88&&Object(E.a)("#step-".concat(e),{offset:-(Number(t)-88)})})),x(k(o),"scrollToMyRef",(function(){o.myRef&&o.myRef.current&&o.myRef.current.scrollIntoView({behavior:"smooth"})})),o.state={clickedButton:null},o.myRef=r.createRef(),o}return S(n,[{key:"componentDidMount",value:function e(){this.scrollToMyRef()}},{key:"componentDidUpdate",value:function e(){this.scrollToMyRef()}},{key:"render",value:function e(){var t=this,n=this.props,o=n.messageType,a=n.content,i=n.onClickType1,c=n.onClickType2;return r.createElement("div",{className:"SelfTalk",id:this.props.id,ref:this.myRef},"MESSAGE"===o&&r.createElement("div",{className:"SelfTalkTypeMessage"},a[0]),"BUTTON"===o&&r.createElement(r.Fragment,null,1===this.state.clickedButton?r.createElement("div",{className:"SelfTalkTypeMessage"},"\u4e00\u952e\u4fee\u590d"===a[0]?"\u52a9\u624b\u5e2e\u6211\u4fee\u590d\u4e00\u4e0b":a[0]):r.createElement("div",{className:"SelfTalkTypeButton",onClick:function e(){i&&i(),t.setState({clickedButton:1})}},a[0])),"BUTTONS"===o&&r.createElement("div",{className:"SelfTalkTypeButtons"},1===this.state.clickedButton?r.createElement("div",{className:"SelfTalkTypeMessage"},a[0]):r.createElement(r.Fragment,null,2!==this.state.clickedButton&&r.createElement("div",{className:"SelfTalkTypeButtonsItem",onClick:function e(){i&&i(),t.setState({clickedButton:1})}},a[0])),2===this.state.clickedButton?r.createElement("div",{className:"SelfTalkTypeMessage"},a[1]):r.createElement(r.Fragment,null,1!==this.state.clickedButton&&r.createElement("div",{className:"SelfTalkTypeButtonsItem",onClick:function e(){c&&c(),t.setState({clickedButton:2})}},a[1]))))}}]),n}(r.Component),I=n(1),L=n(1505);function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e,t,n){return t&&F(e.prototype,t),n&&F(e,n),e}function V(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}function q(e,t){return(q=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function W(e){var t=U();return function n(){var r=X(e),o;if(t){var a=X(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return H(this,o)}}function H(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?K(e):t}function K(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function X(e){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var J="Lead",Y=function(e){V(n,e);var t=W(n);function n(e){var o;return z(this,n),G(K(o=t.call(this,e)),"clearStyles",(function(){o.setState({leftStyle:null,rightStyle:null,bottomStyle:null,topStyle:null})})),G(K(o),"renderStyles",(function(){var e=document.getElementById("theia-main-content-panel"),t=document.getElementsByClassName("lineHighlightDecoration"),n=document.body.clientWidth,r=document.body.clientHeight;if(e&&t){for(var a=t.length,i=[],c=[],l=0;l<a;l++)i.push(t[l].getBoundingClientRect().top),c.push(t[l].getBoundingClientRect().bottom);i.sort((function(e,t){return e-t})),c.sort((function(e,t){return t-e}));var s,u=e.getBoundingClientRect().left,f=n-t[0].getBoundingClientRect().right,p=i[0],m=r-c[0];o.setState({leftStyle:{width:u},rightStyle:{width:f},bottomStyle:{width:n-u-f,left:u,height:m},topStyle:{left:u,height:p,width:n-u-f}});var d={leftStyle:{width:u},rightStyle:{width:f},bottomStyle:{width:n-u-f,left:u,height:m},topStyle:{left:u,height:p,width:n-u-f}};console.log("lead a",d)}})),G(K(o),"leadSteps",[{id:0,left:{message:[{title:r.createElement("span",null,"\u6211\u8fd8\u6709\u5176\u4ed6\u80fd\u529b\u54e6",r.createElement("br",null),"\u56db\u5927\u6838\u5fc3\u80fd\u529b\u5b88\u62a4\u4f60\u7684\u4ee3\u7801")},{content:r.createElement("div",null,r.createElement("div",null,r.createElement(I.Icon,{type:"tick",className:"doc-func-tick"}),r.createElement("span",{className:"doc-func-item"},"\u4ee3\u7801\u6258\u7ba1"),r.createElement(I.Icon,{type:"tick",className:"doc-func-tick",style:{marginLeft:34}}),r.createElement("span",{className:"doc-func-item"},"\u5b89\u5168\u68c0\u6d4b")),r.createElement("div",{style:{marginTop:8}},r.createElement(I.Icon,{type:"tick",className:"doc-func-tick"}),r.createElement("span",{className:"doc-func-item"},"\u667a\u80fd\u8bc4\u5ba1"),r.createElement(I.Icon,{type:"tick",className:"doc-func-tick",style:{marginLeft:34}}),r.createElement("span",{className:"doc-func-item"},"\u6587\u6863\u7ba1\u7406")))},{content:r.createElement("div",{className:"doc-desc"},r.createElement("span",{className:"doc-desc-content"},r.createElement("span",{dangerouslySetInnerHTML:{__html:"&#128079"}})," ","\u9650\u65f6\u4f18\u60e0~\u4e0d\u9650\u5bb9\u91cf\u548c\u4eba\u6570"))}]}},{id:1,right:{messageType:"BUTTONS",content:["\u4e0d\u4e86\uff0c\u8c22\u8c22","\u514d\u8d39\u4f7f\u7528"],onClickType1:function e(){setTimeout((function(){o.updateStep(2),setTimeout((function(){o.props.onClose&&o.props.onClose()}),3e3)}),500)},onClickType2:function e(){window.open("https://accountid-devops.aliyun.com/create-org?appId=5e730cf2201d20d717988e46&channel=yy_1024","_blank"),o.props.onClose&&o.props.onClose()}}},{id:2,left:{message:[{title:"\u6536\u5230~\u6211\u5148\u64a4\u4e86"},{content:"\u6709\u95ee\u9898\u968f\u65f6\u6233\u6211\u54e6"}]}}]),G(K(o),"getOffsetTop",(function(e){var t=document.getElementById("step-".concat(e));return t&&t.offsetTop})),G(K(o),"scrollSmooth",(function(e){var t=o.getOffsetTop(e);t&&t>88&&Object(E.a)("#step-".concat(e),{offset:-(Number(t)-88)})})),G(K(o),"updateStep",(function(e){if(e){var t=o.state.steps;t.push(o.leadSteps[e]),o.setState({steps:t,currentStep:e}),o.scrollSmooth(e)}else{var n=o.state.steps;n.push(o.leadSteps[o.state.currentStep]),o.setState({steps:n,currentStep:o.state.currentStep+1}),o.scrollSmooth(o.state.currentStep)}})),o.state={steps:[],currentStep:0,leftStyle:null,rightStyle:null,bottomStyle:null,topStyle:null},o}return A(n,[{key:"componentDidMount",value:function e(){var t=this;this.props.onStart&&this.props.onStart(),this.updateStep(),setTimeout((function(){t.updateStep()}),1e3)}},{key:"render",value:function e(){return r.createElement("div",{className:"Lead",id:"leadPage"},r.createElement("div",{className:"LeadMaskLeft LeadMask",style:this.state.leftStyle}),r.createElement("div",{className:"LeadMaskTop LeadMask",style:this.state.topStyle}),r.createElement("div",{className:"LeadMaskRight LeadMask",style:this.state.rightStyle}),r.createElement("div",{className:"LeadMaskBottom LeadMask",style:this.state.bottomStyle}),r.createElement("div",{className:"LeadBox",id:"leadBox"},this.state.steps.map((function(e){return r.createElement(r.Fragment,null,e.left&&r.createElement("div",{className:"LeadMessage LeadMessageLeft",key:e.id,id:"step-".concat(e.id,"-wrap")},r.createElement(g,{message:e.left.message,shine:e.shine})),e.right&&r.createElement("div",{className:"LeadMessage LeadMessageRight",key:e.id,id:"step-".concat(e.id,"-wrap")},r.createElement(D,{messageType:e.right.messageType,content:e.right.content,onClickType1:e.right.onClickType1,onClickType2:e.right.onClickType2,id:"step-".concat(e.id)})))}))))}}]),n}(r.Component),Q=t.a=Y},1515:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(0),o=n.n(r),a=n(1);function i(e){return 0===e?"".concat(5,"%"):e>1e4?"100%":(e<=10?(t=1,n=10,r=4,o=20):e<=100?(t=11,n=100,r=20,o=40):e<=1e3?(t=101,n=1e3,r=40,o=60):(t=1001,n=1e4,r=60,o=80),"".concat(((e-t)*(o-r)/(n-t)+r)/80*100,"%"));var t,n,r,o,a}var c=n(1493);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}function m(e,t){return(m=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function d(e){var t=b();return function n(){var r=g(e),o;if(t){var a=g(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return y(this,o)}}function y(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?h(e):t}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var v=function(e){p(n,e);var t=d(n);function n(){return s(this,n),t.apply(this,arguments)}return f(n,[{key:"render",value:function e(){var t=this.props,n=t.info,r=t.style,c=t.targetBranch;return o.a.createElement(a.Balloon.Tooltip,{trigger:o.a.createElement("div",{className:"branch-commit-order",style:r},o.a.createElement("div",{className:"branch-commit-order-before"},o.a.createElement("div",{className:"txt"},o.a.createElement("span",{className:"order-badge"},n.behind)),0===n.behind?o.a.createElement("div",{className:"border value-zero"}," "):o.a.createElement("span",null,o.a.createElement("div",{className:"border",style:{width:i(n.behind)}}," "))),o.a.createElement("div",{className:"branch-commit-order-line"}," "),o.a.createElement("div",{className:"branch-commit-order-after"},o.a.createElement("div",{className:"txt"},o.a.createElement("span",{className:"order-badge"},n.ahead)),0===n.ahead?o.a.createElement("div",{className:"border value-zero"}," "):o.a.createElement("span",null,o.a.createElement("div",{className:"border",style:{width:i(n.ahead)}}," ")))),align:"t",text:"\u8d85\u524d ".concat(c," ").concat(n.ahead," \u4e2a\u63d0\u4ea4\uff0c\u6ede\u540e ").concat(n.behind," \u4e2a\u63d0\u4ea4")})}}]),n}(o.a.Component)},1622:function(e,t,n){},1623:function(e,t,n){},1624:function(e,t,n){},1625:function(e,t,n){},1626:function(e,t,n){},1627:function(e,t,n){},1628:function(e,t,n){},1629:function(e,t,n){},1698:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(16),i=n.n(a),c=n(65),l=n(32),s=n(11),u=n(42),f=n(1),p=n(1423),m=n(8),d=n(19),y=n(1501),h=n(5);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),e}function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}function _(e,t){return(_=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function O(e){var t=C();return function n(){var r=N(e),o;if(t){var a=N(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return S(this,o)}}function S(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?R(e):t}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k=f.Balloon.Tooltip,j=f.Tag.Colorable,P=[{key:"no-fast-forward",title:"\u521b\u5efa\u4e00\u4e2a\u5408\u5e76\u8282\u70b9",desc:"\u603b\u662f\u521b\u5efa\u4e00\u4e2a\u5408\u5e76\u8282\u70b9\uff0c\u8bb0\u5f55\u5408\u5e76\u4fe1\u606f"},{key:"squash",title:"Squash \u5408\u5e76",desc:"\u5c06\u4e00\u4e2a\u6216\u591a\u4e2a\u63d0\u4ea4\u5408\u5e76\u538b\u7f29\u5408\u5e76\u4e3a\u76ee\u6807\u5206\u652f\u4e0a\u7684\u4e00\u4e2a\u63d0\u4ea4"},{key:"rebase",title:"Rebase \u5408\u5e76",desc:"\u5c06\u8bc4\u5ba1\u5206\u652f\u63d0\u4ea4\u9010\u4e00\u7f16\u8f91\u5230\u76ee\u6807\u5206\u652f"},{key:"ff-only",title:"Fast-forward-only \u5408\u5e76",desc:"\u4f7f\u7528 fast-forward-only \u65b9\u5f0f\u5408\u5e76\uff0c\u4e0d\u521b\u5efa\u5408\u5e76\u8282\u70b9"}],x=function(e){w(n,e);var t=O(n);function n(e){var r;return g(this,n),T(R(r=t.call(this,e)),"commitMessage",(function(e){var t=r.props,n=t.codeReviewDetail,o=t.commitHistory,a=n.title,i=n.description,c;switch(e){case"no-fast-forward":c="".concat(a,"\n\n").concat(window.location.origin+window.location.pathname,"  ").concat(i?"\n\n".concat(i):"");break;case"squash":c="".concat(a,"\n\n").concat(window.location.origin+window.location.pathname,"  ").concat(i?"\n\n".concat(i):"","\n\nsquash \u5408\u5e76:\n\n").concat(o&&o.map((function(e){return"* ".concat(e.message)})).join("\n\n"));break;case"ff-only":case"rebase":c=""}r.setState({merge_type:e}),r.field.setValues({merge_commit_message_content:c})})),T(R(r),"onOpen",(function(e){r.setState({visible:!0}),r.commitMessage(e)})),T(R(r),"onDropdownClick",(function(){r.setState({dropdownVisible:!r.state.dropdownVisible})})),T(R(r),"onClose",(function(){r.setState({visible:!1})})),T(R(r),"onFormSave",(function(){r.field.validate((function(e){if(!e){var t=r.field.getValues(),n="".concat(t.merge_commit_message_title,"\n\n").concat(t.merge_commit_message_content);r.props.doMerge({merge_commit_message:n,merge_type:r.state.merge_type,should_remove_source_branch:t.should_remove_source_branch},(function(){r.props.updatePageInfo(window.location.pathname,r.onClose)}))}}))})),T(R(r),"getMergeTypeTitle",(function(){var e=r.state.merge_type,t="";return P.forEach((function(n){n.key===e&&(t=n.title)})),t})),r.field=new f.Field(R(r)),r.state={visible:!1,dropdownVisible:!1,isCommitMsgInputVisible:!0,merge_type:""},r}return E(n,[{key:"renderDefaultTypeTag",value:function e(t){return 0!==t?null:o.a.createElement(j,{size:"small",style:{margin:"0 4px"}},"\u9ed8\u8ba4\u7c7b\u578b")}},{key:"render",value:function e(){var t=this,n=this.props,r=n.codeReviewDetail,a=n.mergeRequestType,i=n.isMerging,c,l,s=(n.mr_ahead_behind_info||{}).support_merge_ff_only,u=r.target_branch,p=this.field.init,m=this.state.merge_type,d=a.map((function(e){return P.find((function(t){return t.key===e}))})),y=o.a.createElement(f.Balloon.Tooltip,{align:"t",trigger:o.a.createElement(f.Button,{type:"primary",onClick:this.onDropdownClick},"\u5408\u5e76")},"\u5df2\u8fbe\u5230\u5408\u5e76\u8981\u6c42"),b=d&&1===d.length,g=d[0]&&"ff-only"===d[0].key&&!s?o.a.createElement(f.Balloon.Tooltip,{align:"t",trigger:o.a.createElement(f.Button,{type:"primary",disabled:!0},"\u5408\u5e76")},"\u76ee\u6807\u5206\u652f\u4e0a\u6709\u63d0\u4ea4\uff0c\u8be5\u5408\u5e76\u8bf7\u6c42\u4e0d\u80fd\u4f7f\u7528 fast-forward \u5408\u5e76"):y,v=this.getMergeTypeTitle();return o.a.createElement(o.a.Fragment,null,b?o.a.createElement("span",{style:{display:"inline-block",height:36},onClick:function e(){t.setState({isCommitMsgInputVisible:!0,visible:!0,merge_type:a[0]}),t.commitMessage(a[0])}},g):o.a.createElement(f.Dropdown,{trigger:o.a.createElement("span",{style:{display:"inline-block",height:36}},y),triggerType:"click",align:"tr br",visible:this.state.dropdownVisible,onVisibleChange:function e(n,r){"docClick"===r&&t.setState({dropdownVisible:n})}},o.a.createElement(f.Menu,{onItemClick:this.onOpen,className:"merge-menu"},d&&d.map((function(e,n){return"ff-only"===e.key?o.a.createElement(f.Menu.Item,{style:{overflow:"visible"},disabled:!s,key:e.key},s?o.a.createElement("div",{className:"merge-menu-item"},o.a.createElement("div",{className:"merge-menu-item-title"},e.title,t.renderDefaultTypeTag(n)),o.a.createElement("div",{className:"merge-menu-item-desc"},e.desc)):o.a.createElement(f.Balloon.Tooltip,{trigger:o.a.createElement("div",{className:"merge-menu-item"},o.a.createElement("div",{className:"merge-menu-item-title"},e.title,t.renderDefaultTypeTag(n)),o.a.createElement("div",{style:{color:"#bfbfbf"},className:"merge-menu-item-desc"},e.desc)),align:"b"},"\u76ee\u6807\u5206\u652f\u4e0a\u6709\u63d0\u4ea4\uff0c\u8be5\u5408\u5e76\u8bf7\u6c42\u4e0d\u80fd\u4f7f\u7528 fast-forward \u5408\u5e76")):o.a.createElement(f.Menu.Item,{key:e.key},o.a.createElement("div",{className:"merge-menu-item"},o.a.createElement("div",{className:"merge-menu-item-title"},e.title,t.renderDefaultTypeTag(n)),o.a.createElement("div",{className:"merge-menu-item-desc"},e.desc)))})))),this.state.isCommitMsgInputVisible&&o.a.createElement(f.Dialog,{title:o.a.createElement(k,{trigger:o.a.createElement("div",{className:"file-form-title"},"\u63d0\u4ea4\u5230"," ",u),align:"t"},o.a.createElement("span",{style:{wordBreak:"break-all"}},"\u63d0\u4ea4\u5230"," ",u)),visible:this.state.visible,onOk:function e(){t.onFormSave()},onCancel:this.onClose,onClose:this.onClose,style:{width:"600px"},okProps:{children:"\u63d0\u4ea4",loading:i},cancelProps:{children:"\u53d6\u6d88"},className:"merge-dialog"},o.a.createElement(f.Form,{labelAlign:"top",direction:"ver",field:this.field,className:"commit-message-form"},o.a.createElement(f.Form.Item,{label:"\u5408\u5e76\u65b9\u5f0f"},v),m&&"rebase"!==m&&"ff-only"!==m&&o.a.createElement(f.Form.Item,{label:"\u63d0\u4ea4"},o.a.createElement(f.Input,p("merge_commit_message_title",{initValue:"merge #".concat(r.id," into ").concat(r.target_branch," from ").concat(r.source_branch),rules:[{required:!0,message:h.a.required}]}))),m&&"rebase"!==m&&"ff-only"!==m&&o.a.createElement(f.Form.Item,{label:"\u63d0\u4ea4\u4fe1\u606f"},o.a.createElement(f.Input.TextArea,p("merge_commit_message_content"))),o.a.createElement(f.Form.Item,{label:""},o.a.createElement(f.Checkbox,p("should_remove_source_branch",{initValue:!1}),"\u5408\u5e76\u540e\u81ea\u52a8\u5220\u9664\u6e90\u5206\u652f")))))}}]),n}(o.a.Component),B=n(2),D=n(9);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z(e,t,n){return t&&M(e.prototype,t),n&&M(e,n),e}function F(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}function A(e,t){return(A=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function V(e){var t=H();return function n(){var r=K(e),o;if(t){var a=K(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return q(this,o)}}function q(e,t){return!t||"object"!==I(t)&&"function"!=typeof t?W(e):t}function W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function H(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var X=function(e){F(n,e);var t=V(n);function n(e){var r;return L(this,n),U(W(r=t.call(this,e)),"onOverlayVisibleChange",(function(e){r.setState({visible:e})})),U(W(r),"renderDisabledBtn",(function(e){return o.a.createElement("div",{className:"item disabled"},o.a.createElement(f.Balloon.Tooltip,{align:"t",trigger:o.a.createElement("span",null,"\u5173\u95ed\u5408\u5e76\u8bf7\u6c42")},e))})),r.state={visible:!1},r}return z(n,[{key:"render",value:function e(){var t=this,n=this.props.codeReviewDetail,r=D.a&&!n.is_support_close,a=D.a?n.unsupport_close_message:"";return o.a.createElement(f.Dropdown,{trigger:o.a.createElement(f.Button,{type:"normal",className:"close-btn-trigger"},o.a.createElement(m.a,{type:"more"})),triggerType:"click",align:"tr br",container:document.querySelector(".mr-title-info"),visible:this.state.visible,onVisibleChange:this.onOverlayVisibleChange},o.a.createElement("div",{className:"close-btn-dropdown"},r?this.renderDisabledBtn(a):o.a.createElement("div",{className:"item",onClick:function e(){t.props.modifyCr({state_event:"close"},(function(){t.props.getSummaryLogs()}))}},"\u5173\u95ed\u5408\u5e76\u8bf7\u6c42")))}}]),n}(r.Component);function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Q(e,t,n){return t&&Y(e.prototype,t),n&&Y(e,n),e}function Z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}function $(e,t){return($=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function ee(e){var t=re();return function n(){var r=oe(e),o;if(t){var a=oe(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return te(this,o)}}function te(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?ne(e):t}function ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function re(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function oe(e){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ie=f.Balloon.Tooltip,ce=f.Balloon.PopConfirm,le=function(e){Z(n,e);var t=ee(n);function n(e){var r;return J(this,n),ae(ne(r=t.call(this,e)),"handleClickBtnPass",(function(){r.state.submitting||(r.setState({submitting:!0}),r.props.doAccept((function(){r.setState({submitting:!1})})))})),r.field=new f.Field(ne(r)),r.state={visible:!1,submitting:!1},r}return Q(n,[{key:"render",value:function e(){var t=this,n=this.props,r=n.codeReviewDetail,a=n.approve_status,i=n.targetBranchSetting,c=n.rootState,l=r.state,s=r.mergeStatus,u=r.approve_check_result,p=r.assignees,m=r.source_type,y=r.work_in_progress,b=r.author,g=r.is_support_merge,v=r.unsupport_merge_message,E=r.is_support_reopen,w=r.unsupport_reopen_message,_=window.FORCE.pathResource,O=_.role,S=_.isArchive,R=c&&c.pageInfo?c.pageInfo.codeReviewDetail:{},C=R.sourceBranchExist,N=R.targetBranchExist,T,k=p.findIndex((function(e){return"approved"===e.status&&e.id===Number(window.FORCE.user.codeUserId)}))>-1,j=k?"\u5df2\u901a\u8fc7":"\u901a\u8fc7",P=i&&i.merge_request&&i.merge_request.required&&!i.merge_request.allow_self_approval,I=i&&i.merge_request&&i.merge_request.required&&1===i.merge_request.allow_merge_request.length,L;switch(a.approve_status){case"READY_APPROVE":L=o.a.createElement(ie,{trigger:o.a.createElement(f.Button,{type:"primary",onClick:this.handleClickBtnPass,loading:this.state.submitting},j),align:"t",text:"\u901a\u8fc7\u4ee3\u7801\u8bc4\u5ba1\u8868\u793a\u4f60\u8d5e\u540c\u672c\u6b21\u5408\u5e76"});break;case"APPROVED":L=k?o.a.createElement(f.Button,{type:"primary",onClick:this.props.doAccept,disabled:!0},j):I||b.id===Number(window.FORCE.user.codeUserId)&&P?o.a.createElement(ie,{trigger:o.a.createElement(f.Button,{type:"primary",disabled:!0},j),align:"t",text:I?"\u5df2\u8bbe\u7f6e\u4ec5\u5141\u8bb8\u7ba1\u7406\u5458\u901a\u8fc7":"\u5df2\u8bbe\u7f6e\u4e0d\u5141\u8bb8\u521b\u5efa\u8005\u672c\u4eba\u901a\u8fc7"}):o.a.createElement(ie,{trigger:o.a.createElement(f.Button,{type:"primary",onClick:this.handleClickBtnPass,loading:this.state.submitting},j),align:"t",text:"\u901a\u8fc7\u4ee3\u7801\u8bc4\u5ba1\u8868\u793a\u4f60\u8d5e\u540c\u672c\u6b21\u5408\u5e76"});break;case"NO_ACCESS":L=o.a.createElement(ie,{trigger:o.a.createElement(f.Button,{type:"primary",onClick:this.props.doAccept,disabled:!0},j),align:"t",text:a.message||"\u65e0\u6743\u9650"});break;case"METHOD_NOT_ALLOW":L=null;break;default:L=null}var M=D.a&&!g,z=D.a&&!r.is_support_close,F=D.a&&!E,A;if("true"===C&&"true"===N)if(y)A=o.a.createElement("div",null,o.a.createElement(ie,{trigger:o.a.createElement(f.Button,{type:"primary",disabled:!0},"\u5408\u5e76"),align:"t",text:"\u5df2\u6807\u8bb0\u5f00\u53d1\u672a\u5b8c\u6210\uff0c\u5982\u9700\u5408\u5e76\u8bf7\u5148\u5220\u9664\u6807\u9898\u7684 WIP \u524d\u7f00"}));else if("can_be_merged"===s)if(0===u.unsatisfied_check_results.length&&"accepted"===l){if(A=o.a.createElement("div",null,o.a.createElement(x,this.props)),i&&i.allow_merge&&i.allow_merge.length){var V=i.allow_merge,q=B.a.access_level_id.DEVELOPER;"DEVELOPER"!==O||V.includes(q)||(A=o.a.createElement("div",null,o.a.createElement(ie,{trigger:o.a.createElement(f.Button,{type:"primary",disabled:!0},"\u5408\u5e76"),align:"t",text:"\u60a8\u65e0\u6743\u9650\u63a8\u9001\u4ee3\u7801\u81f3\u4fdd\u62a4\u5206\u652f"})))}}else A=o.a.createElement("div",null,o.a.createElement(ie,{trigger:o.a.createElement(f.Button,{type:"primary",disabled:!0},"\u5408\u5e76"),align:"t",text:"\u672a\u8fbe\u5230\u5408\u5e76\u8981\u6c42"}));else A=o.a.createElement("div",null,o.a.createElement(ie,{trigger:o.a.createElement(f.Button,{type:"primary",disabled:!0},"\u5408\u5e76"),align:"t",text:"\u5b58\u5728\u51b2\u7a81\uff0c\u4e0d\u5141\u8bb8\u5408\u5e76"}));else A=o.a.createElement("div",null,o.a.createElement(ie,{trigger:o.a.createElement(f.Button,{type:"primary",disabled:!0},"\u5408\u5e76"),align:"t",text:"\u6e90\u5206\u652f\u6216\u76ee\u6807\u5206\u652f\u5df2\u4e0d\u5b58\u5728"}));var W=null;if("closed"===l)W=F?o.a.createElement("div",{className:"mr-btns-wrapper-item"},o.a.createElement(ie,{trigger:o.a.createElement(f.Button,{disabled:!0},"\u91cd\u65b0\u6253\u5f00"),align:"t"},w)):Object(d.a)(B.g,O)?o.a.createElement("div",{className:"mr-btns-wrapper-item"},"true"===C&&"true"===N?o.a.createElement(f.Button,{onClick:function e(){t.props.modifyCr({state_event:"reopen"},(function(){t.props.getSummaryLogs()}))}},"\u91cd\u65b0\u6253\u5f00"):o.a.createElement(ie,{trigger:o.a.createElement(f.Button,{disabled:!0},"\u91cd\u65b0\u6253\u5f00"),align:"t"},"\u6e90\u5206\u652f\u6216\u76ee\u6807\u5206\u652f\u5df2\u4e0d\u5b58\u5728")):null;else if("merged"===l)W=Object(d.a)(B.g,O)?o.a.createElement("div",{className:"mr-btns-wrapper-item"},"true"===C&&"COMMIT"!==m?o.a.createElement(ce,{triggerType:"click",align:"l",type:"warning",title:h.a.cr_state_action_del_branch,content:h.a.cr_source_branch_has_been_merged,onConfirm:function e(){t.props.deleteSourceBranch(),t.setState({visible:!1})},visible:this.state.visible,onCancel:function e(){t.setState({visible:!1})},trigger:o.a.createElement(f.Button,{onClick:function e(){t.setState({visible:!0})}},h.a.cr_state_action_del_branch)}):null):null;else{var H=p.findIndex((function(e){return e.id===Number(window.FORCE.user.codeUserId)})),K;K="false"!==S?null:Object(d.a)(B.g,O)?o.a.createElement("div",{className:"mr-btns-wrapper-item"},L):H>-1?o.a.createElement("div",{className:"mr-btns-wrapper-item"},o.a.createElement(ie,{trigger:o.a.createElement(f.Button,{type:"primary",disabled:!0},j),align:"t",text:"\u65e0\u6743\u9650\u901a\u8fc7\u8bc4\u5ba1\uff0c\u9700\u5177\u5907\u5e93\u5f00\u53d1\u8005\u53ca\u4ee5\u4e0a\u6743\u9650"})):null,W=o.a.createElement("div",{className:"mr-btns-wrapper"},K,"false"===S&&Object(d.a)(B.g,O)&&!M?o.a.createElement("div",{className:"mr-btns-wrapper-item"},A):o.a.createElement(o.a.Fragment,null,M&&o.a.createElement("div",{className:"mr-btns-wrapper-item"},o.a.createElement(ie,{trigger:o.a.createElement(f.Button,{type:"primary",disabled:!0},"\u5408\u5e76"),align:"t",text:v}))),Object(d.a)(B.g,O)||z?o.a.createElement("div",{className:"mr-btns-wrapper-item"},o.a.createElement(X,this.props)):null)}return W}}]),n}(o.a.Component),se=n(3),ue=n.n(se),fe=n(7);function pe(e){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ye(e,t,n){return t&&de(e.prototype,t),n&&de(e,n),e}function he(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&be(e,t)}function be(e,t){return(be=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function ge(e){var t=we();return function n(){var r=_e(e),o;if(t){var a=_e(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return ve(this,o)}}function ve(e,t){return!t||"object"!==pe(t)&&"function"!=typeof t?Ee(e):t}function Ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function we(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _e(e){return(_e=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Se=window.FORCE.pathResource,Re=function(e){he(n,e);var t=ge(n);function n(){return me(this,n),t.apply(this,arguments)}return ye(n,[{key:"getCRContentByType",value:function e(t,n){return"COMMIT"===n?fe.b.showShortSha(t):t}},{key:"render",value:function e(){var t=this.props,n=t.codeReviewDetail,r=t.sourceBranchExist,a=t.targetBranchExist,i;return"source_branch"===t.branchType?o.a.createElement(o.a.Fragment,null,"false"===r?o.a.createElement("span",{className:"text-black"},this.getCRContentByType(n.source_branch,n.source_type)):o.a.createElement("a",{className:"text-black",target:"_blank",href:"/".concat(Se.fullPath,"/tree/").concat(fe.b.revisionEncodeURI(n.source_branch))},this.getCRContentByType(n.source_branch,n.source_type)),n.local_branch?o.a.createElement("span",{className:"text-black"}," ","(".concat(n.local_branch,")")):null,"false"===r?o.a.createElement("span",{className:"text-grey"}," (\u5206\u652f\u5df2\u5220\u9664)"):null):o.a.createElement(o.a.Fragment,null,"false"!==a?o.a.createElement("a",{className:"text-black",target:"_blank",href:"/".concat(Se.fullPath,"/tree/").concat(fe.b.revisionEncodeURI(n.target_branch))},this.getCRContentByType(n.target_branch,n.target_branch)):o.a.createElement("span",{className:"text-black"},this.getCRContentByType(n.target_branch,n.target_branch)),"false"===a?o.a.createElement("span",{className:"text-grey"}," (\u5206\u652f\u5df2\u5220\u9664)"):null)}}]),n}(r.Component);Oe(Re,"propTypes",{branchType:ue.a.string}),Oe(Re,"defaultProps",{branchType:"source_branch"});var Ce=n(45),Ne=n.n(Ce),Te=n(1506),ke=n(94),je=n(6),Pe=n(1623),xe=n(78),Be;function De(e){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Me(e,t,n){return t&&Le(e.prototype,t),n&&Le(e,n),e}function ze(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}function Fe(e,t){return(Fe=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Ae(e){var t=We();return function n(){var r=He(e),o;if(t){var a=He(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Ve(this,o)}}function Ve(e,t){return!t||"object"!==De(t)&&"function"!=typeof t?qe(e):t}function qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function We(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function He(e){return(He=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ue=new(n.n(xe).a)({highlight:function e(t,n){if(n&&Ne.a.getLanguage(n))try{return Ne.a.highlight(n,t).value}catch(e){return""}return""}}),Xe=window.FORCE.pathResource,Ge=function(e){ze(n,e);var t=Ae(n);function n(e){var r;return Ie(this,n),Ke(qe(r=t.call(this,e)),"closeDropdown",(function(){r.setState({dropdownVisible:!1})})),Ke(qe(r),"renderDraftComments",(function(){var e=r.props.changesReducer.drafts,t=r.props.issueDetailList;return o.a.createElement("div",{className:"draft-comment-list"},e.map((function(e){if(e.issue_id){var n=t.find((function(t){return t.id===e.issue_id}))||{};e.line=n.begin_line,e.side="right",e.outdated=n.status&&"resolved"===n.status.toLowerCase(),e.path=n.file_name}return o.a.createElement("div",{className:"draft-comment-list-item"},o.a.createElement("div",{className:"draft-comment-list-item-left"},o.a.createElement(m.a,{type:"normal-text"})),o.a.createElement("div",{className:"draft-comment-list-item-right"},o.a.createElement("div",{className:"line-info"},o.a.createElement(Te.a,{comment:e,maxWidth:"190px",closeDropdown:r.closeDropdown})),o.a.createElement("div",{className:"content-info markdown-body",dangerouslySetInnerHTML:{__html:Object(ke.filterXSS)(Ue.render(e.note||""),{onIgnoreTagAttr:function e(t,n,r){return"".concat(n,"=").concat(r)}})}})))})))})),Ke(qe(r),"renderBtn",(function(){var e=r.props,t=e.changesReducer,n=e.mrCommentConfig,a=e.codeReviewDetail,i=t.allComments,c=void 0===i?[]:i,l="false"===Xe.isArchive&&fe.b.allowComments(c.length,n);return o.a.createElement("div",{className:"draft-btn-wrapper"},o.a.createElement(f.Button,{type:"primary",className:"draft-btn",disabled:!l,onClick:function e(){l&&(r.props.postDrafts("",(function(){r.setState({dropdownVisible:!1})})),Object(je.b)({action:"push_draft",page:":Repo-MR",type:"",mr_id:a.id}))}},"\u63d0\u4ea4\u8349\u7a3f"))})),r.state={dropdownVisible:!1},r}return Me(n,[{key:"render",value:function e(){var t=this,n=this.props.changesReducer.drafts,r=window.FORCE.pathResource.role;if(!n.length)return null;var a=Object(d.a)(B.f,r);return o.a.createElement(f.Dropdown,{trigger:o.a.createElement(f.Button,{type:"primary",style:{marginRight:a?0:"-12px",marginLeft:24},className:"drafts-trigger"},"\u63d0\u4ea4\u8349\u7a3f",o.a.createElement(f.Badge,{count:n.length,className:"drafts-num-badge"})),triggerType:"hover",align:"tr br",visible:this.state.dropdownVisible,onVisibleChange:function e(n){t.setState({dropdownVisible:n})}},o.a.createElement("div",{className:"drafts-pop-container"},this.renderDraftComments(),this.renderBtn()))}}]),n}(o.a.Component),Je=n(1515),Ye=n(1624),Qe=n(1471);function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function $e(){return($e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function et(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nt(e,t,n){return t&&tt(e.prototype,t),n&&tt(e,n),e}function rt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ot(e,t)}function ot(e,t){return(ot=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function at(e){var t=lt();return function n(){var r=st(e),o;if(t){var a=st(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return it(this,o)}}function it(e,t){return!t||"object"!==Ze(t)&&"function"!=typeof t?ct(e):t}function ct(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function st(e){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ft=f.Tag.Colorable,pt=window.FORCE.pathResource,mt="mr-title-info",dt=function(e){rt(n,e);var t=at(n);function n(e){var r;return et(this,n),ut(ct(r=t.call(this,e)),"renderStateBtn",(function(e){return e?"merged"===e?o.a.createElement(ft,{color:"gray",size:"medium"},o.a.createElement(m.a,{type:"merge",biz:"code"}),"\u5df2\u5408\u5e76"):"closed"===e?o.a.createElement(ft,{color:"red",size:"medium"},o.a.createElement(m.a,{type:"pull-request-closed",biz:"code"}),"\u5df2\u5173\u95ed"):o.a.createElement(ft,{color:"green",size:"medium"},o.a.createElement(m.a,{type:"pull-request",biz:"code"}),"\u5df2\u5f00\u542f"):null})),ut(ct(r),"onTitleChange",(function(e){r.setState({curTitle:e})})),ut(ct(r),"onTitlePressEnter",(function(){var e=r.state.curTitle;if(e.trim()){if(e!==r.props.codeReviewDetail.title){var t={};t.title=e.trim(),r.props.modifyCr(t,(function(){f.Toast.success({title:"\u6807\u9898\u4fee\u6539\u6210\u529f"})}))}}else f.Toast.error({title:"\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a"})})),r.state={curTitle:e.codeReviewDetail.title||""},r}return nt(n,[{key:"render",value:function e(){var t=this,n=this.props,r=n.codeReviewDetail,a=n.mrTabKey,i=n.mr_ahead_behind_info,c=this.state.curTitle,l=pt.role,s=r.author||{},u=r.assignees?r.assignees.filter((function(e){return"approved"===e.status})):[];u.forEach((function(e){e.avatar_url&&(e.avatarUrl=e.avatar_url)}));var p=r.state&&"merged"!==r.state&&"closed"!==r.state;return o.a.createElement("div",{className:"".concat(mt)},o.a.createElement("div",{className:"".concat(mt,"-left")},this.renderStateBtn(r.state),o.a.createElement("div",{className:"".concat(mt,"-main")},o.a.createElement("div",{className:"".concat(mt,"-main-info")},D.a&&!r.is_support_modify?o.a.createElement(f.Balloon.Tooltip,{align:"t",trigger:o.a.createElement("span",{className:"mr-title-text"},o.a.createElement(f.Input,{className:"mr-title-text-input not-allowed",defaultValue:r.title,size:"small",disabled:!0}))},r.unsupport_modify_message):o.a.createElement(o.a.Fragment,null,Object(d.a)(B.g,l)?o.a.createElement(f.Balloon.Tooltip,{trigger:o.a.createElement("span",{className:"mr-title-text"},o.a.createElement(f.Input,{className:"mr-title-text-input isedit",onPressEnter:this.onTitlePressEnter,onBlur:function e(n){t.onTitlePressEnter(n),c.trim()||t.setState({curTitle:r.title})},onChange:this.onTitleChange,value:c,size:"small"})),align:"t",triggerType:"hover"},"\u70b9\u51fb\u5373\u53ef\u7f16\u8f91"):o.a.createElement("span",{className:"mr-title-text"},o.a.createElement(f.Input,{className:"mr-title-text-input",defaultValue:r.title,size:"small",disabled:!0})))),o.a.createElement("div",{className:"".concat(mt,"-main-desc")},o.a.createElement("div",null,!0===r.is_auto_create||"true"===r.is_auto_create?o.a.createElement(Qe.a,null):s.name," \u4e8e ",fe.b.getBeautyTime(r.created_at)," \u521b\u5efa\uff0c\u671f\u671b\u5c06\xa0",o.a.createElement("span",{className:"branch-bg"},o.a.createElement(Re,$e({branchType:"source_branch"},this.props))),"\xa0\u5408\u5e76\u81f3\xa0",o.a.createElement("span",{className:"branch-bg"},o.a.createElement(Re,$e({branchType:"target_branch"},this.props)))),p&&i&&(i.behind||i.ahead)&&o.a.createElement(Je.a,{info:i,targetBranch:r.targetBranch||r.target_branch,style:{width:100,marginLeft:8,height:20}})))),o.a.createElement("div",{className:"".concat(mt,"-right")},["overview","/"].includes(a)&&u.length?o.a.createElement(f.Balloon.Tooltip,{trigger:o.a.createElement("div",{className:"assignees"},o.a.createElement(m.a,{type:"cr-pass",biz:"code"}),o.a.createElement("span",null,o.a.createElement("span",{className:"num"},u.length,"\xa0"),"\u4eba\u901a\u8fc7\u8bc4\u5ba1")),align:"t"},u.map((function(e){return e.name})).join("\u3001")," \u5df2\u901a\u8fc7"):null,o.a.createElement(Ge,this.props),o.a.createElement(le,this.props)))}}]),n}(r.Component),yt=n(167),ht=n(299),bt=n(47),gt=n.n(bt),vt=n(26),Et=n(14),wt=n(23),_t=n(21),Ot=n(29),St=n(1462);function Rt(e){return(Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Ct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tt(e,t,n){return t&&Nt(e.prototype,t),n&&Nt(e,n),e}function kt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jt(e,t)}function jt(e,t){return(jt=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Pt(e){var t=Dt();return function n(){var r=It(e),o;if(t){var a=It(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return xt(this,o)}}function xt(e,t){return!t||"object"!==Rt(t)&&"function"!=typeof t?Bt(e):t}function Bt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function It(e){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mt=function(e){kt(n,e);var t=Pt(n);function n(){var e;Ct(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return Lt(Bt(e=t.call.apply(t,[this].concat(a))),"renderIcon",(function(e,t){if(e.label.isFile){var n=o.a.createElement(St.a,{className:"file-icon",fileName:e.label.name});return t?o.a.createElement(f.Badge,{dot:!0},n):n}return o.a.createElement(m.a,{type:"folder",biz:"code",className:"file-icon"})})),Lt(Bt(e),"loop",(function(t){return t.map((function(t){var n=e.props,r=n.diffs,a=n.codeReviewDetail,i=n.unreadFileObjectIds,c=window.FORCE.pathResource,l="/".concat(c.fullPath,"/merge_request/").concat(a.id),u=r.find((function(e){return e.new_path===t.label.path}))||{},p,d=e.getSelectedKey()==="tree_".concat(gt()(t.label.path)),y=u.new_object_id&&i.includes(u.new_object_id);return o.a.createElement(f.Tree.Node,{label:o.a.createElement("span",{key:"".concat(gt()(t.label.path),"_label"),className:"label-content ".concat(d?"selected":""),onClick:function n(r){r.stopPropagation(),t.label.isFile&&(Object(je.b)({action:"click_tree_file",page:"Repo-MR-changes"}),window.location.pathname!=="".concat(l,"/changes")&&(Object(s.d)("".concat(l,"/changes")),e.props.changeMrTabKey("changes")),window.location.hash="#file=".concat(gt()(t.label.path)),"single"===e.props.forceCrFileViewType&&(document.querySelector("#mr-content-body").scrollTop=0))}},e.renderIcon(t,y)," ",o.a.createElement(Ot.default,{align:"t",trigger:o.a.createElement("span",{className:u.read?"read":"unread"},t.label.isFile?t.label.name:t.label.name.slice(0,-1))},t.label.isFile?t.label.name:t.label.name.slice(0,-1)),t.label.isFile&&o.a.createElement("span",{className:"label-content-right"},u.total_note?o.a.createElement(f.Balloon.Tooltip,{trigger:o.a.createElement("span",{className:"comment-status"},o.a.createElement(m.a,{type:"chat-private",biz:"code"}),u.total_note-u.unresolved_note,"/",u.total_note),align:"t",text:"\u5171 ".concat(u.total_note," \u6761\u8bc4\u8bba, ").concat(u.total_note-u.unresolved_note," \u6761\u5df2\u89e3\u51b3")}):null,u.add_lines?o.a.createElement(f.Balloon.Tooltip,{trigger:o.a.createElement("span",{className:"changes-tree-item-right-item add-lines"},"+ ",u.add_lines),align:"t",text:"\u589e\u52a0\u4e86 ".concat(u.add_lines," \u884c")}):null,u.del_lines?o.a.createElement(f.Balloon.Tooltip,{trigger:o.a.createElement("span",{className:"changes-tree-item-right-item del-lines",style:{marginLeft:u.add_lines?8:0}},"- ",u.del_lines),align:"t",text:"\u5220\u9664\u4e86 ".concat(u.del_lines," \u884c")}):null)),key:"tree_".concat(gt()(t.label.path)),isLeaf:t.label.isFile},t.nodes&&e.loop(t.nodes))}))})),Lt(Bt(e),"getSelectedKey",(function(){var t=e.props,n=t.diffs,r=t.diffsSha1Map,o=t.hash,a=t.leftTreeSelectKey,i=t.mrTabKey,c=o.file,l=c?r[c]:n[0].new_path,s="";return"changes"!==i?"":(a?s="tree_".concat(a):l&&(s="tree_".concat(gt()(l))),s)})),Lt(Bt(e),"renderTree",(function(t,n,r){if(t.length)return o.a.createElement("div",null,e.treeLoop(n));if(r)return o.a.createElement(_t.a,null);var a=e.props.getTreeFailReason;return o.a.createElement("div",{className:"mr-diffs-empty"},o.a.createElement(wt.a,{size:"small",type:"card",content:"",description:a||"\u6ca1\u6709\u6587\u4ef6\u6539\u52a8",imgType:"org-list-empty",className:"no-content no-btns"}))})),e}return Tt(n,[{key:"componentDidMount",value:function e(){var t=document.querySelector(".mr-detail-content-header"),n=document.querySelector(".mr-tab-list"),r=document.querySelector(".mr-change-tree-top"),o=Math.max(document.documentElement.clientHeight,window.innerHeight||0),a=n?n.offsetHeight:0,i=t?t.offsetHeight:0,c=r?r.offsetHeight:0,l=91,s=document.querySelector(".changes-left");s&&(s.style["max-height"]="".concat("".concat(o-(a+i+91+c),"px")))}},{key:"treeLoop",value:function e(t){if(!t.nodes.length)return null;var n=this.getSelectedKey();return o.a.createElement(f.Tree,{defaultExpandAll:!0,selectedKeys:[n],className:"file-tree",mode:"directory",isLabelBlock:!0,animation:!1,style:{display:"inline-block",width:"100%"}},this.loop(t.nodes))}},{key:"render",value:function e(){var t=this.props,n=t.diffs,r=t.isCommitsAndDiffsLoading,a=Object(ht.a)(n.map((function(e){return e.new_path})),"",(function(e,t,n){return{path:"".concat(e).concat(t),name:"".concat(t),isFile:n}})),i=function e(t){!t.label||t.label.isFile||1!==t.nodes.length||t.nodes[0].label.isFile?t.nodes.length&&t.nodes.forEach((function(t){e(t)})):(t.label={path:t.nodes[0].label.path,name:t.label.name+t.nodes[0].label.name,isFile:t.nodes[0].label.isFile},t.nodes=t.nodes[0].nodes,e(t))};return a.nodes.length&&a.nodes.forEach((function(e){i(e)})),o.a.createElement("div",{className:"changes-left-section"},o.a.createElement("div",{className:"changes-tree"},this.renderTree(n,a,r)))}}]),n}(r.Component),zt=n(177),Ft=n.n(zt);function At(e){return(At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wt(e,t,n){return t&&qt(e.prototype,t),n&&qt(e,n),e}function Ht(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kt(e,t)}function Kt(e,t){return(Kt=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Ut(e){var t=Jt();return function n(){var r=Yt(e),o;if(t){var a=Yt(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Xt(this,o)}}function Xt(e,t){return!t||"object"!==At(t)&&"function"!=typeof t?Gt(e):t}function Gt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Yt(e){return(Yt=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Qt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Zt=function(e){Ht(n,e);var t=Ut(n);function n(e){var r;Vt(this,n),Qt(Gt(r=t.call(this,e)),"getIndex",(function(){var e=r.props,t=e.data,n=e.from_commit,o=e.to_commit;if(!t)return{toIndex:-1,fromIndex:-1};var a=t.findIndex((function(e){return n===e.value})),i=t.findIndex((function(e){return o===e.value}));return{toIndex:-1===i&&-1!==a?a:i,fromIndex:-1!==i&&-1===a?i:a}})),Qt(Gt(r),"setIndex",(function(e){var t=r.state,n=t.fromIndex,o=t.toIndex;-1===n&&-1===o?r.setState({fromIndex:e,toIndex:e}):n===o&&e===n?r.setState({fromIndex:-1,toIndex:-1}):n===o||e!==n&&o!==e?e<n?r.setState({fromIndex:e}):r.setState({toIndex:e}):r.setState({fromIndex:e===n?n+1:n,toIndex:e===o?o-1:o})})),Qt(Gt(r),"handleClose",(function(){r.props.onClose()})),Qt(Gt(r),"handleOk",(function(){var e=r.state,t=e.fromIndex,n=e.toIndex;r.props.onChange({fromIndex:t,toIndex:n})})),Qt(Gt(r),"renderCommitLabel",(function(e,t){var n=r.state,a=n.fromIndex,i=n.toIndex,c=e.data,l=c.author?c.author.name:c.author_name||"",s=fe.b.getBeautyTime(c.created_at||c.authored_date).toLowerCase(),u="".concat(l," \u63d0\u4ea4\u4e8e ").concat(s);return o.a.createElement("div",{className:"commit-select-label ".concat(t>=a&&t<=i?"active":"")},o.a.createElement("div",{className:"selected-icon-wrapper"}),o.a.createElement("div",{className:"commit-select-label-left"},o.a.createElement("div",{className:"commit-select-label-title one-line-ellipsis"},c.title),o.a.createElement("div",{className:"commit-select-label-des one-line-ellipsis"},u)),o.a.createElement("div",{className:"commit-select-label-right"},c.id.slice(0,8)))}));var a=r.getIndex(),i=a.fromIndex,c=a.toIndex;return r.state={fromIndex:i,toIndex:c},r}return Wt(n,[{key:"render",value:function e(){var t=this,n=this.props.data,r=this.state,a=r.fromIndex,i=r.toIndex,c=0;return c=-1===a&&-1===i?0:Math.abs(a-i)+1,!n&&n.length?null:o.a.createElement("div",{className:"customized-select-pop-container commit-select-popup"},o.a.createElement("div",{className:"commit-select-popup-header"},o.a.createElement("div",null,o.a.createElement(f.Checkbox,{checked:n.length===c,indeterminate:c&&n.length>c,onChange:function e(r){r?t.setState({fromIndex:0,toIndex:n.length-1}):t.setState({fromIndex:-1,toIndex:-1})}},"\u5168\u90e8\u63d0\u4ea4")),o.a.createElement("div",{className:"commit-select-popup-header-right"},"\u9009\u62e9\u5355\u9879\u63d0\u4ea4\u6216\u63d0\u4ea4\u533a\u95f4")),o.a.createElement("div",{className:"commit-select-popup-body"},!!n&&n.map((function(e,n){return o.a.createElement("div",{onClick:function e(){t.setIndex(n)}},t.renderCommitLabel(e,n))}))),o.a.createElement("div",{className:"commit-select-popup-footer"},o.a.createElement("div",{className:"commit-select-popup-footer-left"},c?"\u5df2\u9009\u62e9 ".concat(c," \u4e2a\u63d0\u4ea4"):""),o.a.createElement("div",{className:"commit-select-popup-footer-right"},o.a.createElement(f.Button,{type:"normal",onClick:this.handleClose},"\u53d6\u6d88"),o.a.createElement(f.Button,{type:"primary",style:{marginLeft:12},disabled:!c,onClick:this.handleOk},"\u786e\u5b9a"))))}}]),n}(o.a.Component);Qt(Zt,"propTypes",{data:ue.a.arrayOf(ue.a.object),onChange:ue.a.func}),Qt(Zt,"defaultProps",{data:[],onChange:function e(){},popupClassName:"",customizedItemRender:null});var $t=n(1625);function en(e){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function tn(){return(tn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){yn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function on(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function an(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cn(e,t,n){return t&&an(e.prototype,t),n&&an(e,n),e}function ln(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sn(e,t)}function sn(e,t){return(sn=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function un(e){var t=mn();return function n(){var r=dn(e),o;if(t){var a=dn(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return fn(this,o)}}function fn(e,t){return!t||"object"!==en(t)&&"function"!=typeof t?pn(e):t}function pn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function dn(e){return(dn=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function yn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hn={triggerClickKeycode:[13,32,40]},bn=function(e){ln(n,e);var t=un(n);function n(){var e;on(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return yn(pn(e=t.call.apply(t,[this].concat(o))),"state",{isPopupVisible:!1}),yn(pn(e),"getCommitsData",(function(){var t,n;return e.props.commits.map((function(e){return{label:e.title,value:e.id,data:e}}))||[]})),yn(pn(e),"handleCommitsChange",(function(t){var n=t.newFromCommitId,r=t.newToCommitId;e.props.updateData({from_commit:n,to_commit:r});var o=window.location.hash.split("#")[1]||"",a,i=rn(rn({},o?Ft.a.parse(o):{}),{},{from_commit:n,to_commit:r});window.location.hash="#".concat(Ft.a.stringify(i)),e.props.getPushRecordsDiff(),e.props.getTotalComments(),e.props.getDrafts()})),yn(pn(e),"handleSelect",(function(t){var n=t.fromIndex,r=t.toIndex,o=e.props,a=o.commits,i=o.codeReviewDetail;e.setState({isPopupVisible:!1}),Object(je.b)({action:"choose_push_version",page:"Repo-MR-changes",mr_id:i.id});var c=a[n].id,l=a[r].id;e.handleCommitsChange({newFromCommitId:c,newToCommitId:l})})),yn(pn(e),"onVisibleChange",(function(t){var n=e.props.codeReviewDetail;e.setState({isPopupVisible:t}),t&&Object(je.b)({action:"check_file_commit",page:"Repo-MR",type:"",control:"",mr_id:n.id})})),e}return cn(n,[{key:"render",value:function e(){var t=this,n=this.props,r=n.from_commit,a=n.to_commit,i=n.className,c=void 0===i?"":i,l=this.getCommitsData(),s=l.findIndex((function(e){return e.value===r})),u=l.findIndex((function(e){return e.value===a})),p=o.a.createElement(Zt,tn({onChange:this.handleSelect,onClose:function e(){t.setState({isPopupVisible:!1})},data:l},this.props));return o.a.createElement("div",{className:"commits-toggle ".concat(c),id:"commits-toggle"},o.a.createElement(f.Select,{size:"xs",value:r,autoWidth:!1,hasBorder:!1,dataSource:l,popupContainer:function e(){return document.getElementById("commits-toggle")},valueRender:function e(){var t=Math.abs(u-s)+1;return t===l.length?o.a.createElement("span",{className:"value-text"},"\u5168\u90e8\u63d0\u4ea4"):o.a.createElement("span",{className:"value-text"},t," \u4e2a\u63d0\u4ea4")},className:"commit-select",visible:this.state.isPopupVisible,onVisibleChange:this.onVisibleChange,popupProps:hn,popupContent:p}))}}]),n}(r.Component),gn=n(1626);function vn(e){return(vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function En(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _n(e,t,n){return t&&wn(e.prototype,t),n&&wn(e,n),e}function On(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sn(e,t)}function Sn(e,t){return(Sn=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Rn(e){var t=Tn();return function n(){var r=kn(e),o;if(t){var a=kn(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Cn(this,o)}}function Cn(e,t){return!t||"object"!==vn(t)&&"function"!=typeof t?Nn(e):t}function Nn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function kn(e){return(kn=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function jn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Pn="mr-change-tree",xn=f.Tag.Colorable,Bn=function(e){On(n,e);var t=Rn(n);function n(){var e;En(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return jn(Nn(e=t.call.apply(t,[this].concat(a))),"renderNoChange",(function(){return o.a.createElement("div",{className:"mr-commits-empty"},o.a.createElement(wt.a,{size:"small",type:"card",content:"",description:"\u5f53\u524d\u8bc4\u5ba1\u6ca1\u6709\u4efb\u4f55\u6539\u52a8",imgType:"org-list-empty",className:"no-content no-btns"}))})),e}return _n(n,[{key:"render",value:function e(){var t=this.props,n=t.diffsCount,r=t.isPushRecordsFetched,a=t.commits;return r?a.length?o.a.createElement("div",{className:"".concat(Pn),"customize-arrow":"left","customize-tip-width":230,"customize-top-offset":-91,"data-step":"2","data-tip":"\u8fd9\u91cc\u67e5\u770b\u9700\u8bc4\u5ba1\u7684\u4ee3\u7801\u6587\u4ef6"},o.a.createElement("div",{className:"".concat(Pn,"-top")},o.a.createElement("div",null,o.a.createElement(bn,this.props)),n?o.a.createElement("div",null,n.additions?o.a.createElement(f.Balloon.Tooltip,{align:"t",trigger:o.a.createElement(xn,{color:"green"},"+ ",n.additions),text:"\u589e\u52a0\u4e86 ".concat(n.additions," \u884c")}):null,n.deletions?o.a.createElement(f.Balloon.Tooltip,{align:"t",trigger:o.a.createElement(xn,{color:"red"},"- ",n.deletions),text:"\u5220\u9664\u4e86 ".concat(n.deletions," \u884c")}):null):null),o.a.createElement("div",{id:"J_changesLeft",className:"changes-left"},o.a.createElement(Mt,this.props))):this.renderNoChange():o.a.createElement(_t.a,null)}}]),n}(o.a.Component),Dn=n(1627);function In(e){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Ln(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zn(e,t,n){return t&&Mn(e.prototype,t),n&&Mn(e,n),e}function Fn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&An(e,t)}function An(e,t){return(An=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Vn(e){var t=Hn();return function n(){var r=Kn(e),o;if(t){var a=Kn(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return qn(this,o)}}function qn(e,t){return!t||"object"!==In(t)&&"function"!=typeof t?Wn(e):t}function Wn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Kn(e){return(Kn=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Un(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Xn=function(e){Fn(n,e);var t=Vn(n);function n(e){var r;return Ln(this,n),Un(Wn(r=t.call(this,e)),"goNextFile",(function(){for(var e=r.props.diffs,t="",n=0;n<e.length;n++){var o=e[n];if(!o.read){t=o.new_path;break}}r.setState({showNext:!0}),console.error(t),t&&r.goFile(t)})),Un(Wn(r),"goFile",(function(e){var t=window.FORCE.pathResource,n=r.props,o=n.codeReviewDetail,a=n.forceCrFileViewType,i="/".concat(t.fullPath,"/merge_request/").concat(o.id);window.location.pathname!=="".concat(i,"/changes")&&(Object(s.d)("".concat(i,"/changes")),r.props.changeMrTabKey("changes")),window.location.hash="#file=".concat(gt()(e)),"single"===a&&(document.querySelector("#mr-content-body").scrollTop=0)})),Un(Wn(r),"close",(function(){r.setState({showNext:!1,fixedPercent:null})})),r.state={showNext:!1,fixedPercent:null},r}return zn(n,[{key:"render",value:function e(){var t=this,n=this.props,r=n.diffs,a=n.isNavHidden,i=n.isPushRecordsFetched,c=n.commits,l=n.from_commit,s=n.to_commit;if(!(i&&r&&r.length&&c&&c.length&&l===c[0].id&&s===c[c.length-1].id))return null;var u=this.state,p=u.showNext,d=u.fixedPercent,y=r.filter((function(e){return e.read})),h=y.length/r.length*100,b=h>0&&h<1?1:Math.floor(h),g=null===d?b:d||0,v=g<50?{left:"".concat(g,"%")}:{right:"".concat(100-g,"%")};return o.a.createElement("div",{className:"mr-read ".concat(a?"no-nav":"has-nav")},o.a.createElement("div",{className:"mr-read-progress"},o.a.createElement("div",{style:{width:"".concat(b,"%")},className:"mr-read-progress-content"})),o.a.createElement("div",{className:"mr-read-tooltip ".concat(p?"next":""),style:v},o.a.createElement("div",{className:"mr-read-tooltip-text ".concat(100===b?"completed":"")},o.a.createElement("span",{className:"gray"},"\u5df2\u8bfb"),"\xa0",o.a.createElement("span",null,y.length," / ",r.length)),p?o.a.createElement(o.a.Fragment,null,o.a.createElement(f.Balloon.Tooltip,{trigger:o.a.createElement("div",{className:"go-next-icon ".concat(100===b?"completed":""),onClick:this.goNextFile},o.a.createElement(m.a,{type:"arrow-down"})),align:"b",text:"\u524d\u5f80\u4e0b\u4e00\u4e2a\u672a\u8bfb\u6587\u4ef6"}),o.a.createElement("div",{className:"close-icon",onClick:this.close},o.a.createElement(m.a,{type:"remove"}))):o.a.createElement(f.Balloon.Tooltip,{trigger:o.a.createElement("div",{className:"go-first-icon ".concat(100===b?"completed":""),onClick:function e(){t.setState({fixedPercent:b}),t.goNextFile()}},o.a.createElement(m.a,{type:"focus1",biz:"code"})),align:"b",text:"\u5b9a\u4f4d\u81f3\u672a\u8bfb\u6587\u4ef6"})))}}]),n}(o.a.PureComponent),Gn=n(1628);function Jn(e){return(Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Yn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yn(Object(n),!0).forEach((function(t){lr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function er(e,t,n){return t&&$n(e.prototype,t),n&&$n(e,n),e}function tr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nr(e,t)}function nr(e,t){return(nr=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function rr(e){var t=ir();return function n(){var r=cr(e),o;if(t){var a=cr(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return or(this,o)}}function or(e,t){return!t||"object"!==Jn(t)&&"function"!=typeof t?ar(e):t}function ar(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ir(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function cr(e){return(cr=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function lr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var sr=fe.b.getListFromLike,ur=fe.b.getWindowInfo,fr=fe.b.offset,pr=function(e){tr(n,e);var t=rr(n);function n(e){var r;return Zn(this,n),(r=t.call(this,e)).state={nodeList:[],dots:[],activeIndex:0,contentStyle:{},tipStyle:{},tip:"",arrowClass:"top",audioUrl:"",playClass:"audio-play",gotSteps:!1,preparing:!0},r}return er(n,[{key:"componentDidUpdate",value:function e(){var t;if(!this.state.gotSteps){var n=this._getMarkDomInfo(),r=n.dots,o=n.nodeList;2===o.length&&(this.setState({gotSteps:!0,nodeList:o,dots:r,preparing:!1}),this.onRezieWindow(),window.addEventListener("resize",this.onRezieWindow.bind(this),!1),this.onAudioFulfill(),this.props.loadGuideSuccess())}}},{key:"shouldComponentUpdate",value:function e(t){return t.visible&&t.visible!==this.props.visible&&(this._setTargetIndex(this.state.nodeList[0],0),this._setDot(this.state.dots[0],0,"start"),this.audio&&this.audio.load()),!0}},{key:"componentWillReceiveProps",value:function e(t){var n;if(t.jumpToLast){for(var r=sr(this.guide.querySelectorAll("[data-step]")),o=null,a=0;a<r.length;a++)Number(r[a].getAttribute("data-step"))===this.props.customizeStepsSize&&(o=r[a]);o&&this.appendNode(o,this.props.customizeStepsSize-1)}}},{key:"componentWillUnmount",value:function e(){window.removeEventListener("resize",this.onRezieWindow.bind(this),!1)}},{key:"onRezieWindow",value:function e(){var t,n,r=this._getMarkDomInfo().dots[this.state.activeIndex];this.setState({tipStyle:this._getTipStyle(r),contentStyle:r})}},{key:"onClickShadow",value:function e(t){"guide-shadow"===t.target.className&&this.props.closeWhenClickShadow&&(this.shadow.removeEventListener("click",this.onClickShadow.bind(this),!1),this._closeGuide(t))}},{key:"onAudioFulfill",value:function e(){var t=this;this.audio&&this.audio.addEventListener("timeupdate",(function(){var e,n,r=t.audio.duration===t.audio.currentTime?"audio-noplay":"audio-play";r!==t.state.playClass&&t.setState({playClass:r})}),!1)}},{key:"_setDot",value:function e(t,n,r){var o=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i="start"===r?100:350;if(this.setState({contentStyle:t,tipStyle:{display:"none",opacity:0},tip:t.tip,audioUrl:"text2Voice(dot.tip, this.props.lan)"}),!a){this._focusTarget(n);var c=setTimeout((function(){o.setState({tipStyle:o._getTipStyle(t)}),clearTimeout(c)}),i);this._playAudio()}}},{key:"appendNode",value:function e(t,n){var r=this.state.nodeList;r.push(t),r.sort((function(e,t){return Number(e.getAttribute("data-step"))-Number(t.getAttribute("data-step"))}));var o=r.map((function(e){var t=e.clientHeight||e.offsetHeight,n=e.clientWidth||e.offsetWidth,r=e.getAttribute("border-len")||0,o=e.getAttribute("customize-top-offset")||0,a=e.getAttribute("customize-tip-width")||-1,i=e.getAttribute("customize-arrow"),c=e.getAttribute("customize-tip-style"),l=e.getAttribute("customize-left-offset")||0,s=e.getAttribute("customize-height-offset")||0;return{left:fr(e,"left")-2*r+Number(l),top:fr(e,"top")-2*r+Number(o),height:t+6*r+Number(s),width:n+6*r,tip:e.getAttribute("data-tip"),step:e.getAttribute("data-step"),fRight:e.offsetLeft+n,fBottom:e.offsetTop+t,customizeTipWidth:Number(a),customizeArrow:i,customizeTipStyle:JSON.parse(c)}}));this.setState({dots:o,nodeList:r},(function(){this._setDot(o[n],n),this._setTargetIndex(r[n],n)}))}},{key:"_getMarkDomInfo",value:function e(){var t=sr(this.guide.querySelectorAll("[data-step]")),n;return t.sort((function(e,t){return Number(e.getAttribute("data-step"))-Number(t.getAttribute("data-step"))})),{dots:t.map((function(e){var t=e.clientHeight||e.offsetHeight,n=e.clientWidth||e.offsetWidth,r=e.getAttribute("border-len")||0,o=e.getAttribute("customize-top-offset")||0,a=e.getAttribute("customize-tip-width")||-1,i=e.getAttribute("customize-arrow"),c=e.getAttribute("customize-tip-style"),l=e.getAttribute("customize-left-offset")||0,s=e.getAttribute("customize-height-offset")||0;return{left:fr(e,"left")-2*r+Number(l),top:fr(e,"top")-2*r+Number(o),height:t+6*r+Number(s),width:n+6*r,tip:e.getAttribute("data-tip"),step:e.getAttribute("data-step"),fRight:e.offsetLeft+n,fBottom:e.offsetTop+t,customizeTipWidth:Number(a),customizeArrow:i,customizeTipStyle:JSON.parse(c)}})),nodeList:t}}},{key:"_getTipStyle",value:function e(t){var n=ur(),r=n.winH,o=n.winW,a=12,i="",c={opacity:1};return r-t.fBottom>250&&o-t.left>250?(i="top",c={top:t.height+12,left:0}):t.top>250&&o-t.left>250?(i="bottom",c={bottom:t.height+12,left:0}):t.left>250&&r-t.top>250||t.left>o?(i="right",c={top:0,right:t.width+12}):o-t.fRight>250&&r-t.top>250?(i="left",c={top:0,left:t.width+12}):c={display:"none"},t.customizeArrow&&(i=t.customizeArrow,c={top:0,left:t.width+12}),-1!==t.customizeTipWidth&&(c=Qn(Qn({},c),{},{width:t.customizeTipWidth})),t.customizeTipStyle&&(c=t.customizeTipStyle),this.setState({arrowClass:i}),c}},{key:"_setTargetIndex",value:function e(t,n){var r=setTimeout((function(){t.style.setProperty("position","relative"),t.style.setProperty("z-index","999996","important"),clearTimeout(r)}),300);n!==this.state.activeIndex&&this._removeActive()}},{key:"_playAudio",value:function e(){this.audio&&(this.audio.autoplay=!0)}},{key:"_focusTarget",value:function e(t){var n=ur(),r=n.winW,o=n.winH,a=this.state.nodeList[t].getBoundingClientRect(),i=a.top,c=a.bottom,l=a.left,s=a.right,u=this.state.dots[t].top,f=this.state.dots[t].left,p,m;(i>o||i<0||c>o||(l>r||l<0||s>r))&&window.scrollTo(f-100,u-100)}},{key:"_removeActive",value:function e(){var t=this.state.nodeList[this.state.activeIndex];t&&(t.style.setProperty("position",""),t.style.setProperty("z-index","auto"))}},{key:"_closeGuide",value:function e(t){this._removeActive(),this.setState({activeIndex:0}),this.audio&&this.audio.pause(),this.props.onCancel(t)}},{key:"handleChangeStep",value:function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this.props,a=o.customizeSecondLastStep,i=o.onClickNextInLastSecond;if(r||!a||this.state.activeIndex+1!==this.getTotalSteps()-1){var c=/\d+/g.test(n)?n:this.state.activeIndex+t;this.setState({activeIndex:c}),this._setDot(this.state.dots[c],c),this._setTargetIndex(this.state.nodeList[c],c)}else i()}},{key:"handleJumpStep",value:function e(t){var n;if(t=t||window.event,/^dot\d/g.test(t.target.id)){var r=t.target.id.slice(-1);this.handleChangeStep(1,Number(r))}}},{key:"getTotalSteps",value:function e(){var t=this.props.customizeStepsSize,n=this.state.dots.length;return null!=t&&(n=t),n}},{key:"handleSkip",value:function e(t){t=t||window.event;var n=this.getTotalSteps();this.state.activeIndex===n-1&&this.handleOk(t),this._closeGuide(t)}},{key:"handleOk",value:function e(t){this.props.onOk(t)}},{key:"getLastGuideFooterStyle",value:function e(t){if(!t||"{}"===JSON.stringify(t))return{};var n=JSON.parse(JSON.stringify(t));return 0!==n.top?n.top+=105:n.bottom?n.top+=110:n.left?n.top+=125:n.right&&(n.top+=90),n}},{key:"render",value:function e(){var t=this,n=this.state,r=n.nodeList,a=n.preparing,i=this.props,c=i.customizeStepsSize,l=i.customizeSecondLastStep,s=i.jumpToLast,u=null===c?r.length:c,f=this.props.shadow,p=o.a.createElement("div",{className:"guide-shadow",ref:function e(n){t.shadow=n},onClick:this.onClickShadow.bind(this),key:"guide-shadow"});f||(p=null);var m=!l&&this.state.activeIndex===this.state.dots.length-1;s&&(m=!0);var d=this.getLastGuideFooterStyle(this.state.tipStyle),y=[p,o.a.createElement("div",{className:"guide-content",key:"guide-content",style:this.state.contentStyle},o.a.createElement("div",{className:"guide-tooltip",style:this.state.tipStyle},o.a.createElement("div",{className:"guide-desc",dangerouslySetInnerHTML:{__html:"".concat(this.state.tip)}}),this.props.bullet&&o.a.createElement("div",{className:"guide-bullets"},o.a.createElement("ul",{onClick:this.handleJumpStep},this.state.dots.map((function(e,n){return o.a.createElement("li",{key:"dot".concat(n)},o.a.createElement("div",{id:"dot".concat(n),className:n===t.state.activeIndex?"active-dot":""}))})))),!m&&o.a.createElement("div",{className:"guide-bottom-group"},o.a.createElement("div",{className:"guide-step"},"".concat(this.state.activeIndex+1," / ").concat(u)),o.a.createElement("div",{className:"guide-button guide-button-left",onClick:this.handleSkip.bind(this)},o.a.createElement("span",null,"\u8df3\u8fc7")),o.a.createElement("div",{className:"guide-button guide-button-right ".concat(m?"guide-button-disabled":""),disabled:m,onClick:function e(){t.handleChangeStep(1)}},o.a.createElement("span",{className:"guide-button-right-desc"},"\u4e0b\u4e00\u4e2a"))),o.a.createElement("div",{className:"guide-arrow ".concat(this.state.arrowClass)}),this.props.audio&&o.a.createElement("div",{className:this.state.playClass})),m&&o.a.createElement("div",{className:"guide-tooltip-footer",style:d},o.a.createElement("div",{className:"guide-tooltip-footer-ok",dangerouslySetInnerHTML:{__html:"\u597d\u7684 &#128075"},onClick:this.handleSkip.bind(this)}),o.a.createElement("div",{className:"guide-tooltip-footer-help",onClick:function e(){window.open(t.props.helpDocLink,"_blank")}},"\u67e5\u770b\u5e2e\u52a9\u6587\u6863")))];return o.a.createElement("div",{className:"guide-container",ref:function e(n){t.guide=n}},this.props.children,this.props.visible&&!a&&y,this.props.audio&&o.a.createElement("audio",{ref:function e(n){t.audio=n},src:this.state.audioUrl,type:"audio/mpeg"}))}}]),n}(r.Component);lr(pr,"defaultProps",{bullet:!1,visible:!1,audio:!1,onCancel:function e(){},onOk:function e(){},closeWhenClickShadow:!1,shadow:!1,customizeStepsSize:null,customizeSecondLastStep:!1,onClickNextInLastSecond:function e(){},helpDocLink:""}),lr(pr,"propTypes",{children:ue.a.any,visible:ue.a.bool,bullet:ue.a.bool,audio:ue.a.bool,onCancel:ue.a.func,onOk:ue.a.func,closeWhenClickShadow:ue.a.bool,shadow:ue.a.bool,customizeStepsSize:ue.a.number,customizeSecondLastStep:ue.a.bool,onClickNextInLastSecond:ue.a.func,helpDocLink:ue.a.string});var mr,dr=pr,yr=n(10),hr=n(55),br=n(1514);function gr(e){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Er(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vr(Object(n),!0).forEach((function(t){xr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wr(){return(wr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function _r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Or(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sr(e,t,n){return t&&Or(e.prototype,t),n&&Or(e,n),e}function Rr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cr(e,t)}function Cr(e,t){return(Cr=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Nr(e){var t=jr();return function n(){var r=Pr(e),o;if(t){var a=Pr(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Tr(this,o)}}function Tr(e,t){return!t||"object"!==gr(t)&&"function"!=typeof t?kr(e):t}function kr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Pr(e){return(Pr=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function xr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Br=B.a.getOSKeyMap(),Dr=Br.ctrlKey,Ir=Br.ctrlTxt,Lr=f.Tag.Colorable,Mr=window.FORCE.pathResource,zr=["REPORTER","ORG_MEMBER","DEVELOPER","MASTER","OWNER","ORG_ADMIN","ORG_OWNER","ADMIN"],Fr=Object(yt.a)({loader:function e(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(8),n.e(27)]).then(n.bind(null,1702))}}),Ar=Object(yt.a)({loader:function e(){return Promise.all([n.e(0),n.e(8),n.e(19)]).then(n.bind(null,1700))}}),Vr=Object(yt.a)({loader:function e(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(47)]).then(n.bind(null,1745))}}),qr=null,Wr=function(e){Rr(n,e);var t=Nr(n);function n(){var e;_r(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return xr(kr(e=t.call.apply(t,[this].concat(a))),"state",{isNavHidden:!1,guideVisible:!1,guideLoadSuccess:!1,jumpToLast:!1}),xr(kr(e),"renderMain",(function(e){return o.a.createElement("div",{className:"mr-detail-content-view"},o.a.createElement(s.c,{primary:!1},o.a.createElement(Fr,{path:e}),o.a.createElement(Ar,{path:"".concat(e,"/changes")}),o.a.createElement(Vr,{path:"".concat(e,"/commits")})))})),xr(kr(e),"renderLeadComponent",(function(){var e,t;if("5f7051259cffa29cfdd39e47"===window.FORCE.organization.organization_id&&!fe.b.getCache("guide_1024",!1)){var n="mountLeadEl",r=document.getElementById(n);r||((r=document.createElement("div")).id=n,document.body.appendChild(r)),i.a.render(o.a.createElement(br.a,{onClose:function e(){fe.b.setCache("guide_1024",!0,!1),i.a.unmountComponentAtNode(document.getElementById(n))}}),document.getElementById(n))}})),xr(kr(e),"renderStateBtn",(function(e){return e?"merged"===e?o.a.createElement(Lr,{color:"gray",size:"medium"},o.a.createElement(m.a,{type:"merge",biz:"code"}),"\u5df2\u5408\u5e76"):"closed"===e?o.a.createElement(Lr,{color:"red",size:"medium"},o.a.createElement(m.a,{type:"pull-request-closed",biz:"code"}),"\u5df2\u5173\u95ed"):o.a.createElement(Lr,{color:"green",size:"medium"},o.a.createElement(m.a,{type:"pull-request",biz:"code"}),"\u5df2\u5f00\u542f"):null})),xr(kr(e),"getKey",(function(e){var t,n,r=window.location.pathname.replace(e,"").split("/"),o;return r[r.length-1]||"/"})),xr(kr(e),"handleMrTabChange",(function(t,n){var r=e.props.codeReviewDetail;e.props.changeMrTabKey(t),Object(s.d)("".concat(n).concat("/"===t?"":"/".concat(t)));var o="";o="/"===t?"check_overview":"check_commit_history",Object(je.b)({action:o,page:"Repo-MR",type:"",control:"",mr_id:r.id})})),xr(kr(e),"handleToggleLeftNav",(function(){var t=e.state.isNavHidden;if(!e.mrNav||!e.mrDetailContentBody)return!1;var n=e.mrNav.style.width;e.mrRead||(e.mrRead=document.querySelector(".mr-read")),t?(e.mrRead&&e.mrRead.style&&(e.mrRead.style.left=n),e.mrNav.style.transform="translateX(0)",e.mrDetailContentBody.style.left=n,e.mrDetailContentBody.style.width="calc(100% - ".concat(n,")")):(e.mrRead&&e.mrRead.style&&(e.mrRead.style.left=0),e.mrNav.style.transform="translateX(-".concat(n,")"),e.mrDetailContentBody.style.left="0px",e.mrDetailContentBody.style.width="100%"),e.setState({isNavHidden:!t}),e.hideNavTrack(!t)})),xr(kr(e),"handleKeyCodeEvent",(function(t){var n=e.props.codeReviewDetail,r=e.state.isNavHidden;if(t[Dr]&&t.keyCode===Et.a.B){if(!e.mrNav||!e.mrDetailContentBody)return!1;var o=e.mrNav.style.width;e.mrRead||(e.mrRead=document.querySelector(".mr-read")),r?(e.mrRead&&e.mrRead.style&&(e.mrRead.style.left=o),e.mrNav.style.transform="translateX(0)",e.mrDetailContentBody.style.left=o,e.mrDetailContentBody.style.width="calc(100% - ".concat(o,")")):(e.mrRead&&e.mrRead.style&&(e.mrRead.style.left=0),e.mrNav.style.transform="translateX(-".concat(o,")"),e.mrDetailContentBody.style.left="0px",e.mrDetailContentBody.style.width="100%"),e.setState({isNavHidden:!r}),e.hideNavTrack(!r),Object(je.b)({action:"set_sidebar",page:"",type:"shortcuts",control:"",mr_id:n.id})}})),xr(kr(e),"hideNavTrack",(function(t){var n=e.props.codeReviewDetail;Object(je.b)({action:t?"hide_sidebar":"show_sidebar",page:"Repo-MR",type:"",control:"",mr_id:n.id})})),xr(kr(e),"renderBody",(function(){var t=e.props,n=t.codeReviewDetail,r=t.commitHistory,a=t.mrTabKey,i="/".concat(Mr.fullPath,"/merge_request/").concat(n.id),c=e.state.isNavHidden,l=a||e.getKey(i),u=r?r.length:0,d="overview"===l?"/":l;return o.a.createElement("div",{ref:function t(n){e.mrDetailContentBody=n},className:"mr-detail-content-body ".concat(c?"no-nav":""),id:"mr-content-body",style:{width:"calc(100% - 300px)"}},o.a.createElement(o.a.Fragment,null,o.a.createElement(f.Balloon.Tooltip,{align:"r",trigger:o.a.createElement("div",{className:"mr-hide-fix-icon ".concat(c?"flex":"hide"),onClick:e.handleToggleLeftNav},o.a.createElement(m.a,{type:"chevrons-right"}))},"\u5c55\u5f00",o.a.createElement("br",null),Ir," + B"),o.a.createElement("div",{className:"mr-nav",style:{width:"300px"},ref:function t(n){e.mrNav=n}},o.a.createElement("div",{className:"mr-nav-move-line",onMouseDown:e.mouseDownMoveLine},o.a.createElement("div",null)),c?null:o.a.createElement(f.Balloon.Tooltip,{align:"r",trigger:o.a.createElement("div",{className:"mr-nav-fix-icon",onClick:e.handleToggleLeftNav},o.a.createElement(m.a,{type:"chevrons-left",size:"small"}))},"\u6536\u8d77",o.a.createElement("br",null),Ir," + B"),o.a.createElement("div",{className:"mr-nav-tree"},o.a.createElement("div",{className:"mr-tab-list"},o.a.createElement(p.a,{selectedKey:d},o.a.createElement(p.a.Item,{key:"/",label:"\u5168\u5c40\u6982\u89c8",container:s.a,containerProps:{to:i,onClick:function t(){e.handleMrTabChange("/",i)}}}),o.a.createElement(p.a.Item,{key:"commits",container:s.a,containerProps:{to:"".concat(i,"/commits"),onClick:function t(){e.handleMrTabChange("commits",i)}},label:o.a.createElement("div",null,"\u63d0\u4ea4\u5386\u53f2 ",o.a.createElement("span",{className:"badge-count"},u))}))),o.a.createElement("div",null,o.a.createElement(Bn,wr({},e.props.changesReducer,{getDrafts:e.props.getDrafts,getTotalComments:e.props.getTotalComments,getPushRecordsDiff:e.props.getPushRecordsDiff,updateData:e.props.updateChangeReducer,changeMrTabKey:e.props.changeMrTabKey,mrTabKey:e.props.mrTabKey})))))),o.a.createElement("div",{className:"mr-detail-content-body-right"},o.a.createElement(Xn,wr({isNavHidden:c},e.props.changesReducer,{getDrafts:e.props.getDrafts,getTotalComments:e.props.getTotalComments,getPushRecordsDiff:e.props.getPushRecordsDiff,updateData:e.props.updateChangeReducer,changeMrTabKey:e.props.changeMrTabKey,mrTabKey:e.props.mrTabKey})),e.renderMain(i)))})),xr(kr(e),"mouseDownMoveLine",(function(){if(!e.mrNav)return!1;e.mrRead||(e.mrRead=document.querySelector(".mr-read")),e.mrNav.style.transition="unset",document.addEventListener("mousemove",e.handleMouseMove),document.addEventListener("mouseup",e.mouseUpMoveLine)})),xr(kr(e),"mouseUpMoveLine",(function(){if(!e.mrNav)return!1;e.mrNav.style.transition="ease-in 300ms",document.removeEventListener("mouseup",e.mouseUpMoveLine),document.removeEventListener("mousemove",e.handleMouseMove)})),xr(kr(e),"handleMouseMove",(function(t){if(t.preventDefault(),t.stopPropagation(),!e.mrNav||!e.mrDetailContentBody)return!1;var n=t.pageX;return n<207&&(n=207),e.mrNav.style.width="".concat(n,"px"),e.mrDetailContentBody.style.left="".concat(n,"px"),e.mrDetailContentBody.style.width="calc(100% - ".concat(n,"px)"),e.mrRead&&e.mrRead.style&&(e.mrRead.style.left="".concat(n,"px")),!1})),e}return Sr(n,[{key:"componentDidMount",value:function e(){var t=this;this.props.getCrDetail(),this.props.getCrOtherInfo((function(){t.props.getCommitsRange((function(e){t.props.receiveCommitHistory(e)}))})),this.props.getMergeRequest(),this.props.getApproveStatus(),this.props.getTargetBranchSetting(),this.props.getSummaryLogs(1),this.props.getBuilds(),this.props.getMrCommentConfig(),this.props.getLsifEnable(),document.addEventListener("keydown",this.handleKeyCodeEvent),this.checkMrGuideSwitch(),document.body.classList.add("mr-body"),D.c&&setTimeout((function(){t.renderLeadComponent()}),1e4),this.props.getIpWhiteList(),this.mrRead=document.querySelector(".mr-read")}},{key:"checkMrGuideSwitch",value:function e(){var t=this,n=window.FORCE.codeReviewDetail;window.location.pathname==="/".concat(Mr.fullPath,"/merge_request/").concat(n.id)&&Object(yr.y)("first_enter",{first_enter_key:"merge_request_detail"}).then((function(e){if(e.state){var n=setInterval((function(){var e=t.state,r=e.guideLoadSuccess,o=e.guideVisible;r&&!o&&(t.setState({guideVisible:!0}),clearInterval(n))}),1e3);qr=n}})).catch((function(e){console.log(e)}))}},{key:"closeMrGuide",value:function e(){Object(yr.Y)("first_enter",{first_enter_key:"merge_request_detail"}).then((function(){})).catch((function(e){console.log(e)}))}},{key:"componentWillUnmount",value:function e(){document.removeEventListener("keydown",this.handleKeyCodeEvent),document.removeEventListener("mousedown",this.mouseDownMoveLine),document.removeEventListener("mouseup",this.mouseUpMoveLine),document.removeEventListener("mousemove",this.handleMouseMove),this.mrNav&&(this.mrNav.style.transform="translateX(0)"),this.mrDetailContentBody&&(this.mrDetailContentBody.style.left=0,this.mrDetailContentBody.style.width="auto"),this.mrRead&&this.mrRead.style&&(this.mrRead.style.left=300),this.props.resetChangeData(),qr&&clearInterval(qr),document.body.classList.remove("mr-body")}},{key:"getFirstFileFromTreeData",value:function e(t){for(var n=0;n<t.length;n++){var r=t[n];return r.label.isFile?r.label.path:this.getFirstFileFromTreeData(r.nodes)}}},{key:"render",value:function e(){var t=this,n=window.FORCE.codeReviewDetail,r=this.state.jumpToLast,a=this.props.isLoadingDetail,i=Mr.role,c=Object(d.a)(zr,i);return o.a.createElement(o.a.Fragment,null,c?o.a.createElement(o.a.Fragment,null,o.a.createElement(dr,{shadow:!0,closeWhenClickShadow:!1,jumpToLast:r,visible:this.state.guideVisible,customizeStepsSize:3,loadGuideSuccess:function e(){t.setState({guideLoadSuccess:!0})},customizeSecondLastStep:!0,onCancel:function e(){t.setState({guideVisible:!1}),t.closeMrGuide()},onOk:function e(){t.setState({jumpToLast:!1})},helpDocLink:"https://thoughts.aliyun.com/sharespace/5e8c37eb546fd9001aee8242/docs/5e8c37e8546fd9001aee8216",onClickNextInLastSecond:function e(){var r=t.props.changesReducer.diffs,o=Object(ht.a)(r.map((function(e){return e.new_path})),"",(function(e,t,n){return{path:"".concat(e).concat(t),name:"".concat(t),isFile:n}})),a=gt()(t.getFirstFileFromTreeData(o.nodes)),i="/".concat(Mr.fullPath,"/merge_request/").concat(n.id);Object(s.d)("".concat(i,"/changes")),window.location.hash="#file=".concat(a),t.setState({jumpToLast:!0})}},a?o.a.createElement("div",{className:"mr-detail-loading"},o.a.createElement(f.Loading,null)):o.a.createElement("div",{className:"mr-detail-content"},o.a.createElement("div",{className:"mr-detail-content-header"},o.a.createElement(dt,this.props)),this.renderBody(),o.a.createElement(je.a,{page:"Repo-MR"})))):o.a.createElement(y.a,{pictureUrl:"https://img.alicdn.com/tfs/TB14JNzD1uSBuNjy1XcXXcYjFXa-700-700.png",title:"\u65e0\u8bbf\u95ee\u6743\u9650",desc:"\u8bf7\u8054\u7cfb\u5e93\u7ba1\u7406\u5458\u8fdb\u884c\u6dfb\u52a0"}))}}]),n}(r.Component),Hr=Object(c.connect)((function(e){return Er(Er({},e.project.projectMergeRequestDetail.root),{},{changesReducer:e.project.projectMergeRequestDetail.changesReducer,rootState:e.root})}),(function(e){return Object(l.bindActionCreators)(Er(Er({},u),{},{postDrafts:vt.postDrafts,getDrafts:vt.getDrafts,getCommitsRange:vt.getCommitsRange,updateChangeReducer:vt.updateData,getPushRecordsDiff:vt.getPushRecordsDiff,getTotalComments:vt.getTotalComments,resetChangeData:vt.resetData,updatePageInfo:hr.updatePageInfo,getLsifEnable:vt.getLsifEnable}),e)}))(Wr),Kr=n(1629),Ur=t.default=Hr}}]);
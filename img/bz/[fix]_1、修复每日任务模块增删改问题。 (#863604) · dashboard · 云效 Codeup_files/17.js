(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{1452:function(e,t,n){"use strict";n.d(t,"a",(function(){return ae}));var r=n(0),o=n.n(r),a=n(1),i=n(290),c=n.n(i),l=n(4),u=n(3),s=n.n(u),f=n(8),p=n(23);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}function g(e,t){return(g=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function v(e){var t=O();return function n(){var r=j(e),o;if(t){var a=j(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return E(this,o)}}function E(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?w(e):t}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _="branch-tag-select",P=function(e){b(n,e);var t=v(n);function n(){var e;y(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return S(w(e=t.call.apply(t,[this].concat(a))),"renderTabContent",(function(t){var n=e.props,r=n.data,a=n.selectValue,i=[];if(r.forEach((function(e){e.key===t&&(i=e.children||[])})),!i.length){var c="branch"===t?"\u6682\u65e0\u5206\u652f":"\u6682\u65e0\u6807\u7b7e";return o.a.createElement("div",{className:"".concat(_,"-list")},o.a.createElement(p.a,{size:"small",type:"card",content:"",description:c,imgType:"org-list-empty",className:"no-content no-btns"}))}return o.a.createElement("div",{className:"".concat(_,"-list")},i.map((function(t){return o.a.createElement("div",{className:"".concat(_,"-visible-select-item"),onClick:function n(){t.disabled||e.props.onChange(t)}},o.a.createElement("div",{className:"".concat(_,"-visible-select-item-right")},a===t.value?o.a.createElement(f.a,{type:"tick-bold",className:"select-icon"}):null),o.a.createElement("div",{className:"".concat(_,"-visible-select-item-left")},o.a.createElement("div",{className:"select-label"},t.label)))})))})),e}return h(n,[{key:"render",value:function e(){var t=this.props,n=t.data,r=t.isOverlayLoading,i=t.needTagSearch,c=t.activeTab;return o.a.createElement("div",{className:"".concat(_,"-pop-container")},r&&o.a.createElement("div",{className:"access-select-loading"},o.a.createElement(a.Loading,null)),!r&&n&&o.a.createElement(a.Tab,{defaultActiveKey:c,onChange:this.props.changeActiveTab},o.a.createElement(a.Tab.Item,{title:"\u5206\u652f",key:"branch"},this.renderTabContent("branch")),i&&o.a.createElement(a.Tab.Item,{title:"\u6807\u7b7e",key:"tag"},this.renderTabContent("tag"))))}}]),n}(o.a.Component);S(P,"propTypes",{selectValue:s.a.number,data:s.a.arrayOf(s.a.object),onChange:s.a.func,isOverlayLoading:!1}),S(P,"defaultProps",{selectValue:0,data:[],onChange:function e(){}});var R=n(14),T=n(29),C=n(1453);function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function I(e,t){if(null==e)return{};var n=x(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function x(e,t){if(null==e)return{};var n={},r=Object.keys(e),o,a;for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}function B(e,t){return F(e)||D(e,t)||A(e,t)||L()}function L(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function D(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var r=[],o=!0,a=!1,i,c;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(e){a=!0,c=e}finally{try{o||null==n.return||n.return()}finally{if(a)throw c}}return r}}function F(e){if(Array.isArray(e))return e}function M(e){return z(e)||V(e)||A(e)||U()}function U(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function A(e,t){if(e){if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(e,t):void 0}}function V(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function z(e){if(Array.isArray(e))return K(e)}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X(e,t,n){return t&&W(e.prototype,t),n&&W(e,n),e}function q(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}function J(e,t){return(J=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function G(e){var t=$();return function n(){var r=Q(e),o;if(t){var a=Q(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Y(this,o)}}function Y(e,t){return!t||"object"!==N(t)&&"function"!=typeof t?Z(e):t}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Q(e){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var te=window.FORCE,ne=te.pathResource,re=te.resourceSubject;function oe(e){e.preventDefault()}var ae=function(e){q(n,e);var t=G(n);function n(e){var r;return H(this,n),ee(Z(r=t.call(this,e)),"onChange",(function(e,t){"change"===t&&r.onSearch(e),r.setState({value:e}),r.props.onChange(e)})),ee(Z(r),"onSearch",(function(e){var t=r.state,n=t.branches,o=t.tags,a=n.filter((function(t){return t.name.includes(e)})),i=o.filter((function(t){return t.name.includes(e)})),c=r.getDataSource(a,i),l=r.state.isLevelPopVisible;a.length||i.length?e||r.state.isLevelPopVisible||(l=!0):l=!1,r.setState({dataSource:c,isLevelPopVisible:r.props.autoComplete?l:r.state.isLevelPopVisible})})),ee(Z(r),"getDataSource",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=r.props.needTagSearch,a=[{label:"\u5206\u652f",children:[],key:"branch"}],i;e&&e.length&&(i=a[0].children).push.apply(i,M(e.map((function(e){return{label:o.a.createElement("div",{className:"branch-select-label"},o.a.createElement("div",null,o.a.createElement(f.a,{type:"branch",biz:"code",className:"branch-select-label-icon"})),o.a.createElement(T.default,{trigger:o.a.createElement("span",{className:"branch-select-label-content"},e.name),align:"t"},e.name)),value:e.name}}))));return t&&t.length&&n&&a.push({label:"\u6807\u7b7e",key:"tag",children:t.map((function(e){return{label:o.a.createElement("div",{className:"branch-select-label"},o.a.createElement("div",null,o.a.createElement(f.a,{type:"tag",biz:"code",className:"branch-select-label-icon"})),o.a.createElement(T.default,{trigger:o.a.createElement("span",{className:"branch-select-label-content one-line-ellipsis"},e.name),align:"t"},e.name)),value:e.name}}))}),a.reverse()})),ee(Z(r),"handleSelect",(function(e){r.setState({isLevelPopVisible:!1,value:e.value},(function(){!r.props.autoComplete&&r.onSearch("")})),r.props.onChange(e.value)})),ee(Z(r),"onVisibleChange",(function(e){r.setState({isLevelPopVisible:e},(function(){r.resetData()}))})),ee(Z(r),"resetData",(function(){r.props.autoComplete||r.state.isLevelPopVisible||r.onSearch("")})),ee(Z(r),"changeActiveTab",(function(e){r.setState({activeTab:e})})),ee(Z(r),"handleKeyDown",(function(e){var t=r.state.isLevelPopVisible;switch(e.keyCode){case R.a.ENTER:e.preventDefault(),r.setState({isLevelPopVisible:!t},(function(){r.resetData()}));break;case R.a.ESC:e.preventDefault(),r.setState({isLevelPopVisible:!1},(function(){r.resetData()}))}})),r.state={branches:[],tags:[],value:r.props.noDefaultValue?"":re.revision||"master",dataSource:[],isFetching:!0,isLevelPopVisible:!1,activeTab:"branch"},r}return X(n,[{key:"componentDidMount",value:function e(){var t=this;Promise.all([l.a.fetch({api:"projects.all.branches.search",params:{id:ne.id},data:{sort:"updated_desc"}}),l.a.fetch({api:"project.tags",params:{projectId:ne.id}})]).then((function(e){e[0].shift(),e[1].shift();var n=e[0],r=e[1];if(ne.defaultBranch){var o,a,i=B(c()(n,(function(e){return e.name===ne.defaultBranch})),1)[0];i&&n.unshift(i)}var l=t.getDataSource(n,r);t.setState({branches:n,tags:r,dataSource:l,isFetching:!1})})).catch((function(e){console.error(e)}))}},{key:"render",value:function e(){var t=this.props,n=t.needTagSearch,r=t.value,i=t.onChange,c=t.autoComplete,l=t.className,u=t.autoWidth,s=I(t,["needTagSearch","value","onChange","autoComplete","className","autoWidth"]),f=this.state,p=f.dataSource,m=f.isFetching,y=f.activeTab,d="\u641c\u7d22\u5206\u652f\u6216\u6807\u7b7e";n||(d="\u641c\u7d22\u5206\u652f");var h=o.a.createElement(P,{onChange:this.handleSelect,onMouseDown:oe,selectValue:r||this.state.value,data:p,isOverlayLoading:m,needTagSearch:n,changeActiveTab:this.changeActiveTab,activeTab:y}),b={triggerClickKeycode:[13,32]};return c?o.a.createElement(a.Select.AutoComplete,k({onChange:this.onChange,value:r||this.state.value,dataSource:p,autoWidth:u,popupStyle:u?{}:{width:240},className:"branch-select ".concat(l||""),placeholder:d,visible:this.state.isLevelPopVisible,onVisibleChange:this.onVisibleChange,popupProps:b,popupContent:h,onKeyDown:this.handleKeyDown},s)):m?null:o.a.createElement(a.Select,k({onChange:this.onChange,value:r||this.state.value,dataSource:p,showSearch:!0,style:{maxWidth:180},hasBorder:!1,autoWidth:!1,popupStyle:{width:240,zIndex:98},onSearch:this.onSearch,className:"branch-select no-border-select ".concat(l||""),placeholder:d,visible:this.state.isLevelPopVisible,onVisibleChange:this.onVisibleChange,popupProps:b,popupContent:h},s))}}]),n}(o.a.Component);ee(ae,"propTypes",{needTagSearch:s.a.bool,subject:s.a.string,onChange:s.a.func,noDefaultValue:s.a.bool,autoComplete:s.a.bool,autoWidth:s.a.bool,value:s.a.string}),ee(ae,"defaultProps",{needTagSearch:!0,subject:re.subject,onChange:function e(){},noDefaultValue:!1,autoComplete:!1,autoWidth:!1,value:""})},1453:function(e,t,n){},1454:function(e,t,n){},1456:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var r=n(0),o=n.n(r),a=n(1420),i=n.n(a),c=n(1454),l=n.n(c);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function d(e){var t=g();return function n(){var r=v(e),o;if(t){var a=v(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return h(this,o)}}function h(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?b(e):t}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var E=function(e){m(n,e);var t=d(n);function n(){return s(this,n),t.apply(this,arguments)}return p(n,[{key:"render",value:function e(){var t=this.props.useForList;return o.a.createElement("div",{className:"commit-wrapper ".concat(t?"use-for-list":"")},o.a.createElement("div",{className:"commit-wrapper-left"},o.a.createElement("div",{className:"commit-msg"},o.a.createElement("div",{style:{marginBottom:10}},o.a.createElement(i.a,{width:150,height:24})),o.a.createElement("div",null,o.a.createElement(i.a,{width:20,height:20,circle:!0})," ",o.a.createElement(i.a,{width:300,height:20})))),o.a.createElement(i.a,{width:120,height:32}))}}]),n}(o.a.PureComponent)},1457:function(e,t,n){"use strict";n.d(t,"a",(function(){return Q}));var r=n(0),o=n.n(r),a=n(3),i=n.n(a),c=n(7),l=n(1421),u=n.n(l),s=n(1464),f=n(1455),p=n(289),m=n(1460),y=n(8),d=n(6),h=n(137),b=n(5),g=n(1454);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function E(e){return _(e)||S(e)||O(e)||w()}function w(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function O(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function S(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _(e){if(Array.isArray(e))return e}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t,n){return t&&R(e.prototype,t),n&&R(e,n),e}function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}function N(e,t){return(N=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function k(e){var t=B();return function n(){var r=L(e),o;if(t){var a=L(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return I(this,o)}}function I(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?x(e):t}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var F=window.FORCE.pathResource,M=function(e){C(n,e);var t=k(n);function n(e){var r;return P(this,n),D(x(r=t.call(this,e)),"onChange",(function(e,t){var n=r.props.trackPage;t&&"commitMsg"===t?Object(d.b)({action:"view_commit_detail",control:"commit message",page:n}):Object(d.b)({action:"view_commit_detail",control:"commit id",page:n}),e.preventDefault(),r.setState({isShowCommitDetail:!0}),r.props.onChange(r.props.commitInfo.id)})),D(x(r),"handleMouse",(function(e){r.setState({isHover:e})})),D(x(r),"getIcon",(function(e){var t=r.state,n=t.isHover,a=t.isMsgDescVisible;return n&&e?a?o.a.createElement(y.a,{type:"chevron-up",size:"xs",onClick:function e(){r.setState({isMsgDescVisible:!1})}}):o.a.createElement(y.a,{type:"chevron-down",size:"xs",onClick:function e(){r.setState({isMsgDescVisible:!0})}}):o.a.createElement(y.a,{type:"upload",size:"xs"})})),D(x(r),"getAuthors",(function(){var e=r.props.commitInfo,t=e.committer,n=e.author,o=e.author_name,a=e.committer_name,i=e.author_email,c=e.committer_email,l=[];l.push({id:n?n.id:"",name:n?n.name:o||"",href:"",avatarUrl:n?n.avatar_url:""}),c&&i!==c&&"code@codeup.teambition.com"!==c&&l.push({id:t?t.id:"",name:t?t.name:a||"",href:"",avatarUrl:e?e.avatar_url:""}),l.forEach((function(e){e.avatar_url&&(e.avatarUrl=e.avatar_url)}));var u="";return{authorsTxt:u="".concat(l[0].name).concat(l[1]?"(\u4f5c\u8005)\u548c".concat(l[1].name):""),authors:l}})),D(x(r),"closeCommitDetail",(function(){r.setState({isShowCommitDetail:!1})})),r.state={isMsgDescVisible:!1,isHover:!1,isShowCommitDetail:!1},r}return T(n,[{key:"render",value:function e(){var t=this,n=this.props,r=n.commitInfo,a=n.resourcePath,i=n.additionalRightItem,l=n.isSrcBtnShow,d=n.useForList,h=n.isNeedRestart,g=n.noBuildTag,v=n.trackPage,w=n.projectInfo;if(!r||!Object.keys(r).length)return null;var O,j,S=E((r.message||r.title||"").split("\n")),_=S[0],P=S.slice(1),R;!P.length||1===P.length&&""===P[0]||(R=!0);var T=this.getAuthors(),C=T.authors,N=T.authorsTxt;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"commit-wrapper ".concat(d?"use-for-list":""),onMouseEnter:function e(){t.handleMouse(!0)},onMouseLeave:function e(){t.handleMouse(!1)}},o.a.createElement("div",{className:"commit-wrapper-left"},o.a.createElement("div",{className:"commit-msg"},o.a.createElement("div",{className:"commit-msg-title"},o.a.createElement("a",{className:"text-black",href:"".concat(window.location.origin,"/").concat(F.fullPath,"/commit/").concat(this.props.commitInfo.id),onClick:function e(n){t.onChange(n,"commitMsg")}},_),R?o.a.createElement("span",{className:"commit-msg-desc-trigger show-more-span bright",onClick:function e(){t.setState({isMsgDescVisible:!t.state.isMsgDescVisible})}},o.a.createElement(y.a,{type:"more",className:"show-more-icon"})):null,!g&&o.a.createElement(p.a,{container:{target:"commit",id:r.id},projectInfo:w,isNeedRestart:h})),R&&this.state.isMsgDescVisible?o.a.createElement("div",{className:"commit-msg-desc"},P.map((function(e){return o.a.createElement("div",{className:"commit-msg-desc-item"},e)}))):null,o.a.createElement("div",{className:"commit-msg-userinfo"},o.a.createElement("span",null,o.a.createElement(u.a,{dataSource:C,size:"xs",borderColor:d?"#fff":"#f7f7f7"})),o.a.createElement("span",{className:"commit-user-info small"},o.a.createElement("span",{className:"user-name"},N),o.a.createElement("span",{className:"user-action-des"},b.a["file_commit_".concat(c.b.isInOneHour(r.created_at||r.authored_date)?"no_":"","at")],c.b.getBeautyTime(r.created_at||r.authored_date).toLowerCase()))))),o.a.createElement("div",{className:"commit-wrapper-right"},i||null,o.a.createElement("span",{className:"mr4"},o.a.createElement(m.a,{signature:r.signature,author:{name:r.committer?r.committer.name:r.committer_name||"",avatarUrl:r?r.avatar_url:""}})),o.a.createElement(s.a,{resourcePath:a,onChange:this.onChange,commitInfo:r,pathResource:F,isSrcBtnShow:l,inCommitDetail:!1,trackPage:v}))),!this.props.hasGoUrl&&this.state.isShowCommitDetail&&this.props.noContainer?o.a.createElement(f.a,{commitId:r.id,onChange:this.closeCommitDetail,container:document.getElementById("container"),projectInfo:w}):null)}}]),n}(o.a.PureComponent);D(M,"propTypes",{projectInfo:i.a.object,commitInfo:i.a.object,additionalRightItem:i.a.elementType,onChange:i.a.func,isSrcBtnShow:i.a.bool,noContainer:i.a.bool,hasGoUrl:i.a.bool,useForList:i.a.bool,isNeedRestart:i.a.bool,noBuildTag:i.a.bool,trackPage:i.a.string}),D(M,"defaultProps",{projectInfo:{},commitInfo:{},onChange:function e(){},additionalRightItem:null,isSrcBtnShow:!1,noContainer:!0,hasGoUrl:!1,useForList:!1,isNeedRestart:!1,noBuildTag:!1,trackPage:""});var U=n(1456);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function V(e,t){if(null==e)return{};var n=z(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function z(e,t){if(null==e)return{};var n={},r=Object.keys(e),o,a;for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}function K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t,n){return t&&H(e.prototype,t),n&&H(e,n),e}function X(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}function q(e,t){return(q=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function J(e){var t=Z();return function n(){var r=$(e),o;if(t){var a=$(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return G(this,o)}}function G(e,t){return!t||"object"!==A(t)&&"function"!=typeof t?Y(e):t}function Y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function $(e){return($=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var Q=function(e){X(n,e);var t=J(n);function n(){return K(this,n),t.apply(this,arguments)}return W(n,[{key:"render",value:function e(){var t=this.props,n=t.isLoading,r=V(t,["isLoading"]);return n?o.a.createElement(U.a,r):o.a.createElement(M,r)}}]),n}(o.a.Component)},1461:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(1491),i=n.n(a);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var n=u(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function u(e,t){if(null==e)return{};var n={},r=Object.keys(e),o,a;for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}var s=function e(t){var n=t.className,r=l(t,["className"]);return o.a.createElement("div",c({className:"file-panel-normal file-panel-src ".concat(n||"")},r))};s.Header=function(e){return o.a.createElement("div",{className:" file-panel-src-header ".concat(e.className||"")},e.children)},s.Body=function(e){var t=e.noPadding,n=e.onlyPaddingBottom,r=e.className,a=e.children;return o.a.createElement("div",{className:"file-panel-src-body ".concat(r||""," ").concat(n?"onlyPaddingBottom":""," ").concat(t?"noPadding":"")},a)},t.a=s},1462:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n(0),o=n.n(r),a=n(1441),i=n(1442),c=n.n(i),l=n(1496),u=n.n(l);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var n=m(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function m(e,t){if(null==e)return{};var n={},r=Object.keys(e),o,a;for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}function g(e,t){return(g=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function v(e){var t=O();return function n(){var r=j(e),o;if(t){var a=j(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return E(this,o)}}function E(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?w(e):t}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var S=function(e){b(n,e);var t=v(n);function n(){return y(this,n),t.apply(this,arguments)}return h(n,[{key:"render",value:function e(){var t=this.props,n=t.fileName,r=t.className,i=p(t,["fileName","className"]),c=a.a(n),l=a.a("demo.text");return o.a.createElement("span",f({className:"".concat(r," ").concat(c||l," file-name-icon")},i))}}]),n}(o.a.Component)},1463:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var r=n(0),o=n.n(r),a=n(3),i=n.n(a),c=n(1434),l=n.n(c),u=n(2),s=n(21),f,p={clj:"clojure",coffee:"coffee script",htm:"html",xhtml:"html",js:"javascript",jsx:"javascript",md:"markdown",py:"python",rb:"ruby",rs:"rust",ts:"typescript",tsx:"typescript",less:"css",scss:"css"},m=n(1469);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function h(e,t){if(null==e)return{};var n=b(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function b(e,t){if(null==e)return{};var n={},r=Object.keys(e),o,a;for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),e}function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}function O(e,t){return(O=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function j(e){var t=P();return function n(){var r=R(e),o;if(t){var a=R(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return S(this,o)}}function S(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?_(e):t}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C={url:"//g.alicdn.com/platform/lib/1.1.7/1-require/requirejs/2.1.20/require.js",paths:{vs:"".concat(u.h.ENUM.cdn_host[window.FORCE.env],"/code/lib/monaco-editor/0.17.1/min/vs")}},N=function(e){w(n,e);var t=j(n);function n(e){var r;return g(this,n),T(_(r=t.call(this,e)),"handleFocus",(function(e){r.props.autoFocus&&e.focus()})),r.state={language:r.getLanguageFromFileName(e.fileName),loading:!0},r}return E(n,[{key:"componentDidUpdate",value:function e(t){t.fileName!==this.props.fileName&&window.monaco&&this.setState({language:this.getLanguageFromFileName(this.props.fileName)})}},{key:"getLanguageFromFileName",value:function e(t){var n;if(t){var r=t.split(".")[t.split(".").length-1];n=p[r]?p[r]:r}else n="plaintext";return n}},{key:"render",value:function e(){var t=this,n=this.state,r=n.language,a=n.loading,i=this.props,c=i.editorStyle,u=i.size,f=i.theme,p=h(i,["editorStyle","size","theme"]);return o.a.createElement("div",{className:"editor-container",style:c},"small"===u&&a&&o.a.createElement("div",{className:"editor-loading"},o.a.createElement(s.a,null)),"medium"===u&&a?o.a.createElement(s.a,{style:{marginTop:80}}):null,o.a.createElement(l.a,d({requireConfig:C,theme:f,language:r,options:{selectOnLineNumbers:!0,automaticLayout:!0,scrollBeyondLastLine:!1,minimap:{enabled:!1}},height:a?"calc(100% - 80px)":"100%",editorWillMount:function e(){t.setState({loading:!1})},editorDidMount:this.handleFocus},p)))}}]),n}(o.a.Component);T(N,"propTypes",{editorStyle:i.a.object,size:i.a.string,theme:i.a.string}),T(N,"defaultProps",{editorStyle:{height:"calc(100vh - 76px - 162px)"},size:"medium",theme:"vs"})},1466:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n(0),o=n.n(r),a=n(6),i=n(99),c=n.n(i);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),e}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function b(e,t){return(b=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function g(e){var t=w();return function n(){var r=O(e),o;if(t){var a=O(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return v(this,o)}}function v(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?E(e):t}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var j=function(e){h(n,e);var t=g(n);function n(){return m(this,n),t.apply(this,arguments)}return d(n,[{key:"render",value:function e(){var t=this.props.useBy;return o.a.createElement(c.a,u({plugin:{type:"codeup-task",tbHost:window.UILessConfig.tbHost},container:{type:"task",target:"merge_request"},style:{width:"100%"},uiless_config:f(f({},window.UILessConfig),{},{codeupTrack:a.b,useBy:t})},this.props))}}]),n}(o.a.Component)},1469:function(e,t,n){},1491:function(e,t,n){},1492:function(e,t,n){},1494:function(e,t,n){},1495:function(e,t,n){},1496:function(e,t,n){},1497:function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));var r=n(0),o=n.n(r),a=n(1),i=n.n(a),c=n(45),l=n.n(c),u=n(21),s=n(23),f=n(78),p=n.n(f),m=n(1424),y=n.n(m),d=n(7),h=n(1498),b=n.n(h),g=n(6),v=n(17),E=n(165);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t,n){return t&&_(e.prototype,t),n&&_(e,n),e}function R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}function T(e,t){return(T=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function C(e){var t=I();return function n(){var r=x(e),o;if(t){var a=x(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return N(this,o)}}function N(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?k(e):t}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L="gram-overlay",D=new p.a({html:!0,linkify:!0}).use(y.a),F=function(e){R(n,e);var t=C(n);function n(){var e;S(this,n);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return B(k(e=t.call.apply(t,[this].concat(i))),"preventDefaultScroll",(function(t){var n=document.querySelector(".".concat(L," .next-tabs-content"));n&&(t?n.addEventListener("scroll",e.stopPropagation):n.removeEventListener("scroll",e.stopPropagation))})),B(k(e),"stopPropagation",(function(e){e.stopPropagation()})),B(k(e),"renderReference",(function(t){var n=e.props,r=n.resourcePath,a=n.onJump,i=n.trackMap,c=n.activeId,l=n.lsSearchMap,u=n.gramOverlayPage,f=n.gramOverlayPageSize,p=n.getSnippets,m=null;return m=t&&t.length?o.a.createElement(E.default,{className:"project-content-list project-mr-list",pagination:{onLoadMore:function t(n){var r=l&&l[c];e.preventDefaultScroll(!0),p&&c&&r&&p(r,c,n,e.preventDefaultScroll)},hasMore:u*f<t.length,useWindow:!1,getScrollParent:function e(){return document.querySelector(".".concat(L," .next-tabs-content"))}}},t.slice(0,u*f).map((function(t){var n=t.file_path===r;return o.a.createElement("div",{className:"".concat(L,"-definition-item"),onClick:function e(n){a&&a(n,t,"reference",i[c])}},e.renderItem(t,n))}))):o.a.createElement(s.a,{imgType:"org-list-empty",content:"\u5728 0 \u4e2a\u6587\u4ef6\u4e2d\u88ab\u5f15\u7528",style:{paddingBottom:16}}),o.a.createElement("div",null,m)})),B(k(e),"getContent",(function(t){var n=e.props,r=n.snippetMap,o=n.activeId,a=n.language,i=r[o]||[],c="";return i.forEach((function(e){var n;e.file_path===t.file_path&&(e.snippets||[]).forEach((function(e){e.start_line===t.start_line&&(c=e.content)}))})),a?l.a.highlight(a,c).value:l.a.highlightAuto(c).value})),B(k(e),"renderItem",(function(t,n){var r=e.props.isLoadingSnippets;return o.a.createElement("div",{className:"item-detail"},o.a.createElement("div",{className:"".concat(L,"-definition-file")},n&&o.a.createElement("div",{className:"file-tag"},o.a.createElement(a.Tag.Colorable,{color:"blue"},"\u5f53\u524d\u6587\u4ef6")),o.a.createElement(v.a,{path:t.file_path})),o.a.createElement("div",{className:"".concat(L,"-definition-line ").concat(n?"current":"")},o.a.createElement("div",{className:"".concat(L,"-definition-line-left")},t.start_line+1),r?o.a.createElement("div",{className:"".concat(L,"-definition-line-right"),style:{textAlign:"center"}},o.a.createElement(a.Loading,null)):o.a.createElement("div",{className:"".concat(L,"-definition-line-right"),dangerouslySetInnerHTML:{__html:e.getContent(t)}})))})),B(k(e),"toggleTab",(function(t){var n=e.props,r,o,a,i=j(j({},n.trackMap[n.activeId]),{},{semantic:t});Object(g.b)(i)})),e}return P(n,[{key:"render",value:function e(){var t=this,n=this.props,r=n.visible,i=n.lsSearchMap,c=n.onClose,l=n.activeId,s=n.resourcePath,f=n.onJump,p=n.container,m=n.loading,y=n.trackMap,h=n.align,b=void 0===h?"tl bl":h,g=i&&i[l],v=[],E,w;if(g){var O=g.hover,j;v=g.reference,w=g.definition,E=(O?O.split("\n---\n"):[])[1]||""}return o.a.createElement(a.Overlay,{visible:r&&g,target:l,safeNode:l,container:p,onRequestClose:function e(){c&&c()},shouldUpdatePosition:!0,animation:!1,align:b,ref:this.overlay},o.a.createElement("div",{className:L},o.a.createElement(a.Tab,{defaultActiveKey:"definition",onChange:this.toggleTab},o.a.createElement(a.Tab.Item,{key:"definition",title:o.a.createElement("div",{className:"".concat(L,"-tab-title")},o.a.createElement("span",null,"\u5b9a\u4e49"))},m||!g?o.a.createElement(u.a,null):o.a.createElement("div",{className:"".concat(L,"-definition")},w.map((function(e){var n=e.file_path===s;return o.a.createElement("div",{className:"".concat(L,"-definition-item"),onClick:function t(n){f&&f(n,e,"definition",y[l])}},t.renderItem(e,n))})),E&&o.a.createElement("div",{className:"".concat(L,"-definition-desc")},o.a.createElement("div",{className:"markdown-body",dangerouslySetInnerHTML:{__html:d.b.xssHandler(D.render(E||""))}})))),o.a.createElement(a.Tab.Item,{key:"reference",title:o.a.createElement("div",{className:"".concat(L,"-tab-title")},o.a.createElement("span",null,"\u5f15\u7528")," ",o.a.createElement(a.Badge,{count:v.length}))},m?o.a.createElement(u.a,null):o.a.createElement("div",{className:"".concat(L,"-definition")},this.renderReference(v))))))}}]),n}(o.a.Component)},1498:function(e,t,n){},1499:function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));var r=n(0),o=n.n(r),a=n(1),i=n.n(a),c=n(19),l=n(2),u=n(13),s=n(9),f=n(10),p=n(1500),m=n.n(p),y=n(6);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t,n){return t&&b(e.prototype,t),n&&b(e,n),e}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}function E(e,t){return(E=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function w(e){var t=S();return function n(){var r=_(e),o;if(t){var a=_(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return O(this,o)}}function O(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?j(e):t}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=function(e){v(n,e);var t=w(n);function n(e){var r;return h(this,n),P(j(r=t.call(this,e)),"goSetting",(function(){var e=window.FORCE,t=e.pathResource,n=e.user,r=e.codeReviewDetail;Object(y.b)({action:"go_to_open",page:r&&r.id?"merge_request":"project_file",type:"",control:"",project_id:t&&t.id,app:"linguist_guide",user_id:n.codeUserId}),window.open("/".concat(t.fullPath,"/settings/services#lsif"),"_blank")})),r.state={isTipShow:!1},r}return g(n,[{key:"componentWillMount",value:function e(){var t=this;s.c&&Object(f.y)("first_enter",{first_enter_organization:!0,first_enter_key:"lsif_repo_guide"},!1).then((function(e){e.state&&t.setState({isTipShow:!0})})).catch((function(e){console.log(e)}))}},{key:"render",value:function e(){var t=this,n=this.props.role,r=window.FORCE,i=r.pathResource,s=r.user,p=r.codeReviewDetail,m;return this.state.isTipShow?o.a.createElement("div",{className:"lsif-message"},o.a.createElement(a.Message,{title:o.a.createElement("div",{className:"lsif-message-title"},o.a.createElement("div",null,"\u65b0\u589e",o.a.createElement("span",{className:"strong"},"\u4ee3\u7801\u8bed\u6cd5\u670d\u52a1"),"\u652f\u6301\uff0c\u5feb\u901f\u67e5\u770b\u51fd\u6570\u5b9a\u4e49\u4e0e\u5f15\u7528\uff0c\u63d0\u5347\u6e90\u7801\u9605\u8bfb\u6548\u7387\uff0c\u5feb\u53bb\u8bd5\u8bd5\u5427~"),Object(c.a)(l.d,n)?o.a.createElement("a",{className:"no-href-with-click lsif-message-link",onClick:this.goSetting},"\u524d\u5f80\u542f\u7528"):o.a.createElement("a",{href:Object(u.a)("lsif"),className:"lsif-message-link",target:"_blank",onClick:function e(){Object(y.b)({action:"go_to_doc",page:p&&p.id?"merge_request":"project_file",type:"",control:"",project_id:i&&i.id,app:"linguist_guide",user_id:s.codeUserId})}},"\u4e86\u89e3\u66f4\u591a")),type:"success",closeable:!0,onClose:function e(){t.setState({isTipShow:!1}),Object(y.b)({action:"go_to_close",page:p&&p.id?"merge_request":"project_file",type:"",control:"",project_id:i&&i.id,app:"linguist_guide",user_id:s.codeUserId}),Object(f.Y)("first_enter",{first_enter_organization:!0,first_enter_key:"lsif_repo_guide"})}})):null}}]),n}(o.a.PureComponent)},1500:function(e,t,n){},1501:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var r=n(0),o=n.n(r),a=n(3),i=n.n(a),c=n(1502),l=n.n(c);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),e}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function y(e,t){return(y=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function d(e){var t=g();return function n(){var r=v(e),o;if(t){var a=v(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return h(this,o)}}function h(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?b(e):t}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(e){m(n,e);var t=d(n);function n(){return s(this,n),t.apply(this,arguments)}return p(n,[{key:"render",value:function e(){var t=this.props,n=t.pictureUrl,r=t.title,a=t.desc,i="message-page";return o.a.createElement("div",{className:i},o.a.createElement("img",{className:"".concat(i,"-img"),src:n,alt:r}),r?o.a.createElement("div",{className:"".concat(i,"-title")},r):null,a?o.a.createElement("div",{className:"".concat(i,"-desc")},a):null)}}]),n}(o.a.Component);E(w,"propTypes",{pictureUrl:i.a.string,title:i.a.string,desc:i.a.string}),E(w,"defaultProps",{pictureUrl:"",title:"",desc:""})},1502:function(e,t,n){},1503:function(e,t,n){},1504:function(e,t,n){},1505:function(e,t,n){},1513:function(e,t,n){"use strict";n.d(t,"a",(function(){return ce}));var r=n(0),o=n.n(r),a=n(3),i=n.n(a),c=n(8);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return e.reduce((function(e,t){return s(s({},e),n[t])}),t)}function m(e){return e.join(" ")}function y(e,t){var n=0;return function(r){return n+=1,r.map((function(r,o){return d({node:r,stylesheet:e,useInlineStyles:t,key:"code-segment-".concat(n,"-").concat(o)})}))}}function d(e){var t=e.node,n=e.stylesheet,r=e.style,a=void 0===r?{}:r,i=e.useInlineStyles,c=e.key,u=t.properties,f=t.type,d=t.tagName,h=t.value;if("text"===f)return h;if(d){var b=y(n,i),g=i&&u.className&&u.className.filter((function(e){return!n[e]})),v=g&&g.length?g:void 0,E=i?s(s(s({},u),{className:v&&m(v)}),{},{style:p(u.className,Object.assign({},u.style,a),n)}):s(s({},u),{},{className:m(u.className)}),w=b(t.children);return o.a.createElement(d,l({key:c},E),w)}}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){return w(e)||E(e)||v(e)||g()}function g(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(e,t){if(e){if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}function E(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function w(e){if(Array.isArray(e))return O(e)}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function j(e,t){if(null==e)return{};var n=S(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function S(e,t){if(null==e)return{};var n={},r=Object.keys(e),o,a;for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}var _=/\n/g;function P(e){return e.match(_)}function R(e){var t=e.lines,n=e.startingLineNumber,r=e.style,a=e.onLineNumberClick,i=e.selectedLines;return t.map((function(e,t){var l=t+n;return o.a.createElement("span",{key:"line-".concat(t),className:"react-syntax-highlighter-line-number ".concat(a?"can-click":""," ").concat(i&&i[0]===t+1?"selected":""),style:"function"==typeof r?r(l):r,onClick:a?function(e){a(e,t+1)}:null},o.a.createElement(c.a,{className:"react-syntax-highlighter-line-number-anchor",type:"link",size:"xs"}),"".concat(l,"\n"))}))}function T(e){var t=e.codeString,n=e.codeStyle,r=e.containerStyle,a=void 0===r?{float:"left",paddingRight:"10px"}:r,i=e.numberStyle,c=void 0===i?{}:i,l=e.startingLineNumber,u=e.onLineNumberClick,s=e.selectedLines;return o.a.createElement("code",{style:Object.assign({},n,a)},R({lines:t.replace(/\n$/,"").split("\n"),style:c,startingLineNumber:l,onLineNumberClick:u,selectedLines:s}))}function C(e){var t=e.children,n=e.lineNumber,r=e.lineProps,o=e.className,a=void 0===o?[]:o,i=e.dataLine,c=e.dataStart,l=e.dataEnd,u=e.dataLength,s=e.onClick,f=e.id,p=("function"==typeof r?r(n):r)||{};return p.className=p.className?a.concat(p.className):a,i&&(p["data-line"]=i),c&&(p["data-start"]=c),l&&(p["data-end"]=l),u&&(p["data-length"]=u),s&&(p.onClick=s),f&&(p.id=f),{type:"element",tagName:"span",properties:p,children:t}}function N(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=0;r<e.length;r++){var o=e[r];if("text"===o.type)n.push(C({children:[o],className:t}));else if(o.children){var a=t.concat(o.properties.className);n=n.concat(N(o.children,a))}}return n}function k(e,t){for(var n=N(e.value),r=[],o=-1,a=0,i=function e(){var i=n[a],c=i.children[0].value,l;if(P(c)){var u=c.split("\n");u.forEach((function(e,c){var l=r.length+1,s={type:"text",value:"".concat(e,"\n")};if(0===c){var f=n.slice(o+1,a).concat(C({children:[s],className:i.properties.className}));f.forEach((function(e,t){var n=f[t-1],r=e.children&&e.children[0]&&e.children[0].value&&e.children[0].value.length||0,o=e.properties;o["data-line"]=l,o["data-start"]=n&&n.properties?n.properties["data-end"]+1:r?1:0,o["data-length"]=r,o["data-end"]=Math.max(o["data-start"]+r-1,0)})),r.push(C({children:f,lineNumber:l,lineProps:t}))}else if(c===u.length-1){var p;if(n[a+1]&&n[a+1].children&&n[a+1].children[0]){var m,y=C({children:[{type:"text",value:"".concat(e)}],className:i.properties.className});n.splice(a+1,0,y)}else r.push(C({children:[s],lineNumber:l,lineProps:t,className:i.properties.className,dataLine:l,dataStart:1,dataLength:s.value.length,dataEnd:s.value.length}))}else r.push(C({children:[s],lineNumber:l,lineProps:t,className:i.properties.className,dataLine:l,dataStart:1,dataLength:s.value.length,dataEnd:s.value.length}))})),o=a}a++};a<n.length;)i();if(o!==n.length-1){var c=n.slice(o+1,n.length);c&&c.length&&r.push(C({children:c,lineNumber:r.length+1,lineProps:t}))}return r}function I(e){var t=e.rows,n=e.stylesheet,r=e.useInlineStyles;return t.map((function(e,t){return d({node:e,stylesheet:n,useInlineStyles:r,key:"code-segement".concat(t)})}))}function x(e){var t=e.astGenerator,n=e.language,r=e.code,o=e.defaultCodeValue;if(t.getLanguage){var a=n&&t.getLanguage(n);return"text"===n?{value:o,language:"text"}:a?t.highlight(n,r):t.highlightAuto(r)}try{return n&&"text"!==n?{value:t.highlight(r,n)}:{value:o}}catch(e){return{value:o}}}var B=function(e,t){return function n(r){var a=r.language,i=r.children,c=r.style,l=void 0===c?t:c,u=r.customStyle,s=void 0===u?{}:u,f=r.codeTagProps,p=void 0===f?{style:l['code[class*="language-"]']}:f,m=r.useInlineStyles,y=void 0===m||m,d=r.showLineNumbers,h=void 0!==d&&d,b=r.startingLineNumber,g=void 0===b?1:b,v=r.lineNumberContainerStyle,E=r.lineNumberStyle,w=r.onLineNumberClick,O=r.selectedLines,S=r.wrapLines,_=r.lineProps,P=void 0===_?{}:_,R=r.renderer,C=r.PreTag,N=void 0===C?"pre":C,B=r.CodeTag,D=void 0===B?"code":B,F=r.code,M=void 0===F?Array.isArray(i)?i[0]:i:F,U=r.astGenerator,A=r.positions,V=void 0===A?[]:A,z=r.activeId,K=void 0===z?"":z,H=j(r,["language","children","style","customStyle","codeTagProps","useInlineStyles","showLineNumbers","startingLineNumber","lineNumberContainerStyle","lineNumberStyle","onLineNumberClick","selectedLines","wrapLines","lineProps","renderer","PreTag","CodeTag","code","astGenerator","positions","activeId"]);U=U||e;var W=h?o.a.createElement(T,{containerStyle:v,codeStyle:p.style||{},numberStyle:E,startingLineNumber:g,codeString:M,onLineNumberClick:w,selectedLines:O}):null,X=l.hljs||l['pre[class*="language-"]']||{backgroundColor:"#fff"},q=y?Object.assign({},H,{style:Object.assign({},X,s)}):Object.assign({},H,{className:"hljs"});if(!U)return o.a.createElement(N,q,W,o.a.createElement(D,p,M));S=!(!R||void 0!==S)||S,R=R||I;var J=[{type:"text",value:M}],G=x({astGenerator:U,language:a,code:M,defaultCodeValue:J});null===G.language&&(G.value=J);var Y=S?k(G,P):G.value,Z=L(Y,V,P,K);return o.a.createElement(N,q,W,o.a.createElement(D,p,R({rows:Y,stylesheet:l,useInlineStyles:y})))}};function L(e,t,n,r){return t.forEach((function(t){var n=t.line,o;D(e[n-1]&&e[n-1].children||[],t,r)})),e}function D(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=t.line;e.forEach((function(i,c){if("element"===i.type){var l=i.properties,u;if(l&&l["data-start"]<=t.start&&l["data-end"]>=t.end){var s=i,f=s.properties["data-start"],p=s.properties.className||[];D(i.children,t,n,f,p)}}else{var m=i.value.length;F(e,i,c,r,r+m-1,t,a,n,o)}}))}function F(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[],u=t.value,s=a.start,f=a.end,p=u.substr(0,s-r),m=u.substr(s-r,f-s+1),y=u.substr(f-r+1,o-f),d=[p,m,y],g=d.map((function(e,t){var n,u={type:"text",value:e},d=[{start:r,end:s-1,length:p.length},{start:s,end:f,length:m.length},{start:f+1,end:o,length:y.length}];return C((h(n={children:[u],lineNumber:i,className:[].concat(b(l),[1===t?"grammar-service-mark grammar-file":"",1===t&&c===a.id?"hover":""]),dataLength:i,dataStart:d[t].start,dataEnd:d[t].end},"dataLength",d[t].length),h(n,"onClick",1===t?a.onClick:null),h(n,"id",1===t?a.id:""),n))}));e.splice.apply(e,[n,1].concat(b(g)))}var M={hljs:{display:"block",overflowX:"auto",padding:"0.5em",color:"#383a42",background:"#fafafa"},"hljs-comment":{color:"#a0a1a7",fontStyle:"italic"},"hljs-quote":{color:"#a0a1a7",fontStyle:"italic"},"hljs-doctag":{color:"#a626a4"},"hljs-keyword":{color:"#a626a4"},"hljs-formula":{color:"#a626a4"},"hljs-section":{color:"#e45649"},"hljs-name":{color:"#e45649"},"hljs-selector-tag":{color:"#e45649"},"hljs-deletion":{color:"#e45649"},"hljs-subst":{color:"#e45649"},"hljs-literal":{color:"#0184bb"},"hljs-string":{color:"#50a14f"},"hljs-regexp":{color:"#50a14f"},"hljs-addition":{color:"#50a14f"},"hljs-attribute":{color:"#50a14f"},"hljs-meta-string":{color:"#50a14f"},"hljs-built_in":{color:"#c18401"},"hljs-class .hljs-title":{color:"#c18401"},"hljs-attr":{color:"#986801"},"hljs-variable":{color:"#986801"},"hljs-template-variable":{color:"#986801"},"hljs-type":{color:"#986801"},"hljs-selector-class":{color:"#986801"},"hljs-selector-attr":{color:"#986801"},"hljs-selector-pseudo":{color:"#986801"},"hljs-number":{color:"#986801"},"hljs-symbol":{color:"#4078f2"},"hljs-bullet":{color:"#4078f2"},"hljs-link":{color:"#4078f2",textDecoration:"underline"},"hljs-meta":{color:"#4078f2"},"hljs-selector-id":{color:"#4078f2"},"hljs-title":{color:"#4078f2"},"hljs-emphasis":{fontStyle:"italic"},"hljs-strong":{fontWeight:"bold"}},U=n(1439),A,V,z=B(n.n(U).a,M),K=n(1440),H=n.n(K),W=n(1492);function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function q(){return(q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function J(e,t){if(null==e)return{};var n=G(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function G(e,t){if(null==e)return{};var n={},r=Object.keys(e),o,a;for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}function Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $(e,t,n){return t&&Z(e.prototype,t),n&&Z(e,n),e}function Q(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ee(e,t)}function ee(e,t){return(ee=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function te(e){var t=oe();return function n(){var r=ae(e),o;if(t){var a=ae(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return ne(this,o)}}function ne(e,t){return!t||"object"!==X(t)&&"function"!=typeof t?re(e):t}function re(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ae(e){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ce=function(e){Q(n,e);var t=te(n);function n(){return Y(this,n),t.apply(this,arguments)}return $(n,[{key:"render",value:function e(){var t=this.props,n=t.onLineNumberClick,r=J(t,["onLineNumberClick"]);return o.a.createElement(z,q({customStyle:{padding:0,borderRadius:0,border:"none",marginBottom:"0",background:H.a["color-white"],"white-space":"pre"},lineNumberContainerStyle:{float:"left",paddingLeft:n?"18px":"6px",paddingRight:"8px",marginRight:"8px",textAlign:"right",color:H.a["color-n2-1"]},codeTagProps:{style:{verticalAlign:"middle",fontSize:"12px",lineHeight:"20px"}},onLineNumberClick:n,showLineNumbers:!0},r))}}]),n}(o.a.Component);ie(ce,"propTypes",{onLineNumberClick:i.a.func}),ie(ce,"defaultProps",{onLineNumberClick:null})},1514:function(e,t,n){"use strict";var r=n(0),o=n(1503);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function s(e,t){return(s=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function f(e){var t=y();return function n(){var r=d(e),o;if(t){var a=d(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return p(this,o)}}function p(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?m(e):t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b,g=function(e){u(n,e);var t=f(n);function n(e){var o;return i(this,n),h(m(o=t.call(this,e)),"scrollToMyRef",(function(){o.myRef&&o.myRef.current&&o.myRef.current.scrollIntoView({behavior:"smooth"})})),o.state={},o.myRef=r.createRef(),o}return l(n,[{key:"componentDidMount",value:function e(){console.log("current",this.myRef.current),this.scrollToMyRef()}},{key:"render",value:function e(){var t=this.props,n=t.message,o=t.shine;return r.createElement("div",{className:"YunDouTalk",ref:this.myRef},r.createElement("div",{className:"YunDouIcon"}),r.createElement("div",{className:"YunDouMessage".concat(o?"YunDouMessageShine":"")},n.map((function(e,t){return r.createElement("div",{key:t},e.title&&r.createElement("div",{className:"YunDouMessageTitle"},e.title),e.content&&r.createElement("div",{className:"YunDouMessageContent"},e.content))}))))}}]),n}(r.Component),v=n(1504),E=n(1432);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t,n){return t&&j(e.prototype,t),n&&j(e,n),e}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}function P(e,t){return(P=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function R(e){var t=N();return function n(){var r=k(e),o;if(t){var a=k(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return T(this,o)}}function T(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?C(e):t}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var x,B=function(e){_(n,e);var t=R(n);function n(e){var o;return O(this,n),I(C(o=t.call(this,e)),"getOffsetTop",(function(e){var t=document.getElementById("step-".concat(e));return t&&t.offsetTop})),I(C(o),"scrollSmooth",(function(e){var t=o.getOffsetTop(e);t&&t>88&&Object(E.a)("#step-".concat(e),{offset:-(Number(t)-88)})})),I(C(o),"scrollToMyRef",(function(){o.myRef&&o.myRef.current&&o.myRef.current.scrollIntoView({behavior:"smooth"})})),o.state={clickedButton:null},o.myRef=r.createRef(),o}return S(n,[{key:"componentDidMount",value:function e(){this.scrollToMyRef()}},{key:"componentDidUpdate",value:function e(){this.scrollToMyRef()}},{key:"render",value:function e(){var t=this,n=this.props,o=n.messageType,a=n.content,i=n.onClickType1,c=n.onClickType2;return r.createElement("div",{className:"SelfTalk",id:this.props.id,ref:this.myRef},"MESSAGE"===o&&r.createElement("div",{className:"SelfTalkTypeMessage"},a[0]),"BUTTON"===o&&r.createElement(r.Fragment,null,1===this.state.clickedButton?r.createElement("div",{className:"SelfTalkTypeMessage"},"\u4e00\u952e\u4fee\u590d"===a[0]?"\u52a9\u624b\u5e2e\u6211\u4fee\u590d\u4e00\u4e0b":a[0]):r.createElement("div",{className:"SelfTalkTypeButton",onClick:function e(){i&&i(),t.setState({clickedButton:1})}},a[0])),"BUTTONS"===o&&r.createElement("div",{className:"SelfTalkTypeButtons"},1===this.state.clickedButton?r.createElement("div",{className:"SelfTalkTypeMessage"},a[0]):r.createElement(r.Fragment,null,2!==this.state.clickedButton&&r.createElement("div",{className:"SelfTalkTypeButtonsItem",onClick:function e(){i&&i(),t.setState({clickedButton:1})}},a[0])),2===this.state.clickedButton?r.createElement("div",{className:"SelfTalkTypeMessage"},a[1]):r.createElement(r.Fragment,null,1!==this.state.clickedButton&&r.createElement("div",{className:"SelfTalkTypeButtonsItem",onClick:function e(){c&&c(),t.setState({clickedButton:2})}},a[1]))))}}]),n}(r.Component),L=n(1),D=n(1505);function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e,t,n){return t&&U(e.prototype,t),n&&U(e,n),e}function V(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}function z(e,t){return(z=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function K(e){var t=X();return function n(){var r=q(e),o;if(t){var a=q(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return H(this,o)}}function H(e,t){return!t||"object"!==F(t)&&"function"!=typeof t?W(e):t}function W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var G="Lead",Y=function(e){V(n,e);var t=K(n);function n(e){var o;return M(this,n),J(W(o=t.call(this,e)),"clearStyles",(function(){o.setState({leftStyle:null,rightStyle:null,bottomStyle:null,topStyle:null})})),J(W(o),"renderStyles",(function(){var e=document.getElementById("theia-main-content-panel"),t=document.getElementsByClassName("lineHighlightDecoration"),n=document.body.clientWidth,r=document.body.clientHeight;if(e&&t){for(var a=t.length,i=[],c=[],l=0;l<a;l++)i.push(t[l].getBoundingClientRect().top),c.push(t[l].getBoundingClientRect().bottom);i.sort((function(e,t){return e-t})),c.sort((function(e,t){return t-e}));var u,s=e.getBoundingClientRect().left,f=n-t[0].getBoundingClientRect().right,p=i[0],m=r-c[0];o.setState({leftStyle:{width:s},rightStyle:{width:f},bottomStyle:{width:n-s-f,left:s,height:m},topStyle:{left:s,height:p,width:n-s-f}});var y={leftStyle:{width:s},rightStyle:{width:f},bottomStyle:{width:n-s-f,left:s,height:m},topStyle:{left:s,height:p,width:n-s-f}};console.log("lead a",y)}})),J(W(o),"leadSteps",[{id:0,left:{message:[{title:r.createElement("span",null,"\u6211\u8fd8\u6709\u5176\u4ed6\u80fd\u529b\u54e6",r.createElement("br",null),"\u56db\u5927\u6838\u5fc3\u80fd\u529b\u5b88\u62a4\u4f60\u7684\u4ee3\u7801")},{content:r.createElement("div",null,r.createElement("div",null,r.createElement(L.Icon,{type:"tick",className:"doc-func-tick"}),r.createElement("span",{className:"doc-func-item"},"\u4ee3\u7801\u6258\u7ba1"),r.createElement(L.Icon,{type:"tick",className:"doc-func-tick",style:{marginLeft:34}}),r.createElement("span",{className:"doc-func-item"},"\u5b89\u5168\u68c0\u6d4b")),r.createElement("div",{style:{marginTop:8}},r.createElement(L.Icon,{type:"tick",className:"doc-func-tick"}),r.createElement("span",{className:"doc-func-item"},"\u667a\u80fd\u8bc4\u5ba1"),r.createElement(L.Icon,{type:"tick",className:"doc-func-tick",style:{marginLeft:34}}),r.createElement("span",{className:"doc-func-item"},"\u6587\u6863\u7ba1\u7406")))},{content:r.createElement("div",{className:"doc-desc"},r.createElement("span",{className:"doc-desc-content"},r.createElement("span",{dangerouslySetInnerHTML:{__html:"&#128079"}})," ","\u9650\u65f6\u4f18\u60e0~\u4e0d\u9650\u5bb9\u91cf\u548c\u4eba\u6570"))}]}},{id:1,right:{messageType:"BUTTONS",content:["\u4e0d\u4e86\uff0c\u8c22\u8c22","\u514d\u8d39\u4f7f\u7528"],onClickType1:function e(){setTimeout((function(){o.updateStep(2),setTimeout((function(){o.props.onClose&&o.props.onClose()}),3e3)}),500)},onClickType2:function e(){window.open("https://accountid-devops.aliyun.com/create-org?appId=5e730cf2201d20d717988e46&channel=yy_1024","_blank"),o.props.onClose&&o.props.onClose()}}},{id:2,left:{message:[{title:"\u6536\u5230~\u6211\u5148\u64a4\u4e86"},{content:"\u6709\u95ee\u9898\u968f\u65f6\u6233\u6211\u54e6"}]}}]),J(W(o),"getOffsetTop",(function(e){var t=document.getElementById("step-".concat(e));return t&&t.offsetTop})),J(W(o),"scrollSmooth",(function(e){var t=o.getOffsetTop(e);t&&t>88&&Object(E.a)("#step-".concat(e),{offset:-(Number(t)-88)})})),J(W(o),"updateStep",(function(e){if(e){var t=o.state.steps;t.push(o.leadSteps[e]),o.setState({steps:t,currentStep:e}),o.scrollSmooth(e)}else{var n=o.state.steps;n.push(o.leadSteps[o.state.currentStep]),o.setState({steps:n,currentStep:o.state.currentStep+1}),o.scrollSmooth(o.state.currentStep)}})),o.state={steps:[],currentStep:0,leftStyle:null,rightStyle:null,bottomStyle:null,topStyle:null},o}return A(n,[{key:"componentDidMount",value:function e(){var t=this;this.props.onStart&&this.props.onStart(),this.updateStep(),setTimeout((function(){t.updateStep()}),1e3)}},{key:"render",value:function e(){return r.createElement("div",{className:"Lead",id:"leadPage"},r.createElement("div",{className:"LeadMaskLeft LeadMask",style:this.state.leftStyle}),r.createElement("div",{className:"LeadMaskTop LeadMask",style:this.state.topStyle}),r.createElement("div",{className:"LeadMaskRight LeadMask",style:this.state.rightStyle}),r.createElement("div",{className:"LeadMaskBottom LeadMask",style:this.state.bottomStyle}),r.createElement("div",{className:"LeadBox",id:"leadBox"},this.state.steps.map((function(e){return r.createElement(r.Fragment,null,e.left&&r.createElement("div",{className:"LeadMessage LeadMessageLeft",key:e.id,id:"step-".concat(e.id,"-wrap")},r.createElement(g,{message:e.left.message,shine:e.shine})),e.right&&r.createElement("div",{className:"LeadMessage LeadMessageRight",key:e.id,id:"step-".concat(e.id,"-wrap")},r.createElement(B,{messageType:e.right.messageType,content:e.right.content,onClickType1:e.right.onClickType1,onClickType2:e.right.onClickType2,id:"step-".concat(e.id)})))}))))}}]),n}(r.Component),Z=t.a=Y},1530:function(e,t,n){},1531:function(e,t,n){},1618:function(e,t,n){},1621:function(e,t,n){},1696:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(16),i=n.n(a),c=n(65),l=n(32),u=n(2),s=n(33),f=n(19),p=n(4),m=n(3),y=n.n(m),d=n(1),h=n(6);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function v(e,t){if(null==e)return{};var n=E(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function E(e,t){if(null==e)return{};var n={},r=Object.keys(e),o,a;for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t,n){return t&&O(e.prototype,t),n&&O(e,n),e}function S(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}function _(e,t){return(_=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function P(e){var t=C();return function n(){var r=N(e),o;if(t){var a=N(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return R(this,o)}}function R(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?T(e):t}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var k=function(e){S(n,e);var t=P(n);function n(){return w(this,n),t.apply(this,arguments)}return j(n,[{key:"render",value:function e(){var t=window.FORCE.resourceSubject.revisionType,n=this.props,r=n.tooltipText,a=n.isIcon,i=v(n,["tooltipText","isIcon"]),c;return c=a?d.Button.Icon:d.Button,"branch"!==t?o.a.createElement(d.Balloon.Tooltip,{align:"t",trigger:o.a.createElement(c,g({disabled:!0},i)),text:r}):o.a.createElement(c,i)}}]),n}(o.a.Component);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function B(e,t){if(null==e)return{};var n=L(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function L(e,t){if(null==e)return{};var n={},r=Object.keys(e),o,a;for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}function D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M(e,t,n){return t&&F(e.prototype,t),n&&F(e,n),e}function U(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}function A(e,t){return(A=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function V(e){var t=H();return function n(){var r=W(e),o;if(t){var a=W(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return z(this,o)}}function z(e,t){return!t||"object"!==I(t)&&"function"!=typeof t?K(e):t}function K(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function H(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var X=function(e){U(n,e);var t=V(n);function n(){return D(this,n),t.apply(this,arguments)}return M(n,[{key:"render",value:function e(){var t=this.props,n=t.ipSetting,r=B(t,["ipSetting"]);return n?n.ip_whitelist_enabled&&"all"===n.scope?o.a.createElement(d.Balloon.Tooltip,{align:"t",trigger:o.a.createElement(d.Button,x({disabled:!0},r)),text:"\u4f01\u4e1a\u5df2\u542f\u7528 IP \u767d\u540d\u5355\u4e25\u683c\u7ba1\u63a7\uff0c\u6682\u4e0d\u652f\u6301\u4f7f\u7528 Web IDE"}):o.a.createElement(k,r):null}}]),n}(o.a.Component),q=n(10),J=n(7),G=n(291),Y=n.n(G),Z=n(8),$=n(74),Q=n(1495),ee=n(9),te=n(98),ne=n.n(te);function re(e){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ie(e,t,n){return t&&ae(e.prototype,t),n&&ae(e,n),e}function ce(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}function le(e,t){return(le=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function ue(e){var t=pe();return function n(){var r=me(e),o;if(t){var a=me(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return se(this,o)}}function se(e,t){return!t||"object"!==re(t)&&"function"!=typeof t?fe(e):t}function fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var de=u.a.visibility_levels,he="https-notset-repo-ids",be="ssh-notset-repo-ids",ge="\u5df2\u5f00\u542f\u514b\u9686\u4e0b\u8f7d\u63a7\u5236\uff0c\u8bf7\u901a\u8fc7 WebIDE \u6216\u9875\u9762\u7f16\u8f91\u3001\u6d4f\u89c8",ve="\u5df2\u5f00\u542f\u514b\u9686\u4e0b\u8f7d\u63a7\u5236\uff0c\u8bf7\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\u64cd\u4f5c ",Ee=function(e){ce(n,e);var t=ue(n);function n(e){var r;return oe(this,n),ye(fe(r=t.call(this,e)),"beforeOpen",(function(){r.getKeys()})),ye(fe(r),"filterLevel",(function(e){var t="";return de.forEach((function(n){n.value===Number(e)&&(t=n.label)})),t})),ye(fe(r),"goWebIde",(function(e,t){var n=window.FORCE.resourceSubject,r=n.revisionType;e.preventDefault(),Object(q.P)({filepath:t,branch:"branch"===r?n.revision:"",commit:"sha1"===r?n.revision:"",line:"",column:"",type:"view",merge_commit:"",mergerequestId:""}).then((function(e){window.open(e.endpoint)})).catch((function(e){console.error(e)}))})),ye(fe(r),"getKeys",(function(){p.a.forceFetch({api:"keys.list",data:{page:1,per_page:10}}).then((function(e){r.setState({keys:e.list})}))})),ye(fe(r),"setCachedRepoIds",(function(e){var t=r.getCachedRepoIds(e),n=r.getCachedRepoValue();t.includes(n)||t.push(n),J.b.setCachedData(e,JSON.stringify(t))})),ye(fe(r),"getCachedRepoValue",(function(){var e=window.FORCE,t=e.pathResource,n=e.user;return"".concat(t.id,"_").concat(n.codeUserId)})),ye(fe(r),"getCachedRepoIds",(function(e){var t=J.b.getCachedData(e);return t?JSON.parse(t):[]})),ye(fe(r),"renderViewUsername",(function(){var e=r.props.httpsAccount,t=o.a.createElement("div",null,"\u7528\u6237\u540d\u8bf7\u4f7f\u7528\u5e10\u53f7\u8bbe\u7f6e\u4e2d\u7684\u90ae\u7bb1\u6216\u624b\u673a\u5e10\u53f7\u3002",o.a.createElement("a",{href:"https://account.teambition.com/my/account",target:"_blank",className:"https-clone-message-link"},"\u67e5\u770b\u7528\u6237\u540d"));return ee.c&&(t=e&&"no_https_secret"===e.account_type?o.a.createElement("div",null,"\u672a\u914d\u7f6e HTTPS \u514b\u9686\u5bc6\u7801\uff0c\u8bf7\u5148"," ",o.a.createElement("a",{href:"#",onClick:function e(){r.setState({httpsSetting:!0,httpsNavKey:"https-password"})}},"\u8bbe\u7f6e HTTPS \u514b\u9686\u5bc6\u7801")):o.a.createElement("div",null,"\u5fd8\u8bb0\u514b\u9686\u8d26\u53f7\u6216\u5bc6\u7801\uff1f",o.a.createElement("a",{href:"#",onClick:function e(){r.setState({httpsSetting:!0,httpsNavKey:"https-password"})}},"\u7acb\u5373\u67e5\u770b"))),t})),ye(fe(r),"renderSshMessage",(function(){var e=r.state.activeTitleIndex,t=r.state.keys,n=r.getCachedRepoIds(be).includes(r.getCachedRepoValue());return"SSH"===e&&!n&&t?o.a.createElement(d.Message,{className:"ssh-notset-message ".concat(t.length?"one-line":""),type:"warning",closeable:!0,onClose:function e(){r.setCachedRepoIds(be)}},0===t.length?o.a.createElement("div",null,"\u672a\u914d\u7f6e SSH \u5bc6\u94a5\uff0c\u8bf7\u5148",o.a.createElement("a",{className:"ssh-notset-message-link",ref:function e(t){r.btn=t},onClick:function e(){ee.c?r.setState({httpsSetting:!0,httpsNavKey:"ssh-key"}):r.setState({isSetting:!0})}},"\u8bbe\u7f6e SSH \u5bc6\u94a5"),"\uff0c\u6216\u901a\u8fc7"," ",o.a.createElement(d.Button,{type:"primary",onClick:function e(){r.setState({activeTitleIndex:"HTTPS"})},component:"a",text:!0},"HTTPS")," ","\u514b\u9686\u3002"):o.a.createElement("div",null,"\u7ba1\u7406 SSH \u5bc6\u94a5\uff1f",o.a.createElement("a",{className:"ssh-notset-message-link",onClick:function e(){ee.c?r.setState({httpsSetting:!0,httpsNavKey:"ssh-key"}):r.setState({isSetting:!0})}},"\u7acb\u5373\u67e5\u770b"))):null})),r.state={activeTitleIndex:"SSH",isSetting:!1,httpsSetting:!1,httpsNavKey:null},r}return ie(n,[{key:"renderDownloadDropdownJsx",value:function e(t){var n=this.props,r=n.isEmpty,a=n.project_clone_download,i=window.FORCE,c=i.pathResource,l=i.resourceSubject,u;if(r||t)return null;if(a&&(a.downloadLimit&&"disable"===a.downloadLimit.state))return o.a.createElement(o.a.Fragment,null,o.a.createElement(d.Balloon.Tooltip,{align:"t",text:"\u5df2\u5f00\u542f\u514b\u9686\u4e0b\u8f7d\u63a7\u5236\uff0c\u8bf7\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\u64cd\u4f5c ",trigger:o.a.createElement(d.Button,{type:"secondary",component:"a",disabled:!0,className:"gitClone-download-btn download-zip"},"\u4e0b\u8f7d ZIP")}),o.a.createElement("span",{className:"gitClone-download-btn-line"}," "),o.a.createElement(d.Balloon.Tooltip,{align:"t",text:"\u5df2\u5f00\u542f\u514b\u9686\u4e0b\u8f7d\u63a7\u5236\uff0c\u8bf7\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\u64cd\u4f5c ",trigger:o.a.createElement(d.Button,{type:"secondary",className:"gitClone-download-btn download-tar",component:"a",disabled:!0},"\u4e0b\u8f7d TAR")}));return o.a.createElement(o.a.Fragment,null,o.a.createElement(d.Button,{type:"secondary",component:"a",href:"/".concat(c.fullPath,"/repository/archive.zip?ref=").concat(encodeURIComponent(l.revision)),className:"gitClone-download-btn download-zip",onClick:function e(){Object(h.b)({action:"download",page:"Repo-Files",control:"download - zip"})}},"\u4e0b\u8f7d ZIP"),o.a.createElement("span",{className:"gitClone-download-btn-line"}," "),o.a.createElement(d.Button,{type:"secondary",className:"gitClone-download-btn download-tar",component:"a",href:"/".concat(c.fullPath,"/repository/archive.tar.gz?ref=").concat(encodeURIComponent(l.revision)),onClick:function e(){Object(h.b)({action:"download",page:"Repo-Files",control:"download - tar"})}},"\u4e0b\u8f7d TAR"))}},{key:"render",value:function e(){var t=this,n=this.props,r=n.projectInfo,a=n.httpsAccount,i=n.project_clone_download,c=this.state,l=c.activeTitleIndex,s=c.httpsSetting,f=c.httpsNavKey,p=window.FORCE.pathResource,m=[{title:"SSH",address:r.ssh_url_to_repo},{title:"HTTPS",address:r.http_url_to_repo}],y=!0;u.a.visibility_level_text[r.visibility_level]&&"private"!==u.a.visibility_level_text[r.visibility_level]&&(y=!1);var b="Guest"===p.role,g=this.getCachedRepoIds(he).includes(this.getCachedRepoValue()),v=ee.c&&!(a&&"no_https_secret"===a.account_type),E=!1,w=!1,O=!1,j=o.a.createElement(d.Button,{type:"primary",disabled:!0},o.a.createElement(Z.a,{type:"arrow-down-o"}),"\u514b\u9686/\u4e0b\u8f7d");if(!i)return j;if(E=i.sshCloneLimit&&"disable"===i.sshCloneLimit.state,w=i.httpCloneLimit&&"disable"===i.httpCloneLimit.state,O=i.downloadLimit&&"disable"===i.downloadLimit.state,E&&w&&O)return o.a.createElement(d.Balloon.Tooltip,{align:"t",trigger:j},ge);var S="SSH"===l&&E||"HTTPS"===l&&w;return o.a.createElement(o.a.Fragment,null,o.a.createElement(d.Overlay.Popup,{beforeOpen:this.beforeOpen,trigger:o.a.createElement(d.Button,{type:"primary"},o.a.createElement(Z.a,{type:"arrow-down-o"}),"\u514b\u9686/\u4e0b\u8f7d"),triggerType:"click",align:"tr br"},o.a.createElement("div",{className:"clone-popup"},o.a.createElement(d.Tab,{activeKey:l},m.map((function(e){return o.a.createElement(d.Tab.Item,{title:e.title,key:e.title,onClick:function e(n){t.setState({activeTitleIndex:n})}},"HTTPS"===l&&!g&&o.a.createElement(d.Message,{className:"https-clone-message ".concat(v?"one-line":""),type:"warning",closeable:!0,onClose:function e(){t.setCachedRepoIds(he)}},t.renderViewUsername()),t.renderSshMessage(),o.a.createElement("div",{className:"clone-popup-content"},o.a.createElement(d.Input,{className:"gitClone-address-input",value:m.find((function(e){return e.title===l})).address,readOnly:!0}),S?o.a.createElement(d.Balloon.Tooltip,{align:"t",trigger:o.a.createElement(d.Button,{type:"normal",className:"gitClone-copy-btn",disabled:!0,onClick:function e(){}},o.a.createElement(Z.a,{type:"copy",biz:"code"}))},"\u5df2\u5f00\u542f\u514b\u9686\u4e0b\u8f7d\u63a7\u5236\uff0c\u8bf7\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\u64cd\u4f5c "):o.a.createElement(Y.a,{text:m.find((function(e){return e.title===l})).address,onCopy:function e(){Object(h.b)({action:"SSH"===l?"copy_ssh":"copy_https",page:"Repo-Files",type:"",control:""}),d.Toast.success({title:"\u590d\u5236\u6210\u529f"})}},o.a.createElement(d.Button,{type:"normal",className:"gitClone-copy-btn",onClick:function e(){}},o.a.createElement(Z.a,{type:"copy",biz:"code"})))))}))),this.renderDownloadDropdownJsx(b,y))),o.a.createElement(d.Dialog,{title:"SSH \u5bc6\u94a5",safeNode:function e(){return t.btn},visible:this.state.isSetting,footer:!1,onClose:function e(){return t.setState({isSetting:!1})}},o.a.createElement($.a,{page:"Repo-Files"})),ee.c&&o.a.createElement(ne.a,{code:!0,uiless_config:window.UILessConfig,selectedNavKey:f||"personal-info",visible:s,noTitle:!0,dingtalk:!0,sessionTime:!0,onClose:function e(){return t.setState({httpsSetting:!1})}}))}}]),n}(o.a.Component),we=n(1618);function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _e(e,t,n){return t&&Se(e.prototype,t),n&&Se(e,n),e}function Pe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Re(e,t)}function Re(e,t){return(Re=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Te(e){var t=ke();return function n(){var r=Ie(e),o;if(t){var a=Ie(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Ce(this,o)}}function Ce(e,t){return!t||"object"!==Oe(t)&&"function"!=typeof t?Ne(e):t}function Ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ke(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ie(e){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Be="https-notset-repo-ids",Le="ssh-notset-repo-ids",De=function(e){Pe(n,e);var t=Te(n);function n(e){var r;return je(this,n),xe(Ne(r=t.call(this,e)),"getKeys",(function(){p.a.forceFetch({api:"keys.list",data:{page:1,per_page:10}}).then((function(e){r.setState({keys:e.list})}))})),xe(Ne(r),"setCachedRepoIds",(function(e){var t=r.getCachedRepoIds(e),n=r.getCachedRepoValue();t.includes(n)||t.push(n),J.b.setCachedData(e,JSON.stringify(t))})),xe(Ne(r),"getCachedRepoValue",(function(){var e=window.FORCE,t=e.pathResource,n=e.user;return"".concat(t.id,"_").concat(n.codeUserId)})),xe(Ne(r),"getCachedRepoIds",(function(e){var t=J.b.getCachedData(e);return t?JSON.parse(t):[]})),r.state={isSetting:!1,keys:null,httpsSetting:!1,personalNavKey:null},r}return _e(n,[{key:"componentDidMount",value:function e(){this.getKeys()}},{key:"render",value:function e(){var t=this,n=this.props.projectInfo,r=this.props.cloneWay,a=this.props.httpsAccount,i=[{title:"SSH",address:n.ssh_url_to_repo},{title:"HTTPS",address:n.http_url_to_repo}],c=this.state,l=c.keys,u=c.httpsSetting,s=c.personalNavKey,f=this.getCachedRepoIds("ssh-notset-repo-ids").includes(this.getCachedRepoValue()),p=this.getCachedRepoIds("https-notset-repo-ids").includes(this.getCachedRepoValue());return o.a.createElement("div",{className:"empty-clone"},o.a.createElement("div",{className:"empty-clone-select-content"},o.a.createElement(d.Select,{className:"gitClone-way-select",value:r,onChange:function e(n){t.props.updateData({cloneWay:n})}},i.map((function(e){return o.a.createElement(d.Select.Option,{value:e.title},e.title)}))),o.a.createElement(d.Input,{className:"gitClone-address-input",value:i.find((function(e){return e.title===r})).address,readOnly:!0}),o.a.createElement(Y.a,{text:i.find((function(e){return e.title===r})).address,onCopy:function e(){Object(h.b)({action:"SSH"===r?"copy_ssh":"copy_https",page:"Empty-Repo",type:"",control:""}),d.Toast.success({title:"\u590d\u5236\u6210\u529f"})}},o.a.createElement(d.Button,{type:"normal",className:"gitClone-copy-btn",onClick:function e(){}},o.a.createElement(Z.a,{type:"copy",biz:"code"})))),o.a.createElement("div",{className:"empty-clone-tip"},ee.c&&"HTTPS"===r&&!p&&a&&o.a.createElement(d.Message,{className:"https-clone-message",type:"notice",closeable:!0,onClose:function e(){t.setCachedRepoIds("https-notset-repo-ids")}},"no_https_secret"!==a.account_type?o.a.createElement("div",{className:"tip-content"},o.a.createElement("div",null,"\u5fd8\u8bb0\u514b\u9686\u8d26\u53f7\u6216\u5bc6\u7801\uff1f"),o.a.createElement("div",null,o.a.createElement("a",{className:"clone-message-link",href:"#",onClick:function e(){t.setState({httpsSetting:!0,personalNavKey:"https-password"})}},"\u7acb\u5373\u67e5\u770b"))):o.a.createElement("div",{className:"tip-content"},o.a.createElement("div",null,"\u672a\u914d\u7f6e HTTPS \u514b\u9686\u5bc6\u7801\uff0c\u8bf7\u5148\u8bbe\u7f6e"),o.a.createElement("div",null,o.a.createElement("a",{className:"clone-message-link",href:"#",onClick:function e(){t.setState({httpsSetting:!0,personalNavKey:"https-password"})}},"\u53bb\u8bbe\u7f6e")))),"SSH"===r&&l&&!f&&o.a.createElement(d.Message,{className:"ssh-notset-message",type:"notice",closeable:!0,onClose:function e(){t.setCachedRepoIds("ssh-notset-repo-ids")}},l.length>0?o.a.createElement("div",{className:"tip-content"},o.a.createElement("div",null,"\u7ba1\u7406 SSH \u5bc6\u94a5\uff1f"),o.a.createElement("div",null,o.a.createElement("a",{className:"clone-message-link",ref:function e(n){t.btn=n},onClick:function e(){ee.c?t.setState({httpsSetting:!0,personalNavKey:"ssh-key"}):t.setState({isSetting:!0})}},"\u7acb\u5373\u67e5\u770b"))):o.a.createElement("div",{className:"tip-content"},o.a.createElement("div",null,"\u672a\u914d\u7f6e SSH \u5bc6\u94a5\uff0c\u8bf7\u5148\u8bbe\u7f6e"),o.a.createElement("div",null,o.a.createElement("a",{className:"clone-message-link",ref:function e(n){t.btn=n},onClick:function e(){ee.c?t.setState({httpsSetting:!0,personalNavKey:"ssh-key"}):t.setState({isSetting:!0})}},"\u53bb\u8bbe\u7f6e"))))),o.a.createElement(d.Dialog,{title:"SSH \u5bc6\u94a5",safeNode:function e(){return t.btn},visible:this.state.isSetting,footer:!1,onClose:function e(){return t.setState({isSetting:!1})}},o.a.createElement($.a,{page:"Repo-Files"})),ee.c&&o.a.createElement(ne.a,{code:!0,uiless_config:window.UILessConfig,selectedNavKey:s,visible:u,noTitle:!0,onClose:function e(){return t.setState({httpsSetting:!1})},dingtalk:!0,sessionTime:!0}))}}]),n}(o.a.Component),Fe=n(11);function Me(e){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Ue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ve(e,t,n){return t&&Ae(e.prototype,t),n&&Ae(e,n),e}function ze(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ke(e,t)}function Ke(e,t){return(Ke=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function He(e){var t=qe();return function n(){var r=Je(e),o;if(t){var a=Je(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return We(this,o)}}function We(e,t){return!t||"object"!==Me(t)&&"function"!=typeof t?Xe(e):t}function Xe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Je(e){return(Je=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ye=function(e){ze(n,e);var t=He(n);function n(){var e;Ue(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ge(Xe(e=t.call.apply(t,[this].concat(o))),"goFlow",(function(){var t=window.FORCE,n=t.pathResource,r=t.resourceSubject,o=e.props.projectInfo,a={type:"codeup",template:{id:n.id,gitHttpURL:o.http_url_to_repo,branch:r.revision}},i="https://".concat(ee.d?"pre-":"","flow.aliyun.com/my/new?sourceTpl=").concat(btoa(JSON.stringify(a)));window.open(i),Object(h.b)({action:"creat_pipeline",page:"Repo-Files",type:"",control:""})})),e}return Ve(n,[{key:"render",value:function e(){return ee.a?null:o.a.createElement(d.Button,{type:"normal",style:{marginRight:16},onClick:this.goFlow},o.a.createElement(Z.a,{type:"plus",size:"small"}),"\u521b\u5efa\u6d41\u6c34\u7ebf")}}]),n}(o.a.Component),Ze=n(5);function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Qe(){return(Qe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function et(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nt(e,t,n){return t&&tt(e.prototype,t),n&&tt(e,n),e}function rt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ot(e,t)}function ot(e,t){return(ot=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function at(e){var t=lt();return function n(){var r=ut(e),o;if(t){var a=ut(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return it(this,o)}}function it(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?ct(e):t}function ct(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ut(e){return(ut=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function st(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ft=window.FORCE.resourceSubject,pt=function(e){rt(n,e);var t=at(n);function n(){return et(this,n),t.apply(this,arguments)}return nt(n,[{key:"componentWillReceiveProps",value:function e(t){this.props.defaultCommitMsg!==t.defaultCommitMsg&&t.field.setValue("commit_message_title",t.defaultCommitMsg)}},{key:"render",value:function e(){var t=this.props,n=t.defaultCommitMsg,r=t.defaultCommitMsgDesc,a=t.field,i=t.label,c=a.init;return o.a.createElement(d.Form,{labelAlign:"top",direction:"ver",field:a,className:"commit-message-form"},o.a.createElement(d.Form.Item,{label:i,required:!0,style:{marginBottom:12}},o.a.createElement(d.Input,Qe({autoFocus:!0,placeholder:n},c("commit_message_title",{initValue:n,rules:[{required:!0,message:Ze.a.required}]})))),o.a.createElement(d.Input,Qe({style:{display:"none"}},c("branch_name",{initValue:ft.revision||"master",rules:[{required:!0,message:Ze.a.required}]}))),o.a.createElement(d.Form.Item,null,o.a.createElement(d.Input.TextArea,Qe({placeholder:"\u8bf7\u8f93\u5165\u5907\u6ce8\u4fe1\u606f\uff0c".concat(ee.a?"\u4ee5\u53ca\u5f00\u53d1\u601d\u8def\u7b49\u5185\u5bb9\uff08\u9009\u586b\uff09":"\u4f7f\u7528 #ID \u53ef\u4ee5\u5feb\u901f\u5173\u8054\u4efb\u52a1\uff0c\u5982 #TOY-60 \u5c06\u94fe\u63a5\u5230 ID \u4e3a TOY-60 \u7684\u4efb\u52a1")},c("commit_message_content",{initValue:r})))))}}]),n}(o.a.Component);st(pt,"propTypes",{defaultCommitMsg:y.a.string,defaultCommitMsgDesc:y.a.string}),st(pt,"defaultProps",{defaultCommitMsg:"overview"});var mt=n(1466),yt=n(1530),dt=n(13);function ht(e){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function bt(){return(bt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function gt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Et(e,t,n){return t&&vt(e.prototype,t),n&&vt(e,n),e}function wt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ot(e,t)}function Ot(e,t){return(Ot=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function jt(e){var t=Pt();return function n(){var r=Rt(e),o;if(t){var a=Rt(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return St(this,o)}}function St(e,t){return!t||"object"!==ht(t)&&"function"!=typeof t?_t(e):t}function _t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Rt(e){return(Rt=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ct=window.FORCE,Nt=Ct.pathResource,kt=Ct.resourceSubject;function It(e){return new Promise((function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return t(r.result)},r.onerror=function(e){return n(e)}}))}var xt=function(e){wt(n,e);var t=jt(n);function n(e){var r;return gt(this,n),Tt(_t(r=t.call(this,e)),"onDialogOpen",(function(){r.setState({isDialogVisible:!0}),r.fetchFiles()})),Tt(_t(r),"fetchFiles",(function(){"true"!==window.FORCE.pathResource.isEmpty&&Object(q.n)().then((function(e){e.shift(),r.setState({existFileList:e})})).catch((function(e){console.log(e)}))})),Tt(_t(r),"saveUploaderRef",(function(e){r.uploaderRef=e.getInstance()})),Tt(_t(r),"onDialogOk",(function(){if(!r.state.submitting){r.setState({submitting:!0});var e=r.props,t=e.resourcePath,n=e.isMaster;r.field.validate((function(e){if(e)r.setState({submitting:!1});else{var o=r.field.getValues(),a=r.field.getValue("file_path"),i=o.commit_message_content?"".concat(o.commit_message_title,"\n").concat(o.commit_message_content):o.commit_message_title,c=a[0].originFileObj,l=r.sizeCaculator(c.size),u=l.charAt(l.length-1),s=parseInt(l.substr(0,l.length-1));if("M"===u){if(s>50)return d.Toast.error({title:"\u4e0a\u4f20\u6587\u4ef6\u5927\u5c0f\u9700\u8981\u5c0f\u4e8e 50 M",duration:2e3}),void r.setState({submitting:!1})}else{if("K"!==u&&"B"!==u)return d.Toast.error({title:"\u4e0a\u4f20\u6587\u4ef6\u5927\u5c0f\u9700\u8981\u5c0f\u4e8e 50 M",duration:2e3}),void r.setState({submitting:!1});console.log("support")}o.file_path=1!==n?"".concat(t,"/").concat(c.name):c.name,It(c).then((function(e){var a=kt.revision||"master";o.content=0===c.size?"":e.replace(/^.*;base64,/,""),r.state.task_ids&&(o.task_ids=r.state.task_ids),r.props.createFile(o,i,(function(){d.Toast.success({title:"\u4e0a\u4f20\u6587\u4ef6\u6210\u529f"}),r.setState({isDialogVisible:!1}),1!==n?Object(Fe.d)("/".concat(Nt.fullPath,"/blob/").concat(J.b.revisionEncodeURI(a),"/").concat(t).concat(t?"/":"").concat(c.name),{state:{forceUpdate:!0}}):Object(Fe.d)("/".concat(Nt.fullPath,"/blob/").concat(J.b.revisionEncodeURI(a),"/").concat(c.name),{state:{forceUpdate:!0}})}),(function(){r.setState({submitting:!1})}))})).catch((function(){d.Toast.error({title:"\u4e0d\u652f\u6301\u4e0a\u4f20\u6587\u4ef6\u5939\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\u6587\u4ef6",duration:2e3}),r.setState({submitting:!1})}))}}))}})),Tt(_t(r),"onDialogCancel",(function(){r.setState({isDialogVisible:!1}),r.props.closeModal()})),Tt(_t(r),"nameValidator",(function(e,t,n){var o=r.state.existFileList,a=r.props,i=a.resourcePath,c=a.isMaster;if(t){var l=t[0].name,u;o.some((function(e){return c?l===e.path:"".concat(i,"/").concat(l)===e.path}))&&n("\u6587\u4ef6\u5df2\u5b58\u5728"),n()}else n()})),r.field=new d.Field(_t(r)),r.state={isDialogVisible:!1,submitting:!1,existFileList:[],task_ids:""},r}return Et(n,[{key:"componentDidMount",value:function e(){this.props.trigger||this.fetchFiles()}},{key:"sizeCaculator",value:function e(t){var n=parseFloat(t,10);if(isNaN(n)||n<1e-7)return"0B";for(var r=["B","K","M","G","T","P"],o=0,a=1024;n>=1024&&o<r.length;)o+=1,n/=1024;var i=r[o];return n=n.toFixed(2),"".concat(n).concat(i)}},{key:"render",value:function e(){var t=this,n=this.field.init,r=this.field.getValue("file_path")||"",a=r&&r.map((function(e){return e.name})),i=this.props,c=i.isMaster,l=i.resourcePath,u="true"===window.FORCE.pathResource.isEmpty?o.a.createElement("div",{className:"upload-file-path-help"},"Tips\uff1a\u60f3\u6279\u91cf\u5173\u8054\u6587\u4ef6\uff1f\u4f7f\u7528\u547d\u4ee4\u884c\u6216\u4e09\u65b9\u5e93\u5bfc\u5165\u529f\u80fd",o.a.createElement("a",{href:Object(dt.a)("\u5173\u8054\u6587\u4ef6\u5939"),target:"_blank"},"\u5173\u8054\u5df2\u6709\u6587\u4ef6\u5939\u6216\u4ed3\u5e93"),"\u5427~"):null;return o.a.createElement(o.a.Fragment,null,this.state.isDialogVisible?o.a.createElement(d.Dialog,{visible:!0,onOk:this.onDialogOk,onCancel:this.onDialogCancel,onClose:this.onDialogCancel,title:"\u4e0a\u4f20\u6587\u4ef6",style:{width:"600px"},okProps:{children:"\u4e0a\u4f20",loading:this.state.submitting},cancelProps:{children:"\u53d6\u6d88"},footerActions:["cancel","ok"],onChange:function e(t){console.log(t)}},!c&&l&&o.a.createElement("div",{className:"upload-path"},o.a.createElement("span",{style:{marginRight:8}},"\u4e0a\u4f20\u76ee\u5f55")," ",l),o.a.createElement(d.Form,{direction:"ver",field:this.field,style:{marginBottom:8}},o.a.createElement(d.Form.Item,{label:"\u9009\u62e9\u6587\u4ef6",required:!0,help:"error"===this.field.getState("file_path")?this.field.getError("file_path"):u},o.a.createElement(d.Upload.Dragger,bt({limit:1,autoUpload:!1,listType:"text"},n("file_path",{rules:[{required:!0,message:Ze.a.required},{validator:this.nameValidator}]})),o.a.createElement("div",{className:"upload-file"},o.a.createElement("span",null,o.a.createElement(Z.a,{type:"plus"})," \u6dfb\u52a0\u6587\u4ef6 \u6216 \u5c06\u6587\u4ef6\u62d6\u653e\u81f3\u6b64\u533a\u57df"))))),o.a.createElement(pt,{field:this.field,label:"\u63d0\u4ea4\u4fe1\u606f",defaultCommitMsg:"\u4e0a\u4f20 ".concat(a)}),ee.a?null:o.a.createElement(mt.a,{useBy:"submit",onChange:function e(n){if(n.map){var r=n.map((function(e){return e._id}));t.setState({task_ids:r.join(",")})}}})):null,!!this.props.trigger&&o.a.cloneElement(this.props.trigger,{onClick:function e(n){t.props.trigger.props.onClick&&t.props.trigger.props.onClick(n),t.onDialogOpen()}}))}}],[{key:"getDerivedStateFromProps",value:function e(t){return t.trigger?{}:{isDialogVisible:t.isDialogVisible}}}]),n}(o.a.Component);function Bt(e){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Lt(){return(Lt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Dt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mt(e,t,n){return t&&Ft(e.prototype,t),n&&Ft(e,n),e}function Ut(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&At(e,t)}function At(e,t){return(At=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Vt(e){var t=Ht();return function n(){var r=Wt(e),o;if(t){var a=Wt(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return zt(this,o)}}function zt(e,t){return!t||"object"!==Bt(t)&&"function"!=typeof t?Kt(e):t}function Kt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ht(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Wt(e){return(Wt=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Xt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Tt(xt,"propTypes",{trigger:y.a.element,closeModal:y.a.func}),Tt(xt,"defaultProps",{trigger:null,closeModal:function e(){}});var qt=function(e){Ut(n,e);var t=Vt(n);function n(){var e;Dt(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return Xt(Kt(e=t.call.apply(t,[this].concat(a))),"state",{isDialogVisible:!1}),Xt(Kt(e),"onDialogOpen",(function(){e.setState({isDialogVisible:!0})})),Xt(Kt(e),"onDialogClose",(function(){e.setState({isDialogVisible:!1})})),Xt(Kt(e),"renderBtns",(function(){var t=window.FORCE,n=t.pathResource,r=t.resourceSubject,a=e.props,i=a.protectedBranch,c=a.goNew,l=n.role,s=u.a.access_level,p=Object(f.b)(i,l),m=l===s[30],y=r.revisionType,b="tag"===y||"sha1"===y,g,v=[];return Object(f.a)(u.g,l)&&p?b?(v.push(o.a.createElement(d.Menu.Item,{disabled:!0},o.a.createElement(d.Balloon.Tooltip,{trigger:o.a.createElement("div",null,"\u65b0\u5efa\u6587\u4ef6")},"\u53ea\u6709\u5206\u652f\u4e0b\u624d\u53ef\u4ee5\u65b0\u5efa\u6587\u4ef6"))),v.push(o.a.createElement(d.Menu.Item,{disabled:!0},o.a.createElement(d.Balloon.Tooltip,{align:"t",trigger:o.a.createElement("div",null,"\u4e0a\u4f20\u6587\u4ef6")},"\u53ea\u6709\u5206\u652f\u4e0b\u624d\u53ef\u4ee5\u4e0a\u4f20\u6587\u4ef6")))):(v.push(o.a.createElement(d.Menu.Item,{onClick:function e(){Object(h.b)({action:"new_file",page:"Repo-Files",control:"viewsrc - newfile"}),c&&c()}},o.a.createElement("div",null,"\u65b0\u5efa\u6587\u4ef6"))),v.push(o.a.createElement(d.Menu.Item,{onClick:function t(){Object(h.b)({action:"upload_file",page:"Repo-Files",control:"viewsrc - uploadfile"}),e.onDialogOpen()}},o.a.createElement("div",null,"\u4e0a\u4f20\u6587\u4ef6")))):(v.push(o.a.createElement(d.Menu.Item,{disabled:!0},o.a.createElement(d.Balloon.Tooltip,{trigger:o.a.createElement("div",null,"\u65b0\u5efa\u6587\u4ef6"),align:"t",text:b?"\u53ea\u6709\u5206\u652f\u4e0b\u624d\u53ef\u4ee5\u65b0\u5efa\u6587\u4ef6":o.a.createElement(o.a.Fragment,null,Object(f.a)(u.g,l)?o.a.createElement(o.a.Fragment,null,m?"\u5f53\u524d\u4e3a\u4fdd\u62a4\u5206\u652f\uff0c\u65e0\u6743\u9650\u76f4\u63a5\u63a8\u9001\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5904\u7406":"\u5f53\u524d\u4e3a\u4fdd\u62a4\u5206\u652f\uff0c\u65e0\u6743\u9650\u76f4\u63a5\u63a8\u9001\uff0c\u53ef\u524d\u5f80\u8bbe\u7f6e\u5904\u7406"):"\u65e0\u6743\u9650\u8fdb\u884c\u65b0\u5efa\u6587\u4ef6\u64cd\u4f5c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u7533\u8bf7\u5bf9\u5e94\u7684\u6743\u9650")}))),v.push(o.a.createElement(d.Menu.Item,{disabled:!0},o.a.createElement(d.Balloon.Tooltip,{trigger:o.a.createElement("div",null,"\u4e0a\u4f20\u6587\u4ef6"),align:"t",text:b?"\u53ea\u6709\u5206\u652f\u4e0b\u624d\u53ef\u4ee5\u4e0a\u4f20\u6587\u4ef6":o.a.createElement(o.a.Fragment,null,Object(f.a)(u.g,l)?o.a.createElement(o.a.Fragment,null,m?"\u5f53\u524d\u4e3a\u4fdd\u62a4\u5206\u652f\uff0c\u65e0\u6743\u9650\u76f4\u63a5\u63a8\u9001\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5904\u7406":"\u5f53\u524d\u4e3a\u4fdd\u62a4\u5206\u652f\uff0c\u65e0\u6743\u9650\u76f4\u63a5\u63a8\u9001\uff0c\u53ef\u524d\u5f80\u8bbe\u7f6e\u5904\u7406"):"\u65e0\u6743\u9650\u8fdb\u884c\u4e0a\u4f20\u6587\u4ef6\u64cd\u4f5c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u7533\u8bf7\u5bf9\u5e94\u7684\u6743\u9650")})))),o.a.createElement(d.Dropdown,{trigger:o.a.createElement(d.Button,{type:"normal",id:"new-edit-btn",style:{minWidth:"auto",marginLeft:16}},o.a.createElement(Z.a,{type:"more"})),safeNode:function e(){return document.querySelector("#new-edit-btn")},triggerType:"click",align:"tr br"},o.a.createElement(d.Menu,null,v))})),e}return Mt(n,[{key:"render",value:function e(){var t,n;return"false"!==window.FORCE.pathResource.isArchive?null:o.a.createElement(o.a.Fragment,null,this.renderBtns(),this.state.isDialogVisible?o.a.createElement(xt,Lt({},this.props,{closeModal:this.onDialogClose,isDialogVisible:this.state.isDialogVisible})):null)}}]),n}(o.a.Component);function Jt(e){return(Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Gt(){return(Gt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Yt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $t(e,t,n){return t&&Zt(e.prototype,t),n&&Zt(e,n),e}function Qt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&en(e,t)}function en(e,t){return(en=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function tn(e){var t=on();return function n(){var r=an(e),o;if(t){var a=an(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return nn(this,o)}}function nn(e,t){return!t||"object"!==Jt(t)&&"function"!=typeof t?rn(e):t}function rn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function on(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function an(e){return(an=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function cn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ln=d.Balloon.Tooltip,un=d.Tag.Colorable,sn=window.FORCE.resourceSubject,fn=u.a.visibility_levels,pn=function(e){Qt(n,e);var t=tn(n);function n(){var e;Yt(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return cn(rn(e=t.call.apply(t,[this].concat(o))),"filterLevel",(function(e){var t="";return fn.forEach((function(n){n.value===Number(e)&&(t=n.label)})),t})),cn(rn(e),"goWebIde",(function(e,t){var n=sn.revisionType;e.preventDefault(),Object(q.P)({filepath:t,branch:"branch"===n?sn.revision:"",commit:"sha1"===n?sn.revision:"",line:"",column:"",type:"view",merge_commit:"",mergerequestId:""}).then((function(e){window.open(e.endpoint)})).catch((function(e){console.error(e)}))})),cn(rn(e),"goNew",(function(){var t=window.FORCE.pathResource,n=sn.revision||"master";Object(Fe.d)("/".concat(t.fullPath,"/new/").concat(J.b.revisionEncodeURI(n),"/").concat(sn.path)),e.props.updateSetSelectedType({resourceSubject:{subject:"new",path:sn.path}})})),e}return $t(n,[{key:"render",value:function e(){var t=this,n=window.FORCE.pathResource,r=this.props,a=r.projectInfo,i=r.isInitedLeftTree,c=r.treeData,l=r.isEmptyProject,s=r.ipSetting,f=n.isArchive,p="";if(ee.a)p=n.fullName;else{var m=n.fullName.split("/"),y=m.length;p=m[y-1]?m[y-1].trim():""}return o.a.createElement("div",{className:"overview-info ".concat(l?"empty":"")},o.a.createElement("div",{style:{display:"flex",alignItems:"center"}},o.a.createElement("div",{className:"overview-info-title"},p),o.a.createElement("div",{className:"overview-info-infobar"},a.demo_project?o.a.createElement(un,{className:"demo-repo-tag"},"\u793a\u4f8b\u4ee3\u7801\u5e93"):null,o.a.createElement(un,{color:"gray",size:"small",className:"overview-info-lever"},this.filterLevel(a.visibility_level)),"ORG_MEMBER"===n.role||"InDepartmentOpen"===n.role?null:o.a.createElement(un,{color:"gray",size:"small"},u.a.role[n.role]),a.description?o.a.createElement(ln,{trigger:o.a.createElement(d.Button.Icon,{name:"info-o",type:"primary",color:"gray",style:{marginLeft:4}}),text:o.a.createElement("div",null,o.a.createElement("div",{className:"desc-popup-item-label"},"\u63cf\u8ff0"),a.description)}):null)),l?o.a.createElement(De,this.props):o.a.createElement("div",{className:"overview-info-toolbar"},o.a.createElement("div",null,"false"===f?o.a.createElement(o.a.Fragment,null,i&&c.length?o.a.createElement(X,{tooltipText:"\u53ea\u6709\u5206\u652f\u4e0b\u624d\u53ef\u4ee5\u8fdb\u884c Web IDE \u64cd\u4f5c",type:"normal",onClick:function e(n){Object(h.b)({action:"goto_webide",page:"Repo-Files"}),t.goWebIde(n,"")},style:{marginRight:16},ipSetting:s},"Web IDE"):null,o.a.createElement(Ye,this.props)):null,o.a.createElement(Ee,this.props),o.a.createElement(qt,Gt({},this.props,{goNew:this.goNew})))))}}]),n}(o.a.Component);function mn(e){return(mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function yn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hn(e,t,n){return t&&dn(e.prototype,t),n&&dn(e,n),e}function bn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gn(e,t)}function gn(e,t){return(gn=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function vn(e){var t=On();return function n(){var r=jn(e),o;if(t){var a=jn(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return En(this,o)}}function En(e,t){return!t||"object"!==mn(t)&&"function"!=typeof t?wn(e):t}function wn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function On(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function jn(e){return(jn=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Sn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _n=d.Balloon.Tooltip,Pn=function(e){bn(n,e);var t=vn(n);function n(){var e;yn(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Sn(wn(e=t.call.apply(t,[this].concat(o))),"getProjectInfoFromPageInfo",(function(){var t=e.props.pageInfo||{},n=t.pathResource,r=t.resourceSubject,o="true"===n.isExist,a;return{isEmpty:"true"===n.isEmpty,isExist:o,role:n.role,pathResource:n,resourceSubject:r,repoSize:Number(n.repoSize),repoLimitSize:Number(n.repoLimitSize)}})),Sn(wn(e),"goNew",(function(){var t=e.getProjectInfoFromPageInfo(),n=t.resourceSubject,r=t.pathResource,o=n.revision||"master",a=e.props.treePath;a?Object(Fe.d)("/".concat(r.fullPath,"/new/").concat(J.b.revisionEncodeURI(o),"/").concat(a)):Object(Fe.d)("/".concat(r.fullPath,"/new/").concat(J.b.revisionEncodeURI(o),"?isMaster=1")),e.props.updateSetSelectedType({resourceSubject:{subject:"new",path:a||""}})})),e}return hn(n,[{key:"render",value:function e(){var t=this,n,r=this.getProjectInfoFromPageInfo().pathResource,a=this.props,i=a.protectedBranch,c=a.size,l=a.treePath,s=a.followTrigger,p=r.role,m=r.isArchive,y=u.a.access_level,b=Object(f.b)(i,p),g=p===y[30],v=window.FORCE.resourceSubject.revisionType;return"false"!==m?null:o.a.createElement("span",{onClick:function e(t){t.stopPropagation()},className:l?"":"file-icon-margin-left"},Object(f.a)(u.g,p)&&b?o.a.createElement(d.Dropdown,{trigger:o.a.createElement(k,{tooltipText:"\u53ea\u6709\u5206\u652f\u4e0b\u624d\u53ef\u4ee5\u64cd\u4f5c",isIcon:!0,type:"primary",name:"plus",color:"gray",size:c}),triggerType:"click",align:"tr br",hasSelectedIcon:!1,followTrigger:s},o.a.createElement(d.Menu,null,o.a.createElement(d.Menu.Item,{key:"new",onClick:function e(){Object(h.b)({action:"new_file",page:"Repo-Files",control:"viewtree - newfile"}),t.goNew()}},"\u65b0\u5efa\u6587\u4ef6"),o.a.createElement(d.Menu.Item,{key:"upload",onClick:function e(){Object(h.b)({action:"upload_file",page:"Repo-Files",control:"viewtree - uploadfile"}),t.props.onUploadDialogOpen&&t.props.onUploadDialogOpen(l)}},"\u4e0a\u4f20\u6587\u4ef6"))):o.a.createElement(o.a.Fragment,null,"tag"===v?o.a.createElement(_n,{trigger:o.a.createElement(d.Button.Icon,{type:"primary",name:"plus",color:"gray",disabled:!0,size:c}),align:"t",text:"\u53ea\u6709\u5206\u652f\u4e0b\u624d\u53ef\u4ee5\u64cd\u4f5c"}):o.a.createElement(_n,{trigger:o.a.createElement(d.Button.Icon,{type:"primary",name:"plus",color:"gray",disabled:!0,size:c}),align:"t",text:Object(f.a)(u.g,p)?o.a.createElement(o.a.Fragment,null,g?"\u5f53\u524d\u4e3a\u4fdd\u62a4\u5206\u652f\uff0c\u65e0\u6743\u9650\u76f4\u63a5\u63a8\u9001\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5904\u7406":"\u5f53\u524d\u4e3a\u4fdd\u62a4\u5206\u652f\uff0c\u65e0\u6743\u9650\u76f4\u63a5\u63a8\u9001\uff0c\u53ef\u524d\u5f80\u8bbe\u7f6e\u5904\u7406"):"\u65e0\u6743\u9650\u8fdb\u884c\u65b0\u5efa\u6587\u4ef6\u548c\u4e0a\u4f20\u6587\u4ef6\u7684\u64cd\u4f5c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u7533\u8bf7\u5bf9\u5e94\u7684\u6743\u9650"})))}}]),n}(o.a.Component);Sn(Pn,"propTypes",{size:y.a.string,treePath:y.a.string}),Sn(Pn,"defaultProps",{size:"medium",treePath:""});var Rn=n(1462),Tn=n(1420),Cn=n.n(Tn),Nn=n(1531);function kn(e){return(kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function In(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bn(e,t,n){return t&&xn(e.prototype,t),n&&xn(e,n),e}function Ln(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dn(e,t)}function Dn(e,t){return(Dn=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Fn(e){var t=An();return function n(){var r=Vn(e),o;if(t){var a=Vn(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Mn(this,o)}}function Mn(e,t){return!t||"object"!==kn(t)&&"function"!=typeof t?Un(e):t}function Un(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function An(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Vn(e){return(Vn=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var zn=function(e){Ln(n,e);var t=Fn(n);function n(){return In(this,n),t.apply(this,arguments)}return Bn(n,[{key:"render",value:function e(){return o.a.createElement("div",{className:"tree-skeleton"},o.a.createElement("div",{className:"tree-skeleton-ul skeleton-wapper"},o.a.createElement(Z.a,{type:"triangle-down",className:"tree-skeleton-icon"}),o.a.createElement(Cn.a,{width:100,height:20})),o.a.createElement("div",{className:"tree-skeleton-item skeleton-wapper"},o.a.createElement(Cn.a,{width:100,height:20})),o.a.createElement("div",{className:"tree-skeleton-item skeleton-wapper"},o.a.createElement(Cn.a,{width:80,height:20})),o.a.createElement("div",{className:"tree-skeleton-item skeleton-wapper"},o.a.createElement(Cn.a,{width:100,height:20})),o.a.createElement("div",{className:"tree-skeleton-item skeleton-wapper"},o.a.createElement(Cn.a,{width:80,height:20})),o.a.createElement("div",{className:"tree-skeleton-item skeleton-wapper"},o.a.createElement(Cn.a,{width:100,height:20})),o.a.createElement("div",{className:"tree-skeleton-item skeleton-wapper"},o.a.createElement(Cn.a,{width:80,height:20})),o.a.createElement("div",{className:"tree-skeleton-item skeleton-wapper"},o.a.createElement(Cn.a,{width:100,height:20})),o.a.createElement("div",{className:"tree-skeleton-item skeleton-wapper"},o.a.createElement(Cn.a,{width:80,height:20})))}}]),n}(o.a.PureComponent);function Kn(e){return(Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Hn(){return(Hn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Wn(e){return Gn(e)||Jn(e)||qn(e)||Xn()}function Xn(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function qn(e,t){if(e){if("string"==typeof e)return Yn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yn(e,t):void 0}}function Jn(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Gn(e){if(Array.isArray(e))return Yn(e)}function Yn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qn(e,t,n){return t&&$n(e.prototype,t),n&&$n(e,n),e}function er(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tr(e,t)}function tr(e,t){return(tr=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function nr(e){var t=ar();return function n(){var r=ir(e),o;if(t){var a=ir(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return rr(this,o)}}function rr(e,t){return!t||"object"!==Kn(t)&&"function"!=typeof t?or(e):t}function or(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ar(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ir(e){return(ir=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function cr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var lr=window.FORCE,ur=lr.pathResource,sr=lr.resourceSubject,fr=d.Tree.Node,pr=function(e){er(n,e);var t=nr(n);function n(){var e;Zn(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return cr(or(e=t.call.apply(t,[this].concat(o))),"confirmResult",!0),cr(or(e),"isTreeItemSelected",!1),cr(or(e),"onTreeLoadData",(function(t){if(e.isTreeItemSelected){if(e.isTreeItemSelected=!1,!e.confirmResult)return null}else if("edit"===e.props.selectedType||"new"===e.props.selectedType){var n;if(!window.confirm("\u60a8\u6b63\u5728".concat("edit"===e.props.selectedType?"\u7f16\u8f91":"\u65b0\u5efa","\u6587\u4ef6\uff0c\u662f\u5426\u786e\u8ba4\u79bb\u5f00\uff1f")))return!1;window.onbeforeunload=null}if("commit"===t.props.resourceType)return null;var r=t.props.eventKey;if("root"===r)return Object(Fe.d)("/".concat(ur.fullPath,"/tree/").concat(J.b.revisionEncodeURI(sr.revision),"/")),e.props.updateSetSelectedType({resourceSubject:{subject:"tree",path:""}}),e.rewriteDocTitle("",sr.revision),new Promise((function(t){e.props.getExpandedTreeData("",t)}));if("tree"===t.props.resourceType){var o="/".concat(ur.fullPath,"/tree/").concat(J.b.revisionEncodeURI(sr.revision),"/").concat(J.b.filepathEncodeURI(r));if(window.location.pathname===o)return Promise.resolve();Object(Fe.d)(o),e.props.updateSetSelectedType({resourceSubject:{subject:"tree",path:r}})}return e.rewriteDocTitle(r,sr.revision),new Promise((function(n){"tree"===t.props.resourceType?e.props.getExpandedTreeData(r,n):n()}))})),cr(or(e),"onTreeItemSelect",(function(t,n){var r=e.props.submodules,o=n.node.props,a=o.isLeaf,i=o.eventKey;if(!t.length)return!1;if(e.isTreeItemSelected=!0,"edit"===e.props.selectedType||"new"===e.props.selectedType){if(e.confirmResult=window.confirm("\u60a8\u6b63\u5728".concat("edit"===e.props.selectedType?"\u7f16\u8f91":"\u65b0\u5efa","\u6587\u4ef6\uff0c\u662f\u5426\u786e\u8ba4\u79bb\u5f00\uff1f")),!e.confirmResult)return!1;window.onbeforeunload=null}if(a){var c=t[0];if("commit"===n.node.props.resourceType){var l=r&&r.find((function(e){return e.path===c}));l&&(window.location=l.http_homepage_url)}else{var u="/".concat(ur.fullPath,"/blob/").concat(J.b.revisionEncodeURI(sr.revision),"/");e.jumpTo(u+c,i,c)}}})),cr(or(e),"rewriteDocTitle",(function(e,t){var n=ur.fullPath&&ur.fullPath.split("/")?ur.fullPath.split("/")[1]:"";document.title=e?[e,t,n,"\u4e91\u6548 Codeup"].join(" \xb7 "):[t,n,"\u4e91\u6548 Codeup"].join(" \xb7 ")})),cr(or(e),"jumpTo",(function(t,n,r){var o=J.b.filepathEncodeURI(t);o!==window.location.pathname&&(Object(Fe.d)(o),e.props.updateSetSelectedType({resourceSubject:{subject:"blob",path:r||""}}),e.rewriteDocTitle(n,sr.revision))})),cr(or(e),"updateExpandKeys",(function(t){e.props.updateData({defaultExpandedKeys:t})})),cr(or(e),"goNew",(function(){var t=window.FORCE.pathResource.defaultBranch||"master";Object(Fe.d)("/".concat(ur.fullPath,"/new/").concat(t,"/").concat(J.b.revisionEncodeURI(sr.revision),"?file_name=README.md")),e.props.updateSetSelectedType({resourceSubject:{subject:"blob",path:""}})})),cr(or(e),"setLabbelWidth",(function(t,n){var r=t.currentTarget;if("tree"===n.type){var o,a=r.getBoundingClientRect().left,i=e.props.projectNav,c=300,l;if(i&&i.style)c=parseInt(i.style.width)||300;r.style.maxWidth="".concat(c-a-12-29,"px"),r.style.position="absolute",r.querySelector(".name").style.maxWidth="".concat(c-a-20-29-12,"px")}})),cr(or(e),"resetLabbelWidth",(function(t,n){if("tree"===n.type){t.currentTarget.style.maxWidth="none",t.currentTarget.style.position="relative",t.currentTarget.querySelector(".name").style.maxWidth="none";var r=e.props.onUploadDialogClose;r&&r()}})),e}return Qn(n,[{key:"render",value:function e(){var t=this,n=function e(n){return[].concat(Wn(n.filter((function(e){return"tree"===e.type}))),Wn(n.filter((function(e){return"tree"!==e.type})))).map((function(n){var r=n.label?n.label:n,a=r.id,i=r.name,c=r.type;return o.a.createElement(fr,{label:o.a.createElement("span",{onMouseEnter:function e(r){t.setLabbelWidth(r,n)},onMouseLeave:function e(r){t.resetLabbelWidth(r,n)},className:"label-content"},"commit"!==c?o.a.createElement(o.a.Fragment,null,"tree"===c?o.a.createElement(Z.a,{type:"folder",biz:"code",className:"file-icon"}):o.a.createElement(Rn.a,{className:"file-icon",fileName:i})):o.a.createElement("i",{className:"fa fa-archive"})," ",o.a.createElement("span",{className:"name one-line-ellipsis"},i),"tree"===c&&o.a.createElement("span",{className:"add-upload-file-btn"},o.a.createElement(Pn,Hn({followTrigger:!0,size:"small",treePath:a},t.props)))),key:a,isLeaf:"tree"!==c,resourceType:c},n.children&&e(n.children))}))},r=this.props,a=r.treeData,i=r.defaultExpandedKeys,c=r.selectedKeys,l;return r.isInittingLeftTree?o.a.createElement(zn,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(d.Tree,{expandedKeys:i,selectedKeys:c,loadData:this.onTreeLoadData,onSelect:this.onTreeItemSelect,onExpand:this.updateExpandKeys,className:"file-tree",mode:"directory",autoExpandParent:!1,isLabelBlock:!0,style:{display:"inline-block",minWidth:"100%"},animation:!1},o.a.createElement(fr,{label:ur.fullPath.split("/")[ur.fullPath.split("/").length-1],key:"root"},n(a))))}}]),n}(o.a.Component),mr=n(23),yr=n(1524);function dr(e){return(dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function hr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function br(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hr(Object(n),!0).forEach((function(t){Tr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Er(e,t,n){return t&&vr(e.prototype,t),n&&vr(e,n),e}function wr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Or(e,t)}function Or(e,t){return(Or=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function jr(e){var t=Pr();return function n(){var r=Rr(e),o;if(t){var a=Rr(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Sr(this,o)}}function Sr(e,t){return!t||"object"!==dr(t)&&"function"!=typeof t?_r(e):t}function _r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Rr(e){return(Rr=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Tr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Cr=d.Tree.Node,Nr=window.FORCE,kr=Nr.pathResource,Ir=Nr.resourceSubject,xr=function(e){wr(n,e);var t=jr(n);function n(){var e;gr(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Tr(_r(e=t.call.apply(t,[this].concat(o))),"state",{isLoading:!1}),Tr(_r(e),"onTreeItemSelect",(function(t,n){var r=e.props.submodules,o=n.node.props,a=o.isLeaf,i=o.eventKey;if(!t.length)return!1;if(a){var c=t[0];if("commit"===n.node.props.resourceType){var l=r&&r.find((function(e){return e.path===c}));l&&(window.location=l.http_homepage_url)}else{var u="/".concat(kr.fullPath,"/blob/").concat(J.b.revisionEncodeURI(Ir.revision),"/");e.jumpTo(u+c,i,c)}}else console.log("\u5c55\u5f00")})),Tr(_r(e),"rewriteDocTitle",(function(e,t){var n=kr.fullPath&&kr.fullPath.split("/")?kr.fullPath.split("/")[1]:"";document.title=[e,t,n,"\u4e91\u6548 Codeup"].join(" \xb7 ")})),Tr(_r(e),"jumpTo",(function(t,n,r){var o=J.b.filepathEncodeURI(t);o!==window.location.pathname&&(Object(Fe.d)(o),e.rewriteDocTitle(n,Ir.revision),e.props.updateSetSelectedType({resourceSubject:{subject:"blob",path:r||""}}))})),Tr(_r(e),"updateExpandKeys",(function(t){e.props.updateData({defaultExpandedKeys:t})})),Tr(_r(e),"getTreeData",(function(){var t=e.props,n=t.filterTreeData,r=t.filterText;if(!r)return J.b.transferPath2Tree(n);var o=n.filter((function(e){return e.path&&e.path.toLowerCase().indexOf(r.toLowerCase())>-1})),a=J.b.transferPath2Tree(o),i=function e(t){if(t.children){if(1===t.children.length){if("tree"===t.children[0].type){var n=br(br({},t.children[0]),{},{name:t.children[0].id,tilte:t.children[0].id});return e(n)}return t}var r=t.children.map((function(t){return e(t)}));return br(br({},t),{},{children:r})}return t},c;return a.map((function(e){return i(e)}))})),Tr(_r(e),"getDefaultExpandKeys",(function(e){var t=["root"],n;return function e(n){return n.forEach((function(n){"tree"===n.type&&(t.push(n.id),n.children&&e(n.children))}))}(e),t})),e}return Er(n,[{key:"componentDidMount",value:function e(){var t=this;this.setState({isLoading:!0}),Object(q.n)().then((function(e){t.setState({isLoading:!1});var n,r=e.slice(1).map((function(e){return e.path="/".concat(e.path),e}));t.props.updateData({filterTreeData:r})})).catch((function(e){t.setState({isLoading:!1}),console.error(e)}))}},{key:"render",value:function e(){var t=this.props,n=t.selectedKeys,r=t.filterText,a=function e(t){return t.map((function(t){return o.a.createElement(Cr,{label:o.a.createElement("span",null,"commit"!==t.type?o.a.createElement(o.a.Fragment,null,"tree"===t.type?o.a.createElement(Z.a,{type:"folder",biz:"code",className:"file-icon"}):o.a.createElement(Rn.a,{className:"file-icon",fileName:t.name})):o.a.createElement("i",{className:"fa fa-archive"})," ",o.a.createElement("span",{className:"display-inline-block"},o.a.createElement(yr.a,{name:t.name,filterText:r}))),key:t.id,isLeaf:"tree"!==t.type,resourceType:t.type},t.children&&e(t.children))}))};if(!r)return!1;if(this.state.isLoading)return o.a.createElement("div",{className:"filter-loading-data"},o.a.createElement(d.Loading,null));var i=this.getTreeData();return i.length?o.a.createElement(o.a.Fragment,null,o.a.createElement(d.Tree,{defaultExpandedKeys:this.getDefaultExpandKeys(i),selectedKeys:n,onSelect:this.onTreeItemSelect,onExpand:this.updateExpandKeys,className:"file-tree",isLabelBlock:!0,mode:"directory",style:{display:"inline-block",minWidth:"100%"},animation:!1},o.a.createElement(Cr,{label:kr.fullPath.split("/")[kr.fullPath.split("/").length-1],key:"root"},a(i)))):o.a.createElement("div",{className:"filter-no-data"},o.a.createElement(mr.a,{size:"small",type:"card",content:"",description:"\u6682\u65e0\u6570\u636e",imgType:"org-list-empty",className:"no-content no-btns"}))}}]),n}(o.a.Component),Br=n(1461),Lr=n(1513),Dr=n(78),Fr=n.n(Dr),Mr=n(1424),Ur=n.n(Mr),Ar=n(45),Vr=n.n(Ar);function zr(e){return(zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Kr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wr(e,t,n){return t&&Hr(e.prototype,t),n&&Hr(e,n),e}function Xr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qr(e,t)}function qr(e,t){return(qr=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Jr(e){var t=Zr();return function n(){var r=$r(e),o;if(t){var a=$r(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Gr(this,o)}}function Gr(e,t){return!t||"object"!==zr(t)&&"function"!=typeof t?Yr(e):t}function Yr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function $r(e){return($r=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Qr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eo=d.Balloon.Tooltip,to=window.FORCE,no=to.pathResource,ro=to.resourceSubject,oo=function(e){Xr(n,e);var t=Jr(n);function n(){var e;Kr(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return Qr(Yr(e=t.call.apply(t,[this].concat(a))),"menu",(function(){var t=e.props,n=t.resourcePath,r=t.lastCommit,a=t.renderType,i=t.project_clone_download,c=!1;return i&&(c=i.downloadLimit&&"disable"===i.downloadLimit.state),o.a.createElement(d.Menu,null,"TEXT"===a&&o.a.createElement(d.Menu.Item,null,o.a.createElement(Fe.a,{to:"/".concat(no.fullPath,"/blame/").concat(J.b.revisionEncodeURI(ro.revision),"/").concat(n)},"Blame")),o.a.createElement(d.Menu.Item,null,o.a.createElement(Fe.a,{to:"/".concat(no.fullPath,"/commits/").concat(J.b.revisionEncodeURI(ro.revision),"/").concat(n)},"\u5386\u53f2")),"TEXT"===a&&!c&&o.a.createElement(d.Menu.Item,null,o.a.createElement("a",{href:"/".concat(no.fullPath,"/raw/").concat(J.b.revisionEncodeURI(ro.revision),"/").concat(n),target:"_blank"},"\u539f\u59cb\u6587\u4ef6")),o.a.createElement(d.Menu.Item,null,o.a.createElement("a",{href:"/".concat(no.fullPath,"/blob/").concat(r.id,"/").concat(n),target:"_blank"},"\u56fa\u5b9a\u5730\u5740")))})),e}return Wr(n,[{key:"render",value:function e(){return o.a.createElement(d.Dropdown,{trigger:o.a.createElement("div",{style:{height:24}},o.a.createElement(eo,{trigger:o.a.createElement(d.Button.Icon,{type:"primary",name:"more",color:"gray",className:"file-icon-margin-left",style:{marginLeft:10}}),text:"\u66f4\u591a\u64cd\u4f5c"})),triggerType:"click"},this.menu())}}]),n}(o.a.Component);function ao(e){return(ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function io(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function co(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lo(e,t,n){return t&&co(e.prototype,t),n&&co(e,n),e}function uo(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&so(e,t)}function so(e,t){return(so=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function fo(e){var t=yo();return function n(){var r=ho(e),o;if(t){var a=ho(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return po(this,o)}}function po(e,t){return!t||"object"!==ao(t)&&"function"!=typeof t?mo(e):t}function mo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yo(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ho(e){return(ho=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function bo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var go=window.FORCE,vo=go.pathResource,Eo=go.resourceSubject,wo=d.Balloon.Tooltip,Oo=function(e){uo(n,e);var t=fo(n);function n(e){var r;return io(this,n),bo(mo(r=t.call(this,e)),"onDialogOpen",(function(){r.setState({isDialogVisible:!0})})),bo(mo(r),"onDialogOk",(function(){r.state.submitting||(r.setState({submitting:!0}),r.field.validate((function(e){if(e)r.setState({submitting:!1});else{var t=r.field.getValues();r.state.task_ids&&(t.task_ids=r.state.task_ids);var n=t.commit_message_content?"".concat(t.commit_message_title,"\n").concat(t.commit_message_content):t.commit_message_title;r.props.deleteFile(t,n,(function(e){e?(d.Toast.success({title:"\u6587\u4ef6\u5df2\u5220\u9664"}),r.props.updateData({hasPush:!0}),Object(Fe.d)("/".concat(vo.fullPath,"/tree/").concat(J.b.revisionEncodeURI(Eo.revision),"/"),{state:{forceUpdate:!0}})):r.setState({submitting:!1})}))}})))})),bo(mo(r),"onDialogCancel",(function(){r.setState({isDialogVisible:!1})})),r.field=new d.Field(mo(r)),r.state={isDialogVisible:!1,submitting:!1,task_ids:""},r}return lo(n,[{key:"render",value:function e(){var t=this,n=this.props.resourcePath,r=Eo.revisionType,a=n.split("/"),i=a[a.length-1],c="".concat(Ze.a.file_delete," ").concat(i);return o.a.createElement(o.a.Fragment,null,"branch"!==r?o.a.createElement(k,{tooltipText:"\u53ea\u6709\u5206\u652f\u4e0b\u7684\u6587\u4ef6\u53ef\u4ee5\u88ab\u5220\u9664",isIcon:!0,type:"primary",name:"trashbin",color:"gray",className:"file-icon-margin-left"}):o.a.createElement(wo,{trigger:o.a.createElement(d.Button.Icon,{type:"primary",name:"trashbin",color:"gray",className:"file-icon-margin-left",onClick:this.onDialogOpen}),text:"\u5220\u9664"}),o.a.createElement(d.Dialog,{visible:this.state.isDialogVisible,onOk:this.onDialogOk,onCancel:this.onDialogCancel,onClose:this.onDialogCancel,title:o.a.createElement(wo,{trigger:o.a.createElement("div",{className:"file-form-title"},"\u63d0\u4ea4\u5230 ",Eo.revision),align:"t"},o.a.createElement("span",{style:{wordBreak:"break-all"}},"\u63d0\u4ea4\u5230 ",Eo.revision)),style:{width:"600px"},okProps:{children:"\u63d0\u4ea4",loading:this.state.submitting},cancelProps:{children:"\u53d6\u6d88"}},o.a.createElement(d.Message,{type:"warning",style:{marginBottom:"12px"},title:"\u63d0\u4ea4\u5b8c\u4fe1\u606f\u5c06\u4ece\u5e93\u5185\u5220\u9664\u6587\u4ef6 ".concat(i)}),o.a.createElement(pt,{field:this.field,defaultCommitMsg:c}),ee.a?null:o.a.createElement(mt.a,{useBy:"submit",onChange:function e(n){if(n.map){var r=n.map((function(e){return e._id}));t.setState({task_ids:r.join(",")})}}})))}}]),n}(o.a.Component),jo=n(1465),So=n(1458),_o=n(44),Po=n(94),Ro=n(1619),To=n(1620);function Co(e){return(Co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function No(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function ko(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){No(a,r,o,i,c,"next",e)}function c(e){No(a,r,o,i,c,"throw",e)}i(void 0)}))}}function Io(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bo(e,t,n){return t&&xo(e.prototype,t),n&&xo(e,n),e}function Lo(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Do(e,t)}function Do(e,t){return(Do=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Fo(e){var t=Ao();return function n(){var r=Vo(e),o;if(t){var a=Vo(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Mo(this,o)}}function Mo(e,t){return!t||"object"!==Co(t)&&"function"!=typeof t?Uo(e):t}function Uo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ao(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Vo(e){return(Vo=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function zo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ko=function(e){Lo(r,e);var t=Fo(r);function r(){var e;Io(this,r);for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return zo(Uo(e=t.call.apply(t,[this].concat(a))),"state",{ipynbRender:null}),zo(Uo(e),"renderIpynb",ko(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function t(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,n.e(16).then(n.t.bind(null,1695,7));case 2:r=o.sent,e.setState({ipynbRender:r.render});case 4:case"end":return o.stop()}}),t)})))),e}return Bo(r,[{key:"componentDidMount",value:function e(){this.renderIpynb()}},{key:"render",value:function e(){var t=this.state.ipynbRender,n=this.props.blob;return t?o.a.createElement("div",{className:"ipynb-body",style:{padding:"0 40px"},dangerouslySetInnerHTML:{__html:t(JSON.parse(n)).outerHTML}}):null}}]),r}(o.a.Component),Ho=n(1497),Wo=n(1499);function Xo(e){return(Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function qo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Go(e,t,n){return t&&Jo(e.prototype,t),n&&Jo(e,n),e}function Yo(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zo(e,t)}function Zo(e,t){return(Zo=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function $o(e){var t=ta();return function n(){var r=na(e),o;if(t){var a=na(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Qo(this,o)}}function Qo(e,t){return!t||"object"!==Xo(t)&&"function"!=typeof t?ea(e):t}function ea(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ta(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function na(e){return(na=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var ra=function(e){Yo(n,e);var t=$o(n);function n(){return qo(this,n),t.apply(this,arguments)}return Go(n,[{key:"render",value:function e(){return o.a.createElement(Br.a,null,o.a.createElement(Br.a.Header,{className:"file-box-header"},o.a.createElement("div",{className:"skeleton-wapper panel-empty-header-skeleton"},o.a.createElement(Cn.a,{width:100,height:20}))),o.a.createElement(Br.a.Body,null,o.a.createElement(Cn.a,null),o.a.createElement(Cn.a,{width:300}),o.a.createElement("div",{className:"panel-empty-line-skeleton"}),o.a.createElement(Cn.a,null),o.a.createElement(Cn.a,{width:300}),o.a.createElement("div",{className:"panel-empty-line-skeleton"}),o.a.createElement(Cn.a,null),o.a.createElement(Cn.a,{width:300})))}}]),n}(o.a.PureComponent);function oa(e){return(oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function aa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ia(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?aa(Object(n),!0).forEach((function(t){ba(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ca(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function la(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ua(e,t,n){return t&&la(e.prototype,t),n&&la(e,n),e}function sa(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fa(e,t)}function fa(e,t){return(fa=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function pa(e){var t=da();return function n(){var r=ha(e),o;if(t){var a=ha(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return ma(this,o)}}function ma(e,t){return!t||"object"!==oa(t)&&"function"!=typeof t?ya(e):t}function ya(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function da(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ha(e){return(ha=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function ba(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ga=d.Balloon.Tooltip,va=window.FORCE,Ea=va.pathResource,wa=va.resourceSubject,Oa=new Fr.a({html:!0,highlight:function e(t,n){if(n&&Vr.a.getLanguage(n))try{return'<pre><code class="hljs">'.concat(Vr.a.highlightAuto(t).value,"</code></pre>")}catch(e){return""}return""},replaceLink:function e(t,n,r){var o="/".concat(Ea.fullPath,"/blob/").concat(J.b.revisionEncodeURI(wa.revision),"/"),a="/".concat(Ea.fullPath,"/raw/").concat(J.b.revisionEncodeURI(wa.revision),"/");return 0!==t.indexOf("http")&&0!==t.indexOf("#")?"image"===r.type?"".concat(a).concat(t):"".concat(o).concat(t):(r.attrPush(["target","_blank"]),t)}}).use(Ur.a);"scrollRestoration"in history?history.scrollRestoration="manual":window.onunload=function(){return window.scrollTo(0,0)};var ja=function(e){sa(n,e);var t=pa(n);function n(){var e;ca(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return ba(ya(e=t.call.apply(t,[this].concat(o))),"state",{hasJumpedLineCode:!1}),ba(ya(e),"goWebIde",(function(e,t){var n=wa.revisionType;e.preventDefault(),Object(q.P)({filepath:t,branch:"branch"===n?wa.revision:"",commit:"sha1"===n?wa.revision:"",line:"",column:"",type:"view",merge_commit:"",mergerequestId:""}).then((function(e){window.open(e.endpoint)})).catch((function(e){console.error(e)}))})),ba(ya(e),"goEdit",(function(){var t=e.props.resourcePath;Object(Fe.d)("/".concat(Ea.fullPath,"/edit/").concat(J.b.revisionEncodeURI(wa.revision),"/").concat(t)),e.props.updateSetSelectedType({resourceSubject:{subject:"edit",path:t||""}})})),ba(ya(e),"onJump",(function(t,n,r,o){var a=e.props.resourcePath;t.stopPropagation(),e.onClose((function(){n.file_path===a?e.setState({hasJumpedLineCode:!1},(function(){window.location.hash="L".concat(n.start_line+1),e.props.updateJumpLineCode(n.start_line+1)})):window.open("".concat(window.location.origin,"/").concat(Ea.fullPath,"/blob/").concat(J.b.revisionEncodeURI(wa.revision),"/").concat(n.file_path,"#L").concat(n.start_line+1))})),Object(h.b)(ia(ia({},o),{},{semantic:r,target_file_path:n.file_path,target_start_line:n.start_line}))})),ba(ya(e),"onClose",(function(t){e.props.updateData({isGramOverlayOpen:!1,activeId:""}),t&&t()})),ba(ya(e),"onLineNumberClick",(function(t,n){var r=window.location.hash.match(/^#L([0-9]+)/)?Number(window.location.hash.match(/^#L([0-9]+)/)[1]):null;t.shiftKey&&r&&r<n?window.location.hash="L".concat(r,"-").concat(n):window.location.hash="L".concat(n),e.props.updateJumpLineCode(n)})),ba(ya(e),"goLfsSetting",(function(){window.open("/".concat(Ea.fullPath,"/settings/lfs#delete"),"_blank"),Object(h.b)({action:"view_lfs_file",page:"",type:"",control:"tag"})})),e}return ua(n,[{key:"componentDidUpdate",value:function e(){if(this.props.jump_line_code&&!this.state.hasJumpedLineCode){var t=document.getElementById("to-jump-line");if(t){var n=document.getElementById("container");n.scrollTop=0,n.scrollTop=t.getBoundingClientRect().top-91-n.offsetHeight/4,this.setState({hasJumpedLineCode:!0}),this.props.updateJumpLineCode(null)}}}},{key:"renderBlobContentJsx",value:function e(){var t=this.props,n=t.blob,r=t.renderType,a=t.blobSize,i=t.resourcePath,c=t.is_lfs,l=t.isFileNotFound,s=t.fileReqFailInfo,p=t.positions,m=t.activeId,y=t.lsSearchMap,d=t.isGramOverlayOpen,h=t.snippetMap,b=t.isGramOverlayLoading,g=t.trackMap,v=t.isLoadingSnippets,E=t.gramOverlayPage,w=t.gramOverlayPageSize,O=i.split("/")[i.split("/").length-1],j=Ea.role,S,_;if(l)return o.a.createElement(mr.a,{size:"small",type:"card",content:"\u6587\u4ef6\u8d44\u6e90\u4e0d\u5b58\u5728",description:Object(f.a)(u.d,j)?o.a.createElement("a",{className:"no-href-with-click",onClick:this.goLfsSetting},"\u67e5\u770b LFS \u6587\u4ef6\u5220\u9664\u8bb0\u5f55"):"\u5982\u9700\u67e5\u8be2 LFS \u6587\u4ef6\u5386\u53f2\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5904\u7406",imgType:"org-list-empty",className:"no-content no-btns"});if(s)return o.a.createElement(mr.a,{size:"small",type:"card",content:s,imgType:"org-list-empty",className:"no-content no-btns"});var P=window.location.hash.match(/^#L([0-9]+)/)?Number(window.location.hash.match(/^#L([0-9]+)/)[1]):null,R=P?window.location.hash.slice(2).split("-").map((function(e){return Number(e)})):[];switch(r){case"TEXT":if(!c&&a<u.l)if(J.b.isIpynb(i)&&J.b.isJSON(n))S=o.a.createElement(Br.a.Body,null,o.a.createElement(Ko,{blob:n}));else if(J.b.isMarkdown(i)){var T=n||"",C=/!\[.*?\]\(.*?\)/g,N=T.match(C);N&&N.forEach((function(e){var t=J.b.transformRelativePathToAbsolutePath(e,i);T=T.replace(e,t)})),S=o.a.createElement(Br.a.Body,null,o.a.createElement("div",{className:"markdown-body",dangerouslySetInnerHTML:{__html:Object(Po.filterXSS)(J.b.xssHandler(Oa.render(T||"")),{onIgnoreTagAttr:function e(t,n,r){return"".concat(n,"=").concat(r)}})}}))}else{var k="".concat(O.split(".")[O.split(".").length-1]),I="";switch(k){case"vue":I="arduino";break;case"html":I="html";break;default:I=""}S=o.a.createElement(Br.a.Body,{noPadding:!0},""!==n?o.a.createElement("div",{id:"highlighter-blob-content"},o.a.createElement(Lr.a,{language:I,wrapLines:!0,lineProps:function e(t){var n={};return P===t&&(n.id="to-jump-line"),R[0]<=t&&R[R.length-1]>=t&&(n.style={background:"#fffbdd",display:"block"}),n},selectedLines:R,onLineNumberClick:this.onLineNumberClick,positions:p,activeId:m},n),o.a.createElement(Ho.a,{visible:d,lsSearchMap:y,trackMap:g,snippetMap:h,activeId:m,resourcePath:i,onClose:this.onClose,onJump:this.onJump,loading:b,isLoadingSnippets:v,language:k,container:function e(){return document.querySelector(".layout-bottom ")},align:"tl bl",gramOverlayPage:E,gramOverlayPageSize:w,getSnippets:this.props.getSnippets})):o.a.createElement("div",{className:"binary-placeholder"},Ze.a.file_empty))}else S=o.a.createElement(Br.a.Body,null,o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement("a",{className:c?"":"text-black",style:{fontSize:"16px",display:"block",margin:c?0:"12px 0 12px"},href:"/".concat(Ea.fullPath,"/raw/").concat(J.b.revisionEncodeURI(wa.revision),"/").concat(i),target:"_blank"},Ze.a.file_view_raw),!c&&o.a.createElement("div",{className:"text-grey",style:{fontSize:"14px"}},Ze.a.file_view_raw_tips)));break;case"BINARY":S=J.b.isImageSuffix(O)&&a<u.m?o.a.createElement(Br.a.Body,null,o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement("img",{src:"/".concat(Ea.fullPath,"/raw/").concat(J.b.revisionEncodeURI(wa.revision),"/").concat(i),style:{maxWidth:"100%"}}))):o.a.createElement(Br.a.Body,null,o.a.createElement("div",{className:"tc not-previewable"},o.a.createElement(_o.default,{size:"middle",image:"https://img.alicdn.com/tfs/TB1VZ4jhQL0gK0jSZFxXXXWHVXa-400-320.png",desc:J.b.isImageSuffix(O)?"\u6587\u4ef6\u8fc7\u5927\uff0c\u4e0d\u652f\u6301\u9884\u89c8\uff0c\u8bf7\u4e0b\u8f7d\u81f3\u672c\u5730\u67e5\u770b":"\u5f53\u524d\u6587\u4ef6\u4e0d\u652f\u6301\u9884\u89c8\uff0c\u8bf7\u4e0b\u8f7d\u81f3\u672c\u5730\u67e5\u770b",btnProps:[{type:"primary",component:"a",href:"/".concat(Ea.fullPath,"/raw/").concat(J.b.revisionEncodeURI(wa.revision),"/").concat(i,"?type=download"),target:"_blank",name:o.a.createElement("span",null,o.a.createElement(Z.a,{type:"export",biz:"code"})," \u4e0b\u8f7d\u6587\u4ef6")}]})))}return S}},{key:"render",value:function e(){var t=this,n=this.props,r=n.blob,a=n.blobSize,i=n.renderType,c=n.resourcePath,l=n.isGettingBlob,s=n.lastCommit,p=n.isInitedLeftTree,m=n.treeData,y=n.protectedBranch,h=n.is_lfs,b=n.isFileNotFound,g=n.fileReqFailInfo,v=n.lsif_service_enable,E=n.ipSetting,w=Ea.role,O=Ea.isArchive,j=wa.revisionType,S=c.split("/")[c.split("/").length-1];if(l)return o.a.createElement(ra,null);var _=!b&&!g;if(null===r&&_)return null;var P=null;a&&(P=a>1024?(P=Math.round(a/1024))>1024?"".concat(Math.round(P/1024)," MB"):"".concat(P," KB"):"".concat(a," Bytes"));var R=u.a.access_level,T=Object(f.b)(y,w),C=w===R[30],N="tag"===j||"sha1"===j;return o.a.createElement(o.a.Fragment,null,J.b.isGramServicePath(S)&&!v&&o.a.createElement(Wo.a,{role:w}),o.a.createElement(Br.a,null,o.a.createElement(Br.a.Header,null,o.a.createElement("div",{className:"file-box-header-detail"},o.a.createElement("div",null,o.a.createElement(Rn.a,{className:"header-file-icon",fileName:S}),o.a.createElement("span",{className:"display-inline-block"},S),h&&o.a.createElement(jo.a,{role:w})),o.a.createElement("div",{className:"file-box-header-detail-right"},"false"===O&&"TEXT"===i&&_?o.a.createElement(o.a.Fragment,null,Object(f.a)(u.g,w)&&T?o.a.createElement(o.a.Fragment,null,"branch"!==j?o.a.createElement(k,{tooltipText:"\u53ea\u6709\u5206\u652f\u4e0b\u7684\u6587\u4ef6\u53ef\u4ee5\u88ab\u7f16\u8f91",isIcon:!0,type:"primary",name:"pencil",color:"gray",className:"file-icon-margin-left"}):o.a.createElement(ga,{trigger:o.a.createElement(d.Button.Icon,{type:"primary",name:"pencil",color:"gray",onClick:this.goEdit,className:"file-icon-margin-left"}),text:"\u7f16\u8f91"})):o.a.createElement(ga,{trigger:o.a.createElement(d.Button.Icon,{type:"primary",name:"pencil",color:"gray",disabled:!0,className:"file-icon-margin-left"}),align:"t",text:N?"\u53ea\u6709\u5206\u652f\u4e0b\u624d\u53ef\u4ee5\u64cd\u4f5c":o.a.createElement(o.a.Fragment,null,Object(f.a)(u.g,w)?o.a.createElement(o.a.Fragment,null,C?"\u5f53\u524d\u4e3a\u4fdd\u62a4\u5206\u652f\uff0c\u65e0\u6743\u9650\u76f4\u63a5\u63a8\u9001\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5904\u7406":"\u5f53\u524d\u4e3a\u4fdd\u62a4\u5206\u652f\uff0c\u65e0\u6743\u9650\u76f4\u63a5\u63a8\u9001\uff0c\u53ef\u524d\u5f80\u8bbe\u7f6e\u5904\u7406"):"\u65e0\u6743\u9650\u8fdb\u884c\u7f16\u8f91\u6587\u4ef6\u64cd\u4f5c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u7533\u8bf7\u5bf9\u5e94\u7684\u6743\u9650")})):null,"false"===O&&T&&Object(f.a)(u.g,w)&&o.a.createElement(So.a,{neededRole:u.g,role:w},o.a.createElement(Oo,this.props)),"false"===O&&(!T||!Object(f.a)(u.g,w))&&o.a.createElement(ga,{trigger:o.a.createElement(d.Button.Icon,{type:"primary",name:"trashbin",color:"gray",disabled:!0,className:"file-icon-margin-left"}),align:"t",text:N?"\u53ea\u6709\u5206\u652f\u4e0b\u624d\u53ef\u4ee5\u64cd\u4f5c":o.a.createElement(o.a.Fragment,null,Object(f.a)(u.g,w)?o.a.createElement(o.a.Fragment,null,C?"\u5f53\u524d\u4e3a\u4fdd\u62a4\u5206\u652f\uff0c\u65e0\u6743\u9650\u76f4\u63a5\u63a8\u9001\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5904\u7406":"\u5f53\u524d\u4e3a\u4fdd\u62a4\u5206\u652f\uff0c\u65e0\u6743\u9650\u76f4\u63a5\u63a8\u9001\uff0c\u53ef\u524d\u5f80\u8bbe\u7f6e\u5904\u7406"):"\u65e0\u6743\u9650\u8fdb\u884c\u5220\u9664\u6587\u4ef6\u64cd\u4f5c\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u7533\u8bf7\u5bf9\u5e94\u7684\u6743\u9650")}),o.a.createElement("span",{className:"file-icon-margin-left project-nav-top-line"}),"false"===O&&"TEXT"===i&&p&&m.length?o.a.createElement(X,{tooltipText:"\u53ea\u6709\u5206\u652f\u4e0b\u624d\u53ef\u4ee5\u8fdb\u884c Web IDE \u64cd\u4f5c",type:"normal",text:!0,className:"file-icon-margin-left",component:"a",onClick:function e(n){t.goWebIde(n,c)},ipSetting:E},"Web IDE"):null,o.a.createElement(oo,this.props)))),o.a.createElement("div",null,this.renderBlobContentJsx())))}}]),n}(o.a.Component),Sa=n(1457),_a=n(1494);function Pa(e){return(Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Ra(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ta(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ca(e,t,n){return t&&Ta(e.prototype,t),n&&Ta(e,n),e}function Na(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ka(e,t)}function ka(e,t){return(ka=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Ia(e){var t=La();return function n(){var r=Da(e),o;if(t){var a=Da(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return xa(this,o)}}function xa(e,t){return!t||"object"!==Pa(t)&&"function"!=typeof t?Ba(e):t}function Ba(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function La(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Da(e){return(Da=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Fa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ma=window.FORCE,Ua=Ma.pathResource,Aa=Ma.resourceSubject,Va=function(e){Na(n,e);var t=Ia(n);function n(){var e;Ra(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Fa(Ba(e=t.call.apply(t,[this].concat(o))),"getBreadList",(function(){var t=e.props.resourcePath,n=Ua.fullPath,r,o=[{name:n.split("/").pop(),path:"/".concat(n)}],a="/"!==t&&t?t.split("/"):[],i="";return a.forEach((function(e){i+="/".concat(e),o.push({path:"/".concat(Ua.fullPath,"/tree/").concat(J.b.revisionEncodeURI(Aa.revision),"/").concat(i),name:e,resourcePath:i})})),o})),Fa(Ba(e),"handleClick",(function(t){var n=t?t.slice(1):"";e.props.updateSetSelectedType&&e.props.updateSetSelectedType({resourceSubject:{subject:"tree",path:n}}),Object(Fe.d)("/".concat(Ua.fullPath,"/tree/").concat(J.b.revisionEncodeURI(Aa.revision),"/").concat(n)),e.props.getExpandedTreeData(n)})),e}return Ca(n,[{key:"render",value:function e(){var t=this,n=this.getBreadList();return o.a.createElement(o.a.Fragment,null,o.a.createElement(d.Breadcrumb,{separator:o.a.createElement(Z.a,{type:"path-slash",biz:"code"})},n.map((function(e,r){return r===n.length-1?o.a.createElement(d.Breadcrumb.Item,{key:e.path},e.name):o.a.createElement(d.Breadcrumb.Item,{onClick:function n(r){var o;-1!==r.currentTarget.getAttribute("class").indexOf("breadcrumb-show-more")||t.handleClick(e.resourcePath)},key:e.path,className:"breadcrumb-not-last",style:{cursor:"pointer"}},e.name)}))))}}]),n}(o.a.Component);function za(e){return(za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Ka(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ha(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ka(Object(n),!0).forEach((function(t){li(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ka(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wa(){return(Wa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Xa(e){return Ya(e)||Ga(e)||Ja(e)||qa()}function qa(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ja(e,t){if(e){if("string"==typeof e)return Za(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Za(e,t):void 0}}function Ga(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ya(e){if(Array.isArray(e))return Za(e)}function Za(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ei(e,t,n){return t&&Qa(e.prototype,t),n&&Qa(e,n),e}function ti(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ni(e,t)}function ni(e,t){return(ni=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function ri(e){var t=ii();return function n(){var r=ci(e),o;if(t){var a=ci(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return oi(this,o)}}function oi(e,t){return!t||"object"!==za(t)&&"function"!=typeof t?ai(e):t}function ai(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ii(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ci(e){return(ci=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function li(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Fa(Va,"propTypes",{resourcePath:y.a.string,updateSetSelectedType:y.a.func,getExpandedTreeData:y.a.object}),Fa(Va,"defaultProps",{resourcePath:"",updateSetSelectedType:function e(){},getExpandedTreeData:function e(){}});var ui=d.Balloon.Tooltip,si=window.FORCE,fi=si.pathResource,pi=si.resourceSubject;function mi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n,r=new Date;return function(){var o=this,a=arguments,i=new Date-0;clearTimeout(n),i-r>=t?(console.log("now",i,i-r),e.apply(o,a),r=i):n=setTimeout((function(){e.apply(o,a)}),t)}}var yi=function(e){ti(n,e);var t=ri(n);function n(){var e;$a(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return li(ai(e=t.call.apply(t,[this].concat(o))),"getShowMaxLine",mi((function(){var t=document.documentElement.clientHeight||document.body.clientHeight,n=e.dom.scrollTop,r=parseInt((t+n-200-91)/40,10);e.props.getBatchDataOnScroll(r)}))),li(ai(e),"jumpTo",(function(t,n){var r=e.props.defaultExpandedKeys;if("tree"===n){if(-1===r.indexOf(t)){var o=[].concat(Xa(r),[t]);e.props.updateData({defaultExpandedKeys:o,selectedKeys:[t]})}Object(Fe.d)("/".concat(fi.fullPath,"/tree/").concat(J.b.revisionEncodeURI(pi.revision),"/").concat(J.b.filepathEncodeURI(t))),e.props.updateSetSelectedType({resourceSubject:{subject:"tree",path:t}}),e.props.getExpandedTreeData(t)}"blob"===n&&(e.props.updateData({selectedKeys:[t]}),Object(Fe.d)("/".concat(fi.fullPath,"/blob/").concat(J.b.revisionEncodeURI(pi.revision),"/").concat(J.b.filepathEncodeURI(t))),e.props.updateSetSelectedType({resourceSubject:{subject:"blob",path:t}}))})),li(ai(e),"goNew",(function(){var t=e.props.resourcePath,n=pi.revision||"master";Object(Fe.d)("/".concat(fi.fullPath,"/new/").concat(J.b.revisionEncodeURI(n),"/").concat(J.b.filepathEncodeURI(t))),e.props.updateSetSelectedType({resourceSubject:{subject:"new",path:t}})})),li(ai(e),"goWebIde",(function(e,t){var n=pi.revisionType;e.preventDefault(),Object(q.P)({filepath:t,branch:"branch"===n?pi.revision:"",commit:"sha1"===n?pi.revision:"",line:"",column:"",type:"view",merge_commit:"",mergerequestId:""}).then((function(e){window.open(e.endpoint)})).catch((function(e){console.error(e)}))})),li(ai(e),"sortFile",(function(e){if(!e||!Array.isArray(e))return e;var t=[],n=[],r=[];return e.forEach((function(e){"tree"===e.type?t.push(e):"commit"===e.type?n.push(e):r.push(e)})),t.concat(n,r)})),e}return ei(n,[{key:"componentDidMount",value:function e(){this.dom=document.querySelector(".layout-bottom"),this.dom&&this.dom.addEventListener("scroll",this.getShowMaxLine)}},{key:"componentWillUnmount",value:function e(){this.dom&&this.dom.removeEventListener("scroll",this.getShowMaxLine)}},{key:"render",value:function e(){var t=this,n=this.props,r=n.currentTreeData,a=n.submodules,i=n.isLoadingTable,c=n.lastCommit,l=n.isInitedLeftTree,u=n.treeData,s=n.isLoadingLastCommit,f=n.ipSetting,p=fi.role,m=fi.isArchive;return o.a.createElement("div",{className:"project-content-body"},o.a.createElement("div",{className:"overview-info"},o.a.createElement(Va,this.props),o.a.createElement("div",null,"false"===m?o.a.createElement(o.a.Fragment,null,l&&u.length?o.a.createElement(X,{tooltipText:"\u53ea\u6709\u5206\u652f\u4e0b\u624d\u53ef\u4ee5\u8fdb\u884c Web IDE \u64cd\u4f5c",type:"normal",onClick:function e(n){Object(h.b)({action:"goto_webide",page:"Repo-Files"}),t.goWebIde(n,"")},style:{marginRight:16},ipSetting:f},"Web IDE"):null,o.a.createElement(Ye,this.props),o.a.createElement(Ee,this.props),o.a.createElement(qt,Wa({},this.props,{goNew:this.goNew}))):null)),o.a.createElement("div",{className:"file-commit-container"},o.a.createElement(Sa.a,{commitInfo:c,isLoading:s})),i?null:o.a.createElement(d.Table,{hasBorder:!1,dataSource:this.sortFile(r),pagination:!1,className:"file-table",emptyContent:o.a.createElement(mr.a,{size:"small",type:"card",content:"",description:"\u6682\u65e0\u6570\u636e",imgType:"org-list-empty",className:"no-content no-btns"}),onRowClick:function e(n){switch(n.type){case"tree":t.jumpTo(n.path,"tree");break;case"blob":t.jumpTo(n.path,"blob");break;case"commit":var r=a.find((function(e){return e.path===n.path}));window.location=r.http_homepage_url}}},o.a.createElement(d.Table.Column,{title:Ze.a.file_name,className:"file-name-col",cell:function e(t,n,r){var i=o.a.createElement("div",{className:"table-cell-one-line ".concat(r.is_lfs?"lfs":"")},"commit"!==r.type?o.a.createElement("span",null,"tree"===r.type?o.a.createElement(Z.a,{type:"folder",biz:"code",className:"file-icon"}):o.a.createElement(Rn.a,{className:"file-icon",fileName:r.name,style:{verticalAlign:"text-bottom"}}),o.a.createElement("span",{style:{marginLeft:8}},r.name)):o.a.createElement("span",null,o.a.createElement("i",{className:"fa fa-archive"}),o.a.createElement("span",{style:{marginLeft:8}},r.name,a.find((function(e){return e.path===r.path}))?o.a.createElement("a",{href:"".concat(a.find((function(e){return e.path===r.path})).http_homepage_url,"/tree/").concat(r.id)},"@ ",r.id.slice(0,8)):null)));return o.a.createElement(o.a.Fragment,null,o.a.createElement(ui,{trigger:i,align:"b"},r.name),r.is_lfs&&o.a.createElement(jo.a,{role:p}))}}),o.a.createElement(d.Table.Column,{title:Ze.a.file_last_commit,className:"file-table-secondary-col file-last-commit-col",cell:function e(t,n,r){return o.a.createElement(ui,{trigger:o.a.createElement("div",{className:"table-cell-one-line"},r.lastCommit),align:"b"},r.lastCommit)}}),o.a.createElement(d.Table.Column,{title:"\u521b\u5efa\u8005",className:"file-table-secondary-col username-col",cell:function e(t,n,r){var a=o.a.createElement("div",{className:"table-cell-one-line"},r.username);return o.a.createElement(ui,{trigger:a,align:"b"},r.username)}}),o.a.createElement(d.Table.Column,{title:"\u66f4\u65b0\u65f6\u95f4",className:"file-table-secondary-col updatetime-col",cell:function e(t,n,r){return o.a.createElement("span",null,r.lastUpdate)}})))}}]),n}(o.a.Component),di=Object(c.connect)((function(e){return Ha(Ha({},e.project.projectFiles),{},{projectInfo:e.project.root.projectInfo})}),(function(e){return Object(l.bindActionCreators)(s,e)}))(yi);function hi(e){return(hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function bi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vi(e,t,n){return t&&gi(e.prototype,t),n&&gi(e,n),e}function Ei(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wi(e,t)}function wi(e,t){return(wi=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Oi(e){var t=_i();return function n(){var r=Pi(e),o;if(t){var a=Pi(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return ji(this,o)}}function ji(e,t){return!t||"object"!==hi(t)&&"function"!=typeof t?Si(e):t}function Si(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Pi(e){return(Pi=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Ri(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ti=d.Balloon.Tooltip,Ci=window.FORCE,Ni=Ci.pathResource,ki=Ci.resourceSubject,Ii=new Fr.a({html:!0,highlight:function e(t,n){if(n&&Vr.a.getLanguage(n))try{return'<pre><code class="hljs">'.concat(Vr.a.highlightAuto(t).value,"</code></pre>")}catch(e){return""}return""},replaceLink:function e(t,n,r){var o="/".concat(Ni.fullPath,"/blob/").concat(J.b.revisionEncodeURI(ki.revision),"/"),a="/".concat(Ni.fullPath,"/raw/").concat(J.b.revisionEncodeURI(ki.revision),"/");return 0!==t.indexOf("http")&&0!==t.indexOf("#")?"image"===r.type?"".concat(a).concat(t):"".concat(o).concat(t):(r.attrPush(["target","_blank"]),t)}}).use(Ur.a),xi=function(e){Ei(n,e);var t=Oi(n);function n(e){var r;return bi(this,n),Ri(Si(r=t.call(this,e)),"fetchReadmeBlob",(function(e){var t=e.currentTreeData,n=e.get_general_info_and_blobs,o=e.resourcePath;if(r.state.hasFetchBlob)return!1;if(t.length){var a=r.getReadmeName(t),i="".concat(o).concat(o&&"/").concat(a);if(!i)return!1;n(i),r.setState({hasFetchBlob:!0})}})),Ri(Si(r),"getReadmeName",(function(e){if(!e.length)return"";var t,n=e.find((function(e){return"blob"===e.type&&"readme.md"===e.name.toLowerCase()})),r=e.find((function(e){return"blob"===e.type&&"readme"===e.name.toLowerCase()})),o=e.find((function(e){return"blob"===e.type&&-1!==e.name.toLowerCase().indexOf("readme")})),a=n||r||o;return a&&(t=a.name),t||""})),Ri(Si(r),"onTreeItemSelect",(function(e,t){var n="/".concat(Ni.fullPath,"/blob/").concat(J.b.revisionEncodeURI(ki.revision),"/"),r;t.node.props.isLeaf&&Object(Fe.d)(n+e[0],{state:{forceUpdate:!0}})})),Ri(Si(r),"goAddReadme",(function(){var e=window.FORCE.pathResource.defaultBranch||"master";Object(Fe.d)("/".concat(Ni.fullPath,"/new/").concat(e,"?file_name=README.md")),r.props.updateSetSelectedType({resourceSubject:{subject:"new",path:""}})})),Ri(Si(r),"renderBlob",(function(e,t){var n=r.props,a=n.is_lfs,i=n.fileReqFailInfo;return i?o.a.createElement(mr.a,{size:"small",type:"card",content:i,imgType:"org-list-empty",className:"no-content no-btns"}):a?o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement("a",{className:"text-black",style:{fontSize:"16px",display:"block",margin:"12px 0 12px"},href:"/".concat(Ni.fullPath,"/raw/").concat(J.b.revisionEncodeURI(ki.revision),"/").concat(t),target:"_blank"},Ze.a.file_view_raw)):o.a.createElement("div",{className:"markdown-body",dangerouslySetInnerHTML:{__html:Object(Po.filterXSS)(J.b.xssHandler(Ii.render(e||"")),{onIgnoreTagAttr:function e(t,n,r){return"".concat(n,"=").concat(r)}})}})})),Ri(Si(r),"readmePreviewJsx",(function(){var e=r.props,t=e.currentTreeData,n=e.resourcePath,a=e.blob,i=e.filesViewType,c=e.protectedBranch,l=e.is_lfs,s=Ni.role,p=""===n,m=u.a.access_level,y=Object(f.b)(c,s),b=s===m[30],g=r.getReadmeName(t),v="".concat(n).concat(n&&"/").concat(g),E=window.FORCE.pathResource&&"true"===window.FORCE.pathResource.isArchive;if(!v&&p)return Object(f.a)(u.g,s)&&y&&!E?o.a.createElement(_o.default,{style:{marginTop:"116px"},size:"middle",desc:"\u5f53\u524d\u4ed3\u5e93\u6ca1\u6709 README \u6587\u4ef6",image:"https://img.alicdn.com/tfs/TB1xfUyhXY7gK0jSZKzXXaikpXa-400-320.png",btnProps:[{type:"primary",name:"\u7acb\u5373\u6dfb\u52a0",onClick:function e(){Object(h.b)({action:"new_readme",page:"Repo-Files"}),r.goAddReadme()}}]}):!Object(f.a)(u.g,s)||E?o.a.createElement(_o.default,{style:{marginTop:"116px"},size:"middle",desc:"\u5f53\u524d\u4ed3\u5e93\u6ca1\u6709 README \u6587\u4ef6",image:"https://img.alicdn.com/tfs/TB1xfUyhXY7gK0jSZKzXXaikpXa-400-320.png"}):o.a.createElement(_o.default,{style:{marginTop:"116px"},size:"middle",desc:"\u5f53\u524d\u4ed3\u5e93\u6ca1\u6709 README \u6587\u4ef6",image:"https://img.alicdn.com/tfs/TB1xfUyhXY7gK0jSZKzXXaikpXa-400-320.png",btns:[o.a.createElement(Ti,{trigger:o.a.createElement(d.Button,{type:"primary",disabled:!0},"\u7acb\u5373\u6dfb\u52a0"),align:"t",text:b?"\u5f53\u524d\u4e3a\u4fdd\u62a4\u5206\u652f\uff0c\u65e0\u6743\u9650\u76f4\u63a5\u63a8\u9001\uff0c\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u5904\u7406":"\u5f53\u524d\u4e3a\u4fdd\u62a4\u5206\u652f\uff0c\u65e0\u6743\u9650\u76f4\u63a5\u63a8\u9001\uff0c\u53ef\u524d\u5f80\u8bbe\u7f6e\u5904\u7406"})]});if(!v||null===a||"base64"===a.encoding)return null;var w=a;return o.a.createElement(Br.a,{style:{marginTop:"".concat(p&&"tree"===i?"":"20px")}},o.a.createElement(Br.a.Header,{className:"file-box-header"},o.a.createElement("div",null,o.a.createElement(Rn.a,{className:"header-file-icon",fileName:g}),o.a.createElement("span",{className:"display-inline-block"},g),l&&o.a.createElement(jo.a,{role:s}))),o.a.createElement(Br.a.Body,null,r.renderBlob(w,v)))})),r.state={hasFetchBlob:!1},r}return vi(n,[{key:"componentWillReceiveProps",value:function e(t){this.fetchReadmeBlob(t)}},{key:"render",value:function e(){var t=this.props,n=t.isInitedLeftTree,r=t.isGettingBlob;return!!n&&(r?o.a.createElement(ra,null):o.a.createElement("div",null,this.readmePreviewJsx()))}}]),n}(o.a.Component),Bi=n(1463),Li=n(21);function Di(e){return(Di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Fi(){return(Fi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Mi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ui(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ai(e,t,n){return t&&Ui(e.prototype,t),n&&Ui(e,n),e}function Vi(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zi(e,t)}function zi(e,t){return(zi=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Ki(e){var t=Xi();return function n(){var r=qi(e),o;if(t){var a=qi(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Hi(this,o)}}function Hi(e,t){return!t||"object"!==Di(t)&&"function"!=typeof t?Wi(e):t}function Wi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xi(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function qi(e){return(qi=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Ji(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Gi=d.Balloon.Tooltip,Yi=window.FORCE,Zi=Yi.pathResource,$i=Yi.resourceSubject,Qi=function(e){Vi(n,e);var t=Ki(n);function n(e){var r;return Mi(this,n),Ji(Wi(r=t.call(this,e)),"getReadMeTemplate",(function(e){r.setState({isLoadingTemplate:!0}),p.a.fetch({api:"project.file.readme.template",data:{readme_types:"empty,user_guide"}}).then((function(t){var n=t.slice(1);if(e){r.setState({allTemplates:n,templates:n,isLoadingTemplate:!1});var o=r.state.templateType,a=n.find((function(e){return e.type&&e.type.toLowerCase()===o}));r.field.setValue("content",a.content||"")}else r.setState({allTemplates:n,isLoadingTemplate:!1})})).fail((function(){r.setState({isLoadingTemplate:!1})}))})),Ji(Wi(r),"getIgnoreTemplate",(function(){if(ee.a)return null;r.setState({isLoadingTemplate:!0}),p.a.fetch({api:"project.file.ignore.lang"}).then((function(e){r.setState({allTemplateObj:e||{},isLoadingTemplate:!1})})).fail((function(){r.setState({isLoadingTemplate:!1})}))})),Ji(Wi(r),"createFile",(function(e,t){var n=e.file_path,o=e.content,a=void 0===o?"":o,i=e.branch_name,c=e.task_ids,l=$i.revision||"master";return p.a.fetch({api:"projects.files.new.associateTask",data:{project_id:Zi.id,task_ids:c,file_path:n,branch_name:i,commit_message:t,content:a}}).then((function(){d.Toast.success({title:"\u63d0\u4ea4\u6210\u529f"}),r.props.updateData({hasPush:!0}),window.onbeforeunload=null,Object(Fe.d)("/".concat(Zi.fullPath,"/blob/").concat(J.b.revisionEncodeURI(l),"/").concat(J.b.filepathEncodeURI(e.file_path)),{state:{forceUpdate:!0}}),r.setState({submitting:!1})})).fail((function(){r.setState({submitting:!1})}))})),Ji(Wi(r),"onFormSave",(function(){if(!r.state.submitting){r.setState({submitting:!0});var e=r.props.resourcePath,t=J.b.getUrlSearchParam("isMaster");r.field.validate((function(n){if(n)n.file_path&&(d.Toast.error({title:"\u8bf7\u8f93\u5165\u6587\u4ef6\u540d"}),r.setState({submitting:!1}));else{var o=r.field.getValues(),a=o.commit_message_content?"".concat(o.commit_message_title,"\n").concat(o.commit_message_content):o.commit_message_title;t||(o.file_path="".concat(e).concat(e&&"/").concat(o.file_path));var i=new RegExp(" */ *","g");o.file_path=o.file_path.replace(i,"/"),r.state.task_ids&&(o.task_ids=r.state.task_ids),r.createFile(o,a)}}))}})),Ji(Wi(r),"nameValidator",(function(e,t,n){if(t)if(!1!==/^(?!(\/)).+$/.test(t))if(new RegExp("^[\\u4e00-\\u9fa5a-z A-Z0-9_\\-\\.\\/]*$").test(t)){var o=r.props.resourcePath,a="".concat(o).concat(o&&"/").concat(t),i;r.state.existFileList.forEach((function(e){a===e.path&&n("\u6587\u4ef6\u5df2\u5b58\u5728")})),n()}else n('\u540d\u79f0\u53ea\u80fd\u5305\u542b\u4e2d\u82f1\u6587\u3001\u6570\u5b57\u3001"_"\u3001"-"\u3001"."\u4ee5\u53ca\u7a7a\u683c');else n("\u65b0\u5efa\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5\u4ee5 / \u5f00\u5934");else n()})),Ji(Wi(r),"cancleConfirm",(function(){if(window.onbeforeunload=null,r.confirmResult=window.confirm("\u60a8\u6b63\u5728\u65b0\u5efa\u6587\u4ef6\uff0c\u662f\u5426\u786e\u8ba4\u79bb\u5f00\uff1f"),!r.confirmResult)return!1;window.onbeforeunload=null,Object(Fe.d)("/".concat(Zi.fullPath),{state:{forceUpdate:!0}})})),Ji(Wi(r),"onOpen",(function(){r.field.validate((function(e){e||r.setState({visible:!0})}))})),Ji(Wi(r),"onClose",(function(){r.setState({visible:!1})})),Ji(Wi(r),"renderTemplateSelect",(function(){var e=r.state,t=e.templates,n=e.templateType;return t.length?o.a.createElement("div",{className:"new-file-template-select"},o.a.createElement(d.Select,{value:n,onChange:function e(n){r.setState({templateType:n});var o=t.find((function(e){return e.type&&e.type.toLowerCase()===n}))||{};r.field.setValue("content",o.content||"")}},o.a.createElement(d.Select.Option,{value:""},"\u4e0d\u9009\u62e9\u6a21\u677f"),o.a.createElement(d.Select.Option,{value:"empty"},"readme\u6a21\u677f"))):null})),Ji(Wi(r),"selectLang",(function(e){r.setState({ignore_lang:e||""}),r.getLangContent(e)})),Ji(Wi(r),"getLangContent",(function(e){e?p.a.fetch({api:"project.file.ignore.template",data:{git_ignore_type:e}}).then((function(e){r.field.setValue("content",e.content||"")})):r.field.setValue("content","")})),Ji(Wi(r),"renderIgnoreTypes",(function(){var e=r.state,t=e.templateType,n=e.ignore_type,a=e.allTemplateObj,i=e.ignore_lang,c=e.allTemplates,l="README.md"===J.b.getUrlSearchParam("file_name");if(a&&Object.keys(a).length){var u=n?a[n]:[];return o.a.createElement("div",{className:"new-file-template-select"},o.a.createElement(d.Select,{value:t,onChange:function e(t){if("empty"===t){r.setState({templateType:t,ignore_type:""});var n=c.find((function(e){return e.type&&e.type.toLowerCase()===t}))||{};return r.field.setValue("content",n.content||""),void r.field.setValue("file_path",(r.field.getValue("file_path")||"").replace(".gitignore",""))}r.setState({ignore_type:t||"",templateType:t||""}),t?(r.field.setValue("content",""),r.field.setValue("file_path","".concat(r.field.getValue("file_path")||"",".gitignore"))):(r.setState({ignore_lang:""}),r.field.setValue("content",""),r.field.setValue("file_path",(r.field.getValue("file_path")||"").replace(".gitignore","")))},style:{marginRight:20}},o.a.createElement(d.Select.Option,{value:""},"\u4e0d\u9009\u62e9\u6a21\u677f\u7c7b\u578b"),l?o.a.createElement(d.Select.Option,{value:"empty"},"readme\u6a21\u677f"):o.a.createElement(d.Select.Option,{value:"git_ignore_types"},".gitignore")),"empty"!==t?o.a.createElement(d.Select,{value:i,onChange:r.selectLang,showSearch:!0,disabled:!u.length},o.a.createElement(d.Select.Option,{value:""},"\u4e0d\u9009\u62e9\u6a21\u677f"),u.map((function(e){return o.a.createElement(d.Select.Option,{value:e},e)}))):null)}})),r.field=new d.Field(Wi(r),{values:{file_path:J.b.getUrlSearchParam("file_name")||""}}),r.state={visible:!1,submitting:!1,existFileList:[],task_ids:"",inputAutoFocus:!J.b.getUrlSearchParam("file_name"),isLoadingTemplate:!1,templates:[],templateType:"",allTemplateObj:{},ignore_type:"",ignore_lang:""},r}return Ai(n,[{key:"componentDidMount",value:function e(){var t=this,n;(window.onbeforeunload=function(){return"\u786e\u5b9a\u79bb\u5f00\u6b64\u9875\u9762\uff1f"},"true"!==window.FORCE.pathResource.isEmpty)?(Object(q.n)().then((function(e){e.shift(),t.setState({existFileList:e})})).catch((function(e){console.log(e)})),this.getReadMeTemplate(),this.getIgnoreTemplate()):"README.md"===J.b.getUrlSearchParam("file_name")?this.getReadMeTemplate(!0):(this.getReadMeTemplate(),this.getIgnoreTemplate())}},{key:"render",value:function e(){var t=this,n=this.props.resourcePath,r=$i.revision||"master",a=this.field.init,i=this.field.getValue("file_path"),c=J.b.getUrlSearchParam("isMaster"),l=n&&n.split("/").join(" / "),u=this.state,s=u.inputAutoFocus,f=u.isLoadingTemplate;return o.a.createElement("div",{className:"project-new-files"},o.a.createElement(Br.a,null,o.a.createElement(Br.a.Header,null,c&&"1"===c?null:o.a.createElement("span",{style:{marginRight:n?16:0}},n&&"".concat(l," /")),o.a.createElement(d.Form,{field:this.field,className:"project-new-files-form"},o.a.createElement(d.Form.Item,{help:"error"===this.field.getState("file_path")?this.field.getError("file_path"):"\u8f93\u5165\u300c/\u300d\u53ef\u5c06\u6587\u4ef6\u521b\u5efa\u5230\u65b0\u6587\u4ef6\u5939\u4e0b",className:"project-new-files-input"},o.a.createElement(d.Input,Fi({},a("file_path",{rules:[{required:!0,message:Ze.a.file_name_required},{validator:this.nameValidator}]}),{placeholder:"\u8bf7\u8f93\u5165\u6587\u4ef6\u540d\u6216\u6587\u4ef6\u8def\u5f84",autoFocus:s,style:{width:"300px"}}))))),f?o.a.createElement(Li.a,null):o.a.createElement(Br.a.Body,{noPadding:!0},this.renderTemplateSelect(),this.renderIgnoreTypes(),o.a.createElement(Bi.a,Fi({},a("content"),{fileName:i,autoFocus:!s,editorStyle:{height:"calc(100vh - 76px - 162px - 60px)"}})),o.a.createElement("div",{style:{margin:"20px 0"}},o.a.createElement(d.Button,{disabled:null===this.field.getValue("file_path")||"error"===this.field.getState("file_path"),type:"primary",onClick:this.onOpen},"\u4fdd\u5b58"),o.a.createElement(d.Button,{onClick:this.cancleConfirm,style:{marginLeft:16},type:"normal"},"\u53d6\u6d88"),o.a.createElement(d.Dialog,{title:o.a.createElement(Gi,{trigger:o.a.createElement("div",{className:"file-form-title"},"\u63d0\u4ea4\u5230 ",r),align:"t"},o.a.createElement("span",{style:{wordBreak:"break-all"}},"\u63d0\u4ea4\u5230 ",r)),visible:this.state.visible,onOk:this.onFormSave,onCancel:this.onClose,onClose:this.onClose,style:{width:"600px"},okProps:{children:"\u63d0\u4ea4",loading:this.state.submitting},cancelProps:{children:"\u53d6\u6d88"}},o.a.createElement(pt,{field:this.field,defaultCommitMsg:"\u65b0\u5efa ".concat(i)}),ee.a?null:o.a.createElement(mt.a,{useBy:"submit",onChange:function e(n){if(n.map){var r=n.map((function(e){return e._id}));t.setState({task_ids:r.join(",")})}}}))))))}}]),n}(o.a.Component);function ec(e){return(ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function tc(){return(tc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function nc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oc(e,t,n){return t&&rc(e.prototype,t),n&&rc(e,n),e}function ac(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ic(e,t)}function ic(e,t){return(ic=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function cc(e){var t=sc();return function n(){var r=fc(e),o;if(t){var a=fc(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return lc(this,o)}}function lc(e,t){return!t||"object"!==ec(t)&&"function"!=typeof t?uc(e):t}function uc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sc(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function fc(e){return(fc=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function pc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var mc=window.FORCE,yc=mc.user,dc=mc.pathResource,hc=mc.resourceSubject,bc="@mail.teambition.com",gc=function e(t){var n=dc.isArchive,r=t.trigger;return"true"!==n?r:o.a.createElement(d.Balloon.Tooltip,{trigger:r,align:"t"},"\u4ee3\u7801\u5e93\u5df2\u5f52\u6863\uff0c\u4e0d\u5141\u8bb8\u63d0\u4ea4\u65b0\u5185\u5bb9")},vc=function(e){ac(n,e);var t=cc(n);function n(){var e;nc(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return pc(uc(e=t.call.apply(t,[this].concat(o))),"state",{openKeys:["one","two","three"],isDialogVisible:!1}),pc(uc(e),"onDialogClose",(function(){e.setState({isDialogVisible:!1})})),pc(uc(e),"onNewFile",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=dc.isArchive;if("true"!==n){var r=hc.revision||dc.defaultBranch||"master";Object(h.b)({action:t?"new_readme":"new_file",page:"Empty-Repo",type:"",control:""}),Object(Fe.d)("/".concat(dc.fullPath,"/new/").concat(r,"/?file_name=").concat(t)),e.props.updateSetSelectedType({resourceSubject:{subject:"new",path:""}})}})),pc(uc(e),"toggleKeys",(function(t){var n=e.state.openKeys,r=n.findIndex((function(e){return e===t}));r>-1?n.splice(r,1):n.push(t),e.setState({openKeys:n})})),pc(uc(e),"showUploadFile",(function(){var t;"true"!==dc.isArchive&&(Object(h.b)({action:"import_file",page:"Empty-Repo",type:"",control:""}),e.setState({isDialogVisible:!0}))})),e}return oc(n,[{key:"render",value:function e(){var t=this,n=this.props,r=n.projectInfo,a=n.cloneWay,i=dc.role,c=dc.fullPath.split("/")[dc.fullPath.split("/").length-1],l=this.state,s=l.openKeys,p=l.isDialogVisible,m=yc.email;J.b.endsWith(m,bc)&&(m="\u4f60\u7684\u90ae\u7bb1");var y,h=[{title:"SSH",address:r.ssh_url_to_repo},{title:"HTTPS",address:r.http_url_to_repo}].find((function(e){return e.title===a})).address,b=Object(f.a)(u.g,i),g="true"===dc.isArchive;return o.a.createElement("div",null,o.a.createElement(mr.a,{size:"middle",title:"\u4ee3\u7801\u5e93\u7a7a\u7a7a\u5982\u4e5f\uff5e",description:"\u4f60\u53ef\u4ee5\u65b0\u5efa\u6587\u4ef6\u6216\u4f7f\u7528 Git \u547d\u4ee4\u5173\u8054\u5df2\u6709\u4ee3\u7801\u6587\u4ef6\uff0c\u5f00\u59cb\u5206\u652f\u7ba1\u7406\u3001\u5b89\u5168\u68c0\u6d4b\u3001\u4ee3\u7801\u8bc4\u5ba1\u4e0e\u5408\u5e76\u7b49\u64cd\u4f5c",className:"empty-project-placeholder",image:"https://img.alicdn.com/tfs/TB14nF.yHH1gK0jSZFwXXc7aXXa-392-342.png"}),b&&o.a.createElement("div",{className:"empty-init-project"},o.a.createElement("div",{className:"empty-title"},"\u5feb\u901f\u521d\u59cb\u5316"),o.a.createElement("div",{className:"empty-init-cards"},o.a.createElement(gc,{trigger:o.a.createElement("div",{className:"empty-init-cards-item ".concat(g?"disabled":""),onClick:function e(){t.onNewFile("README.md")}},o.a.createElement("div",null,o.a.createElement(d.Button.Icon,{name:"plus",type:"primary",disabled:g})),o.a.createElement("div",{className:"content"},o.a.createElement("div",{className:"title"},"\u65b0\u5efa Readme"),o.a.createElement("div",{className:"desc"},"\u4f7f\u7528 Readme.md \u4e00\u952e\u521d\u59cb\u5316\u5de5\u7a0b")),o.a.createElement("div",{className:"empty-init-cards-item-bg"}))}),o.a.createElement(gc,{trigger:o.a.createElement("div",{className:"empty-init-cards-item ".concat(g?"disabled":""),onClick:function e(){t.onNewFile()}},o.a.createElement("div",null,o.a.createElement(d.Button.Icon,{name:"plus",type:"primary",disabled:g})),o.a.createElement("div",{className:"content"},o.a.createElement("div",{className:"title"},"\u65b0\u5efa\u6587\u4ef6"),o.a.createElement("div",{className:"desc"},"\u5353\u8d8a\u7684\u4ee3\u7801\uff0c\u4ece\u7b2c\u4e00\u4e2a\u6587\u4ef6\u5f00\u59cb")),o.a.createElement("div",{className:"empty-init-cards-item-bg"}))}),o.a.createElement(gc,{trigger:o.a.createElement("div",{className:"empty-init-cards-item ".concat(g?"disabled":""),onClick:this.showUploadFile},o.a.createElement("div",null,o.a.createElement(d.Button.Icon,{name:"plus",type:"primary",disabled:g})),o.a.createElement("div",{className:"content"},o.a.createElement("div",{className:"title"},"\u4e0a\u4f20\u6587\u4ef6"),o.a.createElement("div",{className:"desc"},"\u6781\u901f\u4e0a\u4f20\u672c\u5730\u6587\u4ef6")),o.a.createElement("div",{className:"empty-init-cards-item-bg"}))}))),o.a.createElement("div",{className:"empty-wrapper"},o.a.createElement("h3",{className:"empty-title mt40"},Ze.a.projects_overview_command_title),o.a.createElement("div",{className:"git-empty"},o.a.createElement("div",{className:"title"},"\u4e3a\u4e86\u6807\u8bc6\u8eab\u4efd\uff0c\u5efa\u8bae\u5148\u5b8c\u6210 Git \u5168\u5c40\u8bbe\u7f6e"),o.a.createElement("pre",{className:"light-well way-content user-info"},"git config --global user.name ",'"'.concat(yc.nickname,'"'),o.a.createElement("br",null),"git config --global user.email ",'"'.concat(m,'"')),o.a.createElement("div",{className:"way-one way"},o.a.createElement(d.Button,{type:"normal",text:!0,color:"gray",onClick:function e(){t.toggleKeys("one")}},o.a.createElement(Z.a,{type:s.includes("one")?"triangle-down-s":"triangle-right-s",style:{marginRight:8}}),o.a.createElement("span",null,"\u65b9\u5f0f\u4e00\uff1a\u514b\u9686\u4ed3\u5e93"))),o.a.createElement("pre",{className:"light-well way-content",style:{display:s.includes("one")?"block":"none"}},"git clone ",o.a.createElement("span",{className:"clone"},h),o.a.createElement("br",null),"cd ",c,o.a.createElement("br",null),"touch README.md",o.a.createElement("br",null),"git add README.md",o.a.createElement("br",null),"git commit -m ",'"add README"',o.a.createElement("br",null),"git push -u origin master"),o.a.createElement("div",{className:"way-two way"},o.a.createElement(d.Button,{type:"normal",text:!0,color:"gray",onClick:function e(){t.toggleKeys("two")}},o.a.createElement(Z.a,{type:s.includes("two")?"triangle-down-s":"triangle-right-s",style:{marginRight:8}}),o.a.createElement("span",null,"\u65b9\u5f0f\u4e8c\uff1a\u5df2\u6709\u6587\u4ef6\u5939\u6216\u4ed3\u5e93"))),o.a.createElement("pre",{className:"light-well way-content",style:{display:s.includes("two")?"block":"none"}},"cd existing_folder",o.a.createElement("br",null),"git init",o.a.createElement("br",null),"git remote add origin ",o.a.createElement("span",{className:"clone"},h),o.a.createElement("br",null),"git add .",o.a.createElement("br",null),"git commit",o.a.createElement("br",null),"git push -u origin master"),o.a.createElement("div",{className:"way-two way"},o.a.createElement(d.Button,{type:"normal",text:!0,color:"gray",onClick:function e(){t.toggleKeys("three")}},o.a.createElement(Z.a,{type:s.includes("three")?"triangle-down-s":"triangle-right-s",style:{marginRight:8}}),o.a.createElement("span",null,"\u65b9\u5f0f\u4e09\uff1a\u5bfc\u5165\u4ee3\u7801\u5e93"))),o.a.createElement("pre",{className:"light-well way-content",style:{display:s.includes("three")?"block":"none"}},"git clone --bare https://git.example.com/your/project.git your_path",o.a.createElement("br",null),"cd your_path",o.a.createElement("br",null),"git remote set-url origin"," ",o.a.createElement("span",{className:"clone"},h),o.a.createElement("br",null),"git push --mirror")),o.a.createElement("div",{className:"empty-more"},"\u9700\u8981\u66f4\u591a\u529f\u80fd\u8bf4\u660e\u548c Git \u6559\u7a0b\uff1f\u8bf7\u53c2\u770b "," ",o.a.createElement("a",{href:Object(dt.a)("Git\u6559\u5b66-\u5feb\u901f\u4e0a\u624b"),target:"blank"},"\u5e2e\u52a9\u624b\u518c"))),p?o.a.createElement(xt,tc({},this.props,{closeModal:this.onDialogClose,isDialogVisible:p})):null)}}]),n}(r.Component);function Ec(e){return(Ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function wc(){return(wc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Oc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sc(e,t,n){return t&&jc(e.prototype,t),n&&jc(e,n),e}function _c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pc(e,t)}function Pc(e,t){return(Pc=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Rc(e){var t=Nc();return function n(){var r=kc(e),o;if(t){var a=kc(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Tc(this,o)}}function Tc(e,t){return!t||"object"!==Ec(t)&&"function"!=typeof t?Cc(e):t}function Cc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nc(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function kc(e){return(kc=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Ic(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xc=d.Balloon.Tooltip,Bc=window.FORCE,Lc=Bc.pathResource,Dc=Bc.resourceSubject,Fc=function(e){_c(n,e);var t=Rc(n);function n(e){var r;return Oc(this,n),Ic(Cc(r=t.call(this,e)),"getBlob",(function(e,t){var n=r.props.resourcePath;p.a.forceFetch({api:"projects.blobs",params:{projectId:Lc.id},data:{filepath:e||n,ref:"branch"===Dc.revisionType?"refs/heads/".concat(Dc.revision):Dc.revision}}).then((function(e){r.setState({blob:e}),t&&t(e)}))})),Ic(Cc(r),"editFile",(function(e,t){var n=r.props.resourcePath,o=Dc.revision||"master",a=e.branch_name,i=e.content,c=e.task_ids,l=r.field.getValue("file_path"),u=n.split("/"),s=u.slice(0,u.length-1).join("/"),f=s?"".concat(s,"/").concat(l):l,m=n;return p.a.fetch({api:"projects.files.edit.associateTask",data:{project_id:Lc.id,task_ids:c,new_path:f,old_path:m,commit_message:t,branch_name:a,content:i}}).then((function(){d.Toast.success({title:"\u63d0\u4ea4\u6210\u529f"}),r.props.updateData({hasPush:!0}),window.onbeforeunload=null,Object(Fe.d)("/".concat(Lc.fullPath,"/blob/").concat(J.b.revisionEncodeURI(o),"/").concat(J.b.filepathEncodeURI(f)),{state:{forceUpdate:!0}}),r.setState({submitting:!1})})).fail((function(){r.setState({submitting:!1})}))})),Ic(Cc(r),"onFormSave",(function(){var e=r.props.resourcePath;r.field.validate((function(t){if(t)t.file_path&&(d.Toast.error({title:t.file_path.errors[0]}),r.setState({submitting:!1}));else{if(r.state.submitting)return;r.setState({submitting:!0});var n=r.field.getValues(),o=n.commit_message_content?"".concat(n.commit_message_title,"\n").concat(n.commit_message_content):n.commit_message_title;n.file_path=e,r.state.task_ids&&(n.task_ids=r.state.task_ids),r.editFile(n,o)}}))})),Ic(Cc(r),"cancleConfirm",(function(){var e=r.props.resourcePath,t=Dc.revision||"master";if(r.confirmResult=window.confirm("\u60a8\u6b63\u5728\u7f16\u8f91\u6587\u4ef6\uff0c\u662f\u5426\u786e\u8ba4\u79bb\u5f00\uff1f"),!r.confirmResult)return!1;window.onbeforeunload=null,Object(Fe.d)("/".concat(Lc.fullPath,"/blob/").concat(J.b.revisionEncodeURI(t),"/").concat(e),{state:{forceUpdate:!0}})})),Ic(Cc(r),"onOpen",(function(){r.field.validate((function(e){e||r.setState({visible:!0})}))})),Ic(Cc(r),"onClose",(function(){r.setState({visible:!1})})),Ic(Cc(r),"nameValidator",(function(e,t,n){var o=r.props.resourcePath,a=o.split("/"),i=a.slice(0,a.length-1).join("/"),c="".concat(i).concat(i&&"/").concat(t),l=o,u=r.state.existFileList;t?!1!==/^(?!(\/)).+$/.test(t)?new RegExp("^[\\u4e00-\\u9fa5a-z A-Z0-9_\\-\\.\\/]*$").test(t)?(u.forEach((function(e){c===e.path&&c!==l&&n("\u6587\u4ef6\u5df2\u5b58\u5728")})),n()):n('\u540d\u79f0\u53ea\u80fd\u5305\u542b\u4e2d\u82f1\u6587\u3001\u6570\u5b57\u3001"_"\u3001"-"\u3001"."\u4ee5\u53ca\u7a7a\u683c'):n("\u6587\u4ef6\u4e0d\u80fd\u76f4\u63a5\u4ee5 / \u5f00\u5934"):n()})),r.field=new d.Field(Cc(r)),r.state={visible:!1,blob:" ",submitting:!1,existFileList:[],task_ids:""},r}return Sc(n,[{key:"componentDidMount",value:function e(){var t=this;this.getBlob(null,(function(e){var n=e;e.statusText&&!e.responseText&&(n=""),t.field.setValue("content",n)})),window.onbeforeunload=function(){return"\u786e\u5b9a\u79bb\u5f00\u6b64\u9875\u9762\uff1f"},"true"!==window.FORCE.pathResource.isEmpty&&Object(q.n)().then((function(e){e.shift(),t.setState({existFileList:e})})).catch((function(e){console.log(e)}))}},{key:"render",value:function e(){var t=this,n=this.props.resourcePath,r=Dc.revision||"master",a=n.split("/"),i=a.slice(0,a.length-1).join("/"),c=a[a.length-1],l=this.field.init,u=this.state.blob,s=this.field.getValue("file_path"),f=i&&i.split("/").join(" / ");return o.a.createElement("div",{className:"project-new-files"},o.a.createElement(Br.a,null,o.a.createElement(Br.a.Header,null,f&&o.a.createElement("span",{style:{marginRight:16}},f&&"".concat(f," /")),o.a.createElement(d.Input,wc({placeholder:Ze.a.filename_placeholder},l("file_path",{initValue:c,rules:[{required:!0,message:Ze.a.file_name_required},{validator:this.nameValidator}]}),{style:{width:"300px"}})),o.a.createElement("span",{style:{margin:"4px 0px 4px 8px",fontSize:"14px",color:"#e62412"}},"error"===this.field.getState("file_path")?this.field.getError("file_path"):null)),o.a.createElement(Br.a.Body,{noPadding:!0},o.a.createElement(Bi.a,wc({},l("content",{initValue:u}),{fileName:c,autoFocus:!0})),o.a.createElement("div",{style:{margin:"20px 0"}},o.a.createElement(d.Button,{disabled:null===this.field.getValue("file_path")||"error"===this.field.getState("file_path"),type:"primary",onClick:this.onOpen},"\u4fdd\u5b58"),o.a.createElement(d.Button,{onClick:this.cancleConfirm,style:{marginLeft:16},type:"normal"},"\u53d6\u6d88"),o.a.createElement(d.Dialog,{title:o.a.createElement(xc,{trigger:o.a.createElement("div",{className:"file-form-title"},"\u63d0\u4ea4\u5230 ",r),align:"t"},o.a.createElement("span",{style:{wordBreak:"break-all"}},"\u63d0\u4ea4\u5230 ",r)),visible:this.state.visible,onOk:this.onFormSave,onCancel:this.onClose,onClose:this.onClose,style:{width:"600px"},okProps:{children:"\u63d0\u4ea4",loading:this.state.submitting},cancelProps:{children:"\u53d6\u6d88"}},o.a.createElement(pt,{field:this.field,defaultCommitMsg:"\u66f4\u65b0 ".concat(s)}),ee.a?null:o.a.createElement(mt.a,{useBy:"submit",onChange:function e(n){if(n.map){var r=n.map((function(e){return e._id}));t.setState({task_ids:r.join(",")})}}}))))))}}]),n}(o.a.Component),Mc=n(1452),Uc=n(14);function Ac(e){return(Ac="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Vc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vc(Object(n),!0).forEach((function(t){el(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kc(){return(Kc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Hc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xc(e,t,n){return t&&Wc(e.prototype,t),n&&Wc(e,n),e}function qc(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jc(e,t)}function Jc(e,t){return(Jc=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Gc(e){var t=$c();return function n(){var r=Qc(e),o;if(t){var a=Qc(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Yc(this,o)}}function Yc(e,t){return!t||"object"!==Ac(t)&&"function"!=typeof t?Zc(e):t}function Zc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Qc(e){return(Qc=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function el(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tl=u.a.getOSKeyMap(),nl=tl.ctrlKey,rl=tl.ctrlTxt,ol=function(e){qc(n,e);var t=Gc(n);function n(){var e;Hc(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return el(Zc(e=t.call.apply(t,[this].concat(a))),"state",{isShowSearch:!1,filterText:"",isDialogVisible:!1,filePath:""}),el(Zc(e),"onDialogOpen",(function(){e.setState({isDialogVisible:!0})})),el(Zc(e),"onDialogClose",(function(){e.setState({isDialogVisible:!1})})),el(Zc(e),"handleKeyCodeEvent",(function(t){var n=e.props.isNavHidden;if(t[nl]&&t.keyCode===Uc.a.B){if(!e.projectNav||!e.layoutBottom)return!1;var r=e.projectNav.style.width;n?(e.projectNav.style.transform="translateX(0)",e.layoutBottom.style.left=r,e.layoutBottom.style.width="calc(100% - ".concat(r,")")):(e.projectNav.style.transform="translateX(-".concat(r,")"),e.layoutBottom.style.left="0px",e.layoutBottom.style.width="100%"),e.props.updateData({isNavHidden:!n})}t[nl]&&t.keyCode===Uc.a.SPLIT&&e.toggleInput(!0)})),el(Zc(e),"getProjectInfoFromPageInfo",(function(){var t=e.props.pageInfo||{},n=t.pathResource,r=t.resourceSubject,o="true"===n.isExist,a;return{isEmpty:"true"===n.isEmpty,isExist:o,role:n.role,pathResource:n,resourceSubject:r,repoSize:Number(n.repoSize),repoLimitSize:Number(n.repoLimitSize)}})),el(Zc(e),"onTooLargeTipMessageClose",(function(){J.b.setCachedData("project-too-large-message","close")})),el(Zc(e),"renderContent",(function(){var t=e.props,n=t.selectedType,r=t.lastCommit,a=t.resourceType,i=t.isLoadingLastCommit,c=t.projectInfo;return"tree"===n?o.a.createElement(di,null):"blob"===n?o.a.createElement("div",{className:"project-file-content-body"},o.a.createElement("div",{className:"overview-info"},o.a.createElement(Va,e.props),o.a.createElement(Ee,e.props)),o.a.createElement("div",{className:"file-commit-container"},o.a.createElement(Sa.a,{isLoading:i,commitInfo:r,noBuildTag:!0})),o.a.createElement("div",{className:"project-file-content-blob"},o.a.createElement(ja,Kc({},e.props,{resourcePath:J.b.filepathEncodeURI(e.props.resourcePath)})))):"new"===n?o.a.createElement("div",null,o.a.createElement(Qi,e.props)):"edit"===n?o.a.createElement("div",null,o.a.createElement(Fc,e.props)):""!==n?null:o.a.createElement(o.a.Fragment,null,o.a.createElement(pn,e.props),o.a.createElement("div",{className:"project-file-content-body"},o.a.createElement("div",{className:"file-commit-container"},o.a.createElement(Sa.a,{commitInfo:r,isLoading:i,projectInfo:c})),o.a.createElement("div",{className:"project-file-content-blob"},"blob"===a?o.a.createElement(ja,Kc({},e.props,{resourcePath:J.b.filepathEncodeURI(e.props.resourcePath)})):o.a.createElement(xi,e.props))))})),el(Zc(e),"goNew",(function(){var t=e.getProjectInfoFromPageInfo(),n=t.resourceSubject,r=t.pathResource,o=n.revision||"master";Object(Fe.d)("/".concat(r.fullPath,"/new/").concat(J.b.revisionEncodeURI(o),"?isMaster=1")),e.props.updateSetSelectedType({resourceSubject:{subject:"new",path:""}})})),el(Zc(e),"toggleInput",(function(t){t?e.setState({isShowSearch:t}):e.setState({isShowSearch:t,filterText:""}),e.setState({isShowSearch:t})})),el(Zc(e),"changeFilterText",(function(t){e.setState({filterText:t.trim()})})),el(Zc(e),"handleToggleLeftNav",(function(){var t=e.props.isNavHidden;if(!e.projectNav||!e.layoutBottom)return!1;var n=e.projectNav.style.width;t?(e.projectNav.style.transform="translateX(0)",e.layoutBottom.style.left=n,e.layoutBottom.style.width="calc(100% - ".concat(n,")")):(e.projectNav.style.transform="translateX(-".concat(n,")"),e.layoutBottom.style.left="0px",e.layoutBottom.style.width="100%"),e.props.updateData({isNavHidden:!t})})),el(Zc(e),"handleChangeBranch",(function(t){var n=e.getProjectInfoFromPageInfo(),r=n.pathResource,o=n.resourceSubject,a=e.props.resourceType,i=J.b.revisionEncodeURI(t);if(-1!==window.location.pathname.indexOf("/".concat(r.fullPath,"/").concat(a,"/").concat(o.revision))){var c=window.location.pathname.replace("/".concat(r.fullPath,"/").concat(a,"/").concat(o.revision),"/".concat(r.fullPath,"/").concat(a,"/").concat(i));p.a.fetch({api:"spa.path",data:{path:c}}).then((function(e){e.success?Object(Fe.d)(c,{state:{forceUpdate:!0}}):Object(Fe.d)("/".concat(r.fullPath,"/tree/").concat(i),{state:{forceUpdate:!0}})})).fail((function(){Object(Fe.d)("/".concat(r.fullPath,"/tree/").concat(i),{state:{forceUpdate:!0}})}))}else Object(Fe.d)("/".concat(r.fullPath,"/tree/").concat(i),{state:{forceUpdate:!0}})})),el(Zc(e),"mouseDownMoveLine",(function(){if(!e.projectNav)return!1;e.projectNav.style.transition="unset",document.addEventListener("mousemove",e.handleMouseMove),document.addEventListener("mouseup",e.mouseUpMoveLine)})),el(Zc(e),"mouseUpMoveLine",(function(){if(!e.projectNav)return!1;e.projectNav.style.transition="ease-in 300ms",document.removeEventListener("mouseup",e.mouseUpMoveLine),document.removeEventListener("mousemove",e.handleMouseMove)})),el(Zc(e),"handleMouseMove",(function(t){if(t.preventDefault(),t.stopPropagation(),!e.projectNav||!e.layoutBottom)return!1;var n=t.pageX;return n<207&&(n=207),e.projectNav.style.width="".concat(n,"px"),e.layoutBottom.style.left="".concat(n,"px"),e.layoutBottom.style.width="calc(100% - ".concat(n,"px)"),!1})),e}return Xc(n,[{key:"componentDidMount",value:function e(){var t=this,n=this.props.selectedType,r=window.FORCE.resourceSubject,o=void 0===r?{}:r,a=o.revisionType,i=o.revision;"branch"===a&&this.props.getProtectedBranchInfo(i),this.props.getServiceSettings((function(){"blob"===n&&t.props.getBlobAndCommitWithPath()})),document.addEventListener("keydown",this.handleKeyCodeEvent),this.layoutBottom=document.querySelector(".layout-bottom")}},{key:"componentWillUnmount",value:function e(){document.removeEventListener("keydown",this.handleKeyCodeEvent),document.removeEventListener("mousedown",this.mouseDownMoveLine),document.removeEventListener("mouseup",this.mouseUpMoveLine),document.removeEventListener("mousemove",this.handleMouseMove),this.projectNav&&(this.projectNav.style.transform="translateX(0)"),this.layoutBottom&&(this.layoutBottom.style.left=0,this.layoutBottom.style.width="auto")}},{key:"componentDidUpdate",value:function e(t){"blob"===this.props.selectedType&&t.resourcePath!==this.props.resourcePath&&this.props.getBlobAndCommitWithPath()}},{key:"render",value:function e(){var t=this,n=this.getProjectInfoFromPageInfo(),r=n.isEmpty,a=n.repoSize,i=n.repoLimitSize,c=this.props,l=c.isNavHidden,u=c.selectedType,s=this.state.filePath;if(r&&!u)return o.a.createElement("div",null,o.a.createElement(pn,Kc({isEmptyProject:!0},this.props)),o.a.createElement(vc,this.props),o.a.createElement(h.a,{page:"Repo-Files"}));var f=a>=i;return o.a.createElement("div",{className:"project-file-wrapper"},!r&&o.a.createElement(o.a.Fragment,null,l?o.a.createElement(d.Balloon.Tooltip,{align:"r",trigger:o.a.createElement("div",{className:"nav-hide-fix-icon ".concat(l?"flex":"hide"),onClick:this.handleToggleLeftNav},o.a.createElement(Z.a,{type:"sidebar-arrow-right",size:"small",biz:"code"}))},"\u5c55\u5f00",o.a.createElement("br",null),rl," + B"):null,o.a.createElement("div",{className:"project-nav",ref:function e(n){t.projectNav=n},style:{width:"300px",top:f?"131px":"92px",minHeight:"calc(100% - 40px)"}},o.a.createElement("div",{className:"project-nav-move-line",onMouseDown:this.mouseDownMoveLine},o.a.createElement("div",null)),l?null:o.a.createElement(d.Balloon.Tooltip,{align:"r",trigger:o.a.createElement("div",{className:"project-nav-fix-icon",onClick:this.handleToggleLeftNav},o.a.createElement(Z.a,{type:"sidebar-arrow-left",size:"small",biz:"code"}))},"\u6536\u8d77",o.a.createElement("br",null),rl," + B"),o.a.createElement("div",{className:"project-nav-line"}),o.a.createElement("div",{className:"project-nav-top",style:{display:"true"===window.FORCE.pathResource.isEmpty?"none":"flex"}},this.state.isShowSearch?o.a.createElement("div",{style:{display:"flex",alignItems:"center"}},o.a.createElement(d.Search,{autoFocus:!0,placeholder:"\u641c\u7d22",value:this.state.filterText,onChange:this.changeFilterText,className:"project-nav-top-search-input"}),o.a.createElement(d.Button,{type:"primary",size:"small",text:!0,onClick:function e(){t.toggleInput(!1)}},"\u53d6\u6d88")):o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,o.a.createElement(Mc.a,Kc({},this.props,{onChange:this.handleChangeBranch}))),o.a.createElement("div",{style:{display:"flex",alignItems:"center"}},o.a.createElement(d.Balloon.Tooltip,{align:"t",trigger:o.a.createElement(d.Button.Icon,{type:"primary",name:"search",color:"gray",onClick:function e(){t.toggleInput(!0)},className:"file-icon-margin-left"})},"\u641c\u7d22\u6587\u4ef6",o.a.createElement("br",null)," ",rl," + /"),o.a.createElement(Pn,Kc({onUploadDialogOpen:function e(){t.setState({filePath:""},(function(){t.onDialogOpen()}))}},this.props)),this.state.isDialogVisible?o.a.createElement(xt,Kc({},this.props,{resourcePath:s||this.props.resourcePath,closeModal:function e(){t.setState({filePath:""}),t.onDialogClose()},isMaster:s?0:1,isDialogVisible:this.state.isDialogVisible})):null))),o.a.createElement("div",{className:"project-nav-tree",style:{height:"calc(100% - ".concat(f?"145":"103","px)")}},this.state.isShowSearch?o.a.createElement(xr,Kc({},this.props,{filterText:this.state.filterText})):o.a.createElement(pr,Kc({},this.props,{projectNav:this.projectNav,isUploadDialogVisible:this.state.isDialogVisible,onUploadDialogOpen:function e(n){t.setState({filePath:n},(function(){t.setState({isDialogVisible:!0})}))}}))))),o.a.createElement("div",{className:r?"project-content":"project-file-content"},this.renderContent()),o.a.createElement(h.a,{page:"Repo-Files"}))}}]),n}(o.a.Component);el(ol,"propTypes",{blob:y.a.arrayOf(y.a.object)}),el(ol,"defaultProps",{blob:[]});var al=Object(c.connect)((function(e){return zc(zc({},e.project.projectFiles),{},{projectInfo:e.project.root.projectInfo,pageInfo:e.root.pageInfo})}),(function(e){return Object(l.bindActionCreators)(s,e)}))(ol),il=n(1501);function cl(e){return(cl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function ll(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ul(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sl(e,t,n){return t&&ul(e.prototype,t),n&&ul(e,n),e}function fl(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pl(e,t)}function pl(e,t){return(pl=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function ml(e){var t=hl();return function n(){var r=bl(e),o;if(t){var a=bl(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return yl(this,o)}}function yl(e,t){return!t||"object"!==cl(t)&&"function"!=typeof t?dl(e):t}function dl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function bl(e){return(bl=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function gl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vl=function(e){fl(n,e);var t=ml(n);function n(){return ll(this,n),t.apply(this,arguments)}return sl(n,[{key:"render",value:function e(){var t=this,n=window.FORCE.pathResource.role,r=Object(f.a)(u.d,n),a=this.props.projectInfo.import_from_svn;return o.a.createElement("div",{className:"project-importing"},o.a.createElement(d.Loading,null),o.a.createElement("div",{className:"project-importing-placeholder"},o.a.createElement("img",{src:"https://img.alicdn.com/tfs/TB1Ci5nmBr0gK0jSZFnXXbRRXXa-800-576.png"})),o.a.createElement("div",{className:"waiting-text"},a?"\u4ee3\u7801\u5e93\u5bfc\u5165\u4e2d\uff0cSVN \u5e93\u5bfc\u5165\u6839\u636e\u5e93\u5927\u5c0f\u9884\u8ba1\u8017\u65f6\u4ece\u51e0\u5206\u949f\u81f3\u51e0\u5c0f\u65f6\u4e0d\u7b49\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\u2026":"\u4ee3\u7801\u5e93\u5bfc\u5165\u4e2d\uff0c\u9884\u8ba1\u8017\u65f6\u51e0\u5206\u949f\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\u2026"),r&&o.a.createElement("div",{className:"stop-import-btn"},o.a.createElement(d.Balloon.Tooltip,{align:"b",trigger:o.a.createElement(d.Button,{type:"normal",warning:!0,style:{marginTop:24},onClick:function e(){t.props.stopImportProject(),Object(h.b)({action:"cancel_import",page:"Repo-Importing",type:"import by URL",control:""})}},this.props.isStoppingImport?o.a.createElement("span",null,o.a.createElement(Z.a,{type:"loading"}),"\u7ec8\u6b62\u5bfc\u5165\u4e2d"):"\u7ec8\u6b62\u5bfc\u5165")},"\u70b9\u51fb\u540e\u5bfc\u5165\u5c06\u4f1a\u5931\u8d25\uff0c\u8bf7\u8c28\u614e\u64cd\u4f5c")))}}]),n}(o.a.Component);gl(vl,"propTypes",{stopImportProject:y.a.func,isStoppingImport:y.a.bool}),gl(vl,"defaultProps",{stopImportProject:function e(){},isStoppingImport:!1});var El=n(53);function wl(e){return(wl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Ol(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sl(e,t,n){return t&&jl(e.prototype,t),n&&jl(e,n),e}function _l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pl(e,t)}function Pl(e,t){return(Pl=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Rl(e){var t=Nl();return function n(){var r=kl(e),o;if(t){var a=kl(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Tl(this,o)}}function Tl(e,t){return!t||"object"!==wl(t)&&"function"!=typeof t?Cl(e):t}function Cl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function kl(e){return(kl=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Il(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var xl=J.b.getUrlSearchParam("namespace_id"),Bl=function(e){_l(n,e);var t=Rl(n);function n(){var e;Ol(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Il(Cl(e=t.call.apply(t,[this].concat(o))),"state",{isUrlImportModalShow:!1}),Il(Cl(e),"closeUrlModal",(function(){e.setState({isUrlImportModalShow:!1})})),e}return Sl(n,[{key:"render",value:function e(){var t=this,n=this.state.isUrlImportModalShow,r=this.props,a=r.removeProject,i=r.initEmptyProject,c=r.projectInfo,l=r.getProjectInfo,s=r.isInittingImport,p=r.isRemovingProject,m=r.setImportStatus,y=window.FORCE.pathResource.role,b=Object(f.a)(u.d,y),g=Object(f.a)(u.e,y),v=[b||g?o.a.createElement(d.Button,{type:"primary",onClick:function e(){t.setState({isUrlImportModalShow:!0}),Object(h.b)({action:"retry_import",page:"Repo-Importing",type:"import by URL",control:""})}},"\u91cd\u8bd5\u5bfc\u5165"):null,b||g?o.a.createElement(d.Button,{type:"normal",onClick:function e(){i(),Object(h.b)({action:"new_repo",page:"Repo-Importing",type:"import by URL",control:""})},loading:s},"\u521d\u59cb\u5316\u7a7a\u5e93"):null,b?o.a.createElement(d.Button,{type:"normal",warning:!0,onClick:function e(){a(),Object(h.b)({action:"delete_repo",page:"Repo-Importing",type:"import by URL",control:""})},loading:p},"\u5220\u9664\u4ee3\u7801\u5e93"):null];return o.a.createElement("div",{className:"import-failed-page"},o.a.createElement(mr.a,{content:"\u5bfc\u5165\u5931\u8d25",size:"large",imgType:"fail",description:o.a.createElement("div",{style:{width:320}},o.a.createElement("div",null,"\u5bfc\u5165\u5931\u8d25\u53ef\u80fd\u7684\u539f\u56e0\u53ca\u89e3\u51b3\u65b9\u6848\uff1a",o.a.createElement("br",null),"1.\u8def\u5f84\u4e0d\u5b58\u5728\uff1b",o.a.createElement("br",null),"2.\u5e10\u53f7\u6216\u5bc6\u7801\u4e0d\u6b63\u786e\uff1b",o.a.createElement("br",null),"3.\u7f51\u7edc\u4e0d\u901a\uff1b",o.a.createElement("br",null),"4.\u5bfc\u5165\u8d85\u65f6\uff1b",o.a.createElement("br",null)),o.a.createElement("br",null),o.a.createElement("div",null,"\u5982\u60a8\u786e\u8ba4\u7ee7\u7eed\u5bfc\u5165\uff0c\u5efa\u8bae\u5148\u5728\u672c\u5730\u5c1d\u8bd5\u514b\u9686\uff0c\u4ee5\u68c0\u67e5\u5e93\u8def\u5f84\u3001\u5e10\u53f7\u53ca\u5bc6\u7801\u662f\u5426\u6b63\u786e\uff1b\u5982\u56e0\u7f51\u7edc\u539f\u56e0\u5bfc\u81f4\u7684\u65e0\u6cd5\u8fde\u901a\u6216\u5bfc\u5165\u8d85\u65f6\uff0c\u5efa\u8bae\u5728\u521d\u59cb\u5316\u7a7a\u5e93\u540e\uff0c\u5728\u672c\u5730\u8fdb\u884c\u63a8\u9001\u3002")),btns:v}),n&&o.a.createElement(El.a,{defaultNamespaceId:xl,closeModal:function e(){t.closeUrlModal()},type:"retry",projectInfo:c,isModalOpen:n,retryCallback:function e(){m("started"),l()}}))}}]),n}(o.a.Component);Il(Bl,"propTypes",{removeProject:y.a.func,initEmptyProject:y.a.func,projectInfo:y.a.object,getProjectInfo:y.a.func}),Il(Bl,"defaultProps",{removeProject:function e(){},initEmptyProject:function e(){},projectInfo:{},getProjectInfo:function e(){}});var Ll=n(103),Dl=n(55),Fl=n(1514);function Ml(e){return(Ml="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Ul(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Al(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ul(Object(n),!0).forEach((function(t){Zl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ul(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kl(e,t,n){return t&&zl(e.prototype,t),n&&zl(e,n),e}function Hl(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wl(e,t)}function Wl(e,t){return(Wl=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Xl(e){var t=Gl();return function n(){var r=Yl(e),o;if(t){var a=Yl(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return ql(this,o)}}function ql(e,t){return!t||"object"!==Ml(t)&&"function"!=typeof t?Jl(e):t}function Jl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gl(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Yl(e){return(Yl=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Zl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $l=["REPORTER","ORG_MEMBER","DEVELOPER","MASTER","OWNER","ORG_ADMIN","ORG_OWNER","ADMIN"],Ql={started:"started",none:"none",finished:"finished",failed:"failed",stopping:"stopping"},eu=function(e){Hl(n,e);var t=Xl(n);function n(){var e;Vl(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return Zl(Jl(e=t.call.apply(t,[this].concat(a))),"importTimer",null),Zl(Jl(e),"handleProjectExist",(function(){var t=e.getProjectInfoFromPageInfo(),n=t.isEmpty,r;t.isExist&&e.getViewAuth()&&(!n&&e.initLeftTree(),n&&e.props.updateData({isInitedLeftTree:!0}),!n&&e.props.getIpWhiteList(),e.props.getCloneDownloadSetting())})),Zl(Jl(e),"openTimer",(function(){var t;["started","stopping"].includes(e.props.projectInfo.import_status)?(clearInterval(e.importTimer),e.importTimer=setInterval((function(){e.props.getParentProjectInfo()}),3e3)):clearInterval(e.importTimer)})),Zl(Jl(e),"getProjectInfoFromPageInfo",(function(){var t,n=(e.props.pageInfo||{}).pathResource,r="true"===n.isExist,o;return{isEmpty:"true"===n.isEmpty,isExist:r,role:n.role}})),Zl(Jl(e),"initLeftTree",(function(){var t=e.props,n=t.filesViewType,r=t.resourceType,o=t.getInitTreeData,a=t.getRightTreeData,i=t.resourcePath,c=i.split("/"),l=c[c.length-1];if("tree"===n){var u="blob"===r?i.replace("/".concat(l),""):i;u&&a(i),o(u,(function(){!u&&a(i)}))}e.props.getAllFiles()})),Zl(Jl(e),"getViewAuth",(function(){var t=e.props.projectInfo,n,r=e.getProjectInfoFromPageInfo().role,o=Object(f.a)($l,r),a=!0,i;return u.a.visibility_level_text[t.visibility_level]&&"private"!==u.a.visibility_level_text[t.visibility_level]&&(a=!1),o||!a})),Zl(Jl(e),"renderProjectFileJsx",(function(){var t=e.props,n=t.projectInfo,r=t.stopImportProject,a=t.isStoppingImport,i=t.getParentProjectInfo,c=t.isInittingImport,l=t.isRemovingProject,u=e.getProjectInfoFromPageInfo(),s=u.isEmpty,f=u.isExist;return[Ql.started,Ql.stopping].includes(n.import_status)?o.a.createElement(vl,{projectInfo:n,stopImportProject:r,isStoppingImport:a}):f?o.a.createElement("div",{style:s?{}:{left:"300px",width:"calc(100% - 300px)"},className:s?"project-content":"layout-bottom ".concat(e.props.isNavHidden?"no-nav":"")},o.a.createElement(al,null)):o.a.createElement(Bl,{removeProject:e.props.removeProject,initEmptyProject:e.props.initEmptyProject,projectInfo:n,getProjectInfo:i,isRemovingProject:l,isInittingImport:c,setImportStatus:Ll.setImportStatus})})),Zl(Jl(e),"renderLeadComponent",(function(){var e,t;if("5f7051259cffa29cfdd39e47"===window.FORCE.organization.organization_id&&!J.b.getCache("guide_1024",!1)){var n="mountLeadEl",r=document.getElementById(n);r||((r=document.createElement("div")).id=n,document.body.appendChild(r)),i.a.render(o.a.createElement(Fl.a,{onClose:function e(){J.b.setCache("guide_1024",!0,!1),i.a.unmountComponentAtNode(document.getElementById(n))}}),document.getElementById(n))}})),e}return Kl(n,[{key:"componentDidMount",value:function e(){var t=this;this.openTimer(),this.handleProjectExist(),ee.c&&(this.props.getHttpsAccount(),setTimeout((function(){t.renderLeadComponent()}),1e4)),Object(h.d)("Repo-Files",{sendPerf:!1})}},{key:"componentDidUpdate",value:function e(t){var n=["started","stopping"].includes(t.projectInfo.import_status),r=["started","stopping"].includes(this.props.projectInfo.import_status);"stopping"===t.projectInfo.import_status&&"stopping"!==this.props.projectInfo.import_status&&this.props.updateData({isStoppingImport:!1}),n&&!r&&(clearInterval(this.importTimer),"finished"===this.props.projectInfo.import_status&&d.Toast.success({title:"\u5bfc\u5165\u5b8c\u6210"}),this.handleProjectExist()),!n&&r&&this.openTimer()}},{key:"componentWillUnmount",value:function e(){clearInterval(this.importTimer),this.props.resetData()}},{key:"render",value:function e(){var t=this.props.isProjectInfoFetched,n=this.getViewAuth();return t?o.a.createElement(o.a.Fragment,null,n?this.renderProjectFileJsx():o.a.createElement(il.a,{pictureUrl:"https://img.alicdn.com/tfs/TB14JNzD1uSBuNjy1XcXXcYjFXa-700-700.png",title:"\u65e0\u8bbf\u95ee\u6743\u9650",desc:"\u8bf7\u8054\u7cfb\u5e93\u7ba1\u7406\u5458\u8fdb\u884c\u6dfb\u52a0"})):o.a.createElement("div",{className:"loading-project-info"},o.a.createElement(d.Loading,null))}}]),n}(r.Component),tu=Object(c.connect)((function(e){return Al(Al({},e.project.projectFiles),{},{projectInfo:e.project.root.projectInfo,isProjectInfoFetched:e.project.root.isProjectInfoFetched,pageInfo:e.root.pageInfo})}),(function(e){return Object(l.bindActionCreators)(Al(Al({},s),{},{getParentProjectInfo:Ll.getProjectInfo,updatePageInfo:Dl.updatePageInfo,resetIsProjectInfoFetched:Ll.resetIsProjectInfoFetched,setImportStatus:Ll.setImportStatus}),e)}))(eu),nu=n(1621),ru=t.default=tu}}]);
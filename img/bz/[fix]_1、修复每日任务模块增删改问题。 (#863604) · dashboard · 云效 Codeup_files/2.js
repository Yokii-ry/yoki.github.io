(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1455:function(e,t,n){"use strict";n.d(t,"a",(function(){return Mn}));var r=n(0),o=n.n(r),a=n(16),i=n.n(a),c=n(3),l=n.n(c),u=n(7),s=n(1),f=n(291),m=n.n(f),p=n(10),d=n(166),y=n.n(d),h=n(11),b=n(1464),g=n(1523),v=n(21),w=n(2),E=n(1546),O=n(8),_=n(1525);function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function C(e){return I(e)||k(e)||P(e)||j()}function j(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function P(e,t){if(e){if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(e,t):void 0}}function k(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function I(e){if(Array.isArray(e))return N(e)}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t,n){return t&&B(e.prototype,t),n&&B(e,n),e}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}function L(e,t){return(L=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function D(e){var t=F();return function n(){var r=H(e),o;if(t){var a=H(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return A(this,o)}}function A(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?M(e):t}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var z=s.Overlay.Popup,G=function(e){x(n,e);var t=D(n);function n(){var e;R(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return U(M(e=t.call.apply(t,[this].concat(o))),"state",{showOverlay:!1,data:[]}),U(M(e),"toggleOverlay",(function(){var t=e.state.showOverlay;e.setState({showOverlay:!t})})),e}return T(n,[{key:"render",value:function e(){var t=this.state.data,n=this.props.itemType;return o.a.createElement(o.a.Fragment,null,t.map((function(e,t){return t<3?o.a.createElement(s.Balloon.Tooltip,{type:"primary",trigger:o.a.createElement("span",{className:"single-tag first ".concat(n," single-tag-outside")},e),align:"t"},e):null})),t.length>3&&o.a.createElement(z,{trigger:o.a.createElement("span",{className:"single-tag cursor"},o.a.createElement(O.a,{type:"more"})),triggerType:"click",wrapperClassName:"overlay-tags-wrapper",style:{padding:"12px"}},o.a.createElement("div",{className:"overlay-tags"},t.slice(3).map((function(e){return o.a.createElement(s.Balloon.Tooltip,{type:"primary",trigger:o.a.createElement("span",{className:"single-tag ".concat(n," single-tag-inside"),key:e},e),align:"t"},e)})))))}}],[{key:"getDerivedStateFromProps",value:function e(t){if(t.data)return{data:C(t.data)}}}]),n}(o.a.PureComponent);function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function V(e){return J(e)||K(e)||$(e)||W()}function W(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $(e,t){if(e){if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(e,t):void 0}}function K(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function J(e){if(Array.isArray(e))return Z(e)}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e,t,n){return t&&Q(e.prototype,t),n&&Q(e,n),e}function ee(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}function te(e,t){return(te=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function ne(e){var t=ae();return function n(){var r=ie(e),o;if(t){var a=ie(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return re(this,o)}}function re(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?oe(e):t}function oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ae(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ie(e){return(ie=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}U(G,"propTypes",{itemType:l.a.string}),U(G,"defaultProps",{itemType:""});var le=s.Overlay.Popup,ue=function(e){ee(n,e);var t=ne(n);function n(){var e;X(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return ce(oe(e=t.call.apply(t,[this].concat(o))),"state",{showOverlay:!1,tags:[]}),ce(oe(e),"toggleOverlay",(function(){var t=e.state.showOverlay;e.setState({showOverlay:!t})})),e}return Y(n,[{key:"render",value:function e(){var t=this.state.tags;return o.a.createElement(o.a.Fragment,null,t.map((function(e,t){return t<3?o.a.createElement("span",{className:"single-tag tag-single-tag-outside"},e):null})),t.length>3&&o.a.createElement(le,{trigger:o.a.createElement("span",{className:"single-tag cursor"},o.a.createElement(O.a,{type:"more"})),triggerType:"click",wrapperClassName:"overlay-tags-wrapper",style:{padding:"12px"}},o.a.createElement("div",{className:"overlay-tags"},t.slice(3).map((function(e){return o.a.createElement("span",{className:"single-tag single-tag-inside-label"},e)})))))}}],[{key:"getDerivedStateFromProps",value:function e(t){if(t.tags)return{tags:V(t.tags)}}}]),n}(o.a.PureComponent),se=n(38),fe=n(1526),me=n(23),pe=n(45),de=n.n(pe),ye=n(78),he=n.n(ye),be=n(94);function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function we(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ee(e,t,n){return t&&we(e.prototype,t),n&&we(e,n),e}function Oe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_e(e,t)}function _e(e,t){return(_e=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Se(e){var t=Pe();return function n(){var r=ke(e),o;if(t){var a=ke(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Ce(this,o)}}function Ce(e,t){return!t||"object"!==ge(t)&&"function"!=typeof t?je(e):t}function je(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var Ie=new he.a({highlight:function e(t,n){if(n&&de.a.getLanguage(n))try{return de.a.highlight(n,t).value}catch(e){return""}return""}}),Ne=function(e){Oe(n,e);var t=Se(n);function n(e){var r;return ve(this,n),(r=t.call(this,e)).state={isHover:!1},r}return Ee(n,[{key:"render",value:function e(){var t=this,n=this.props.comment,r=this.state.isHover,a=n.note,i=n.created_at,c=n.author,l=c?c.name:"";return o.a.createElement("div",{className:"item-detail",onMouseEnter:function e(){t.setState({isHover:!0})},onMouseLeave:function e(){t.setState({isHover:!1})}},o.a.createElement("div",{className:"name-time"},o.a.createElement("div",{className:"user-name"},o.a.createElement("span",null,l),o.a.createElement("span",{onClick:function e(r){r.stopPropagation(),t.props.replyFn&&t.props.replyFn(n)},className:"reply-btn",style:{display:r?"inline-block":"none"}},"\u56de\u590d")),o.a.createElement("div",{className:"comment-time"},u.b.getBeautyTime(i))),o.a.createElement("div",{className:"comment-note",dangerouslySetInnerHTML:{__html:Object(be.filterXSS)(Ie.render(a||""),{onIgnoreTagAttr:function e(t,n,r){return"".concat(n,"=").concat(r)}})}}))}}]),n}(o.a.PureComponent);function Re(e){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xe(e,t,n){return t&&Te(e.prototype,t),n&&Te(e,n),e}function Le(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&De(e,t)}function De(e,t){return(De=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Ae(e){var t=He();return function n(){var r=Ue(e),o;if(t){var a=Ue(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Me(this,o)}}function Me(e,t){return!t||"object"!==Re(t)&&"function"!=typeof t?Fe(e):t}function Fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function He(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ge=function(e){Le(n,e);var t=Ae(n);function n(){var e;Be(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return ze(Fe(e=t.call.apply(t,[this].concat(o))),"state",{isEditorShow:!1,replyComment:null}),ze(Fe(e),"showEditor",(function(t){e.setState({isEditorShow:!0,replyComment:t})})),ze(Fe(e),"hideEditor",(function(){e.setState({replyComment:null,isEditorShow:!1})})),ze(Fe(e),"onSubmit",(function(t){var n=e.state.replyComment,r=e.props.curCommitInfo;e.props.postInfo({note:t,parent_id:n?n.parent_id||n.id:"",sha:r.id},(function(){e.setState({isEditorShow:!1})}))})),e}return xe(n,[{key:"render",value:function e(){var t=this,n=this.state.replyComment,r=this.props.data;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"commit-comment-info-list-item"},o.a.createElement(s.Timeline,null,r.map((function(e){return o.a.createElement(s.Timeline.Item,{title:o.a.createElement(Ne,{comment:e,replyFn:t.showEditor}),dot:o.a.createElement(y.a,{text:e.author&&e.author.name||"",image:e.author&&e.author.avatar_url||"",radius:"50%",size:"xs"})})})))),this.state.isEditorShow?o.a.createElement(se.a,{onSubmitImmediate:this.onSubmit,onCancel:this.hideEditor,placeholder:"\u8bf7\u8f93\u5165\u8bc4\u8bba",submitBtnText:"\u4fdd\u5b58\u4e3a\u8349\u7a3f",useInLog:!0,initValue:n&&n.author?"@".concat(n.author.name," "):""}):null)}}]),n}(r.Component);ze(Ge,"propTypes",{}),ze(Ge,"defaultProps",{});var qe=n(6),Ve=n(1598),We=n(9);function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Ke(){return(Ke=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xe(e,t,n){return t&&Ze(e.prototype,t),n&&Ze(e,n),e}function Qe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}function Ye(e,t){return(Ye=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function et(e){var t=rt();return function n(){var r=ot(e),o;if(t){var a=ot(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return tt(this,o)}}function tt(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?nt(e):t}function nt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ot(e){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function at(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var it=function(e){Qe(n,e);var t=et(n);function n(){var e;Je(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return at(nt(e=t.call.apply(t,[this].concat(a))),"state",{isShowMore:!1,isShowWholeCommentMd:!1}),at(nt(e),"getConversations",(function(){var t=e.props.commentList,n=e.state.isShowMore,r=[];t.forEach((function(e){var t;!e.parent_id?r.push([e]):r.forEach((function(t){t.forEach((function(n){n.id===e.parent_id&&t.push(e)}))}))}));var o=[],a=r.length;return o=a>8&&n?r.slice(a-8,a):r})),at(nt(e),"showAllCommentArea",(function(){e.setState({isShowWholeCommentMd:!0})})),at(nt(e),"onSubmitWhole",(function(t,n,r){var o=e.props.curCommitInfo;Object(qe.b)({action:"comment",page:"Modal-Commit",type:"",control:""}),e.props.postInfo({note:t,parent_id:r||"",sha:o.id},(function(){e.setState({isShowWholeCommentMd:!1})}))})),at(nt(e),"renderCommentList",(function(){var t=e.getConversations();return t.length?o.a.createElement("div",{className:"commit-comment-info-list"},t.map((function(t){return o.a.createElement(Ge,Ke({data:t,key:t.id},e.props))}))):o.a.createElement(me.a,{content:"\u6682\u65e0\u8bc4\u8bba",imgType:"comment"})})),e}return Xe(n,[{key:"componentDidMount",value:function e(){var t=document.querySelector(".commit-detail-bottom"),n=document.querySelector("#commit-more-info-panel"),r=t?t.getBoundingClientRect().top:0;n.style.top="".concat(r>0?r:0,"px")}},{key:"render",value:function e(){var t=this,n=this.props,r=n.branches,a=n.tags,i=n.changeTags,c=n.curCommitInfo,l=n.computebranches,u=n.computeParentIds,f=n.commentList,m=this.state,p=m.isShowWholeCommentMd,d=m.isShowMore,y=c.parent_ids?c.parent_ids.length:"";return o.a.createElement("div",{className:"commit-more-info-panel",id:"commit-more-info-panel"},o.a.createElement("div",{className:"commit-base-info"},o.a.createElement("div",{className:"base-info-title"},"\u57fa\u672c\u4fe1\u606f"),o.a.createElement("div",{className:"base-info-type",style:{display:r.length?"flex":"none"}},o.a.createElement("div",{className:"type-name"},"\u5206\u652f"),o.a.createElement("div",{className:"type-info"},o.a.createElement(G,{data:l(r),itemType:"normal"}))),o.a.createElement("div",{className:"base-info-type",style:{display:a.length?"flex":"none"}},o.a.createElement("div",{className:"type-name"},"\u6807\u7b7e"),o.a.createElement("div",{className:"type-info"},o.a.createElement(ue,{tags:a,onChange:i,branch:c.id}))),y?o.a.createElement("div",{className:"base-info-type"},o.a.createElement("div",{className:"type-name"},"\u7236\u63d0\u4ea4 \xb7 ",y),o.a.createElement("div",{className:"type-info"},o.a.createElement(G,{data:u(c.parent_ids)}))):null,We.a?null:o.a.createElement(fe.a,{identifier:"plugin_for_code_commit",container:{target:"commit",id:c.id}})),o.a.createElement("div",{className:"commit-comment-info"},o.a.createElement("div",{className:"comment-info-title"},"\u6240\u6709\u8bc4\u8bba"),o.a.createElement("div",{className:"top-switch"},f.length>8?o.a.createElement("div",{className:"show-more-btn"},o.a.createElement(s.Button,{type:"primary",text:!0,onClick:function e(){t.setState({isShowMore:!d})}},o.a.createElement("span",{style:{marginRight:"14px"}},o.a.createElement(O.a,{type:"more"})),o.a.createElement("span",null,d?"\u663e\u793a\u8f83\u65e9\u7684".concat(f.length-8,"\u6761\u8bc4\u8bba"):"\u9690\u85cf\u8f83\u65e9\u7684\u8bc4\u8bba"))):null),this.renderCommentList()),o.a.createElement("div",{className:"commit-comment-bottom-wrapper height-transition ".concat(p?"h190":"h61")},o.a.createElement("div",{className:"text",onClick:this.showAllCommentArea,style:{display:p?"none":"block"}},"\u8bf7\u8f93\u5165\u8bc4\u8bba"),p?o.a.createElement("div",{className:"md"},o.a.createElement(se.a,{initValue:"",onSubmitImmediate:this.onSubmitWhole,btnAlign:"left",onCancel:function e(){t.setState({isShowWholeCommentMd:!1})},useInLog:!0})):null))}}]),n}(r.Component),ct=n(1599),lt=n(289),ut=n(297),st=n(29);function ft(e){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function mt(){return(mt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function pt(e,t){if(null==e)return{};var n=dt(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dt(e,t){if(null==e)return{};var n={},r=Object.keys(e),o,a;for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}function yt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ht(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bt(e,t,n){return t&&ht(e.prototype,t),n&&ht(e,n),e}function gt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vt(e,t)}function vt(e,t){return(vt=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function wt(e){var t=_t();return function n(){var r=St(e),o;if(t){var a=St(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Et(this,o)}}function Et(e,t){return!t||"object"!==ft(t)&&"function"!=typeof t?Ot(e):t}function Ot(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _t(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function St(e){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jt=function(e){gt(n,e);var t=wt(n);function n(){var e;yt(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ct(Ot(e=t.call.apply(t,[this].concat(o))),"selectBranch",(function(t){var n=e.props.onChange;n&&n(t)})),e}return bt(n,[{key:"render",value:function e(){var t=this.props,n=t.value,r=t.allBranches,a=t.onChange,i=pt(t,["value","allBranches","onChange"]),c=r.map((function(e){return{label:e.name,value:e.name}}));return o.a.createElement(s.Select,mt({placeholder:"\u8bf7\u9009\u62e9\u5206\u652f",dataSource:c,value:n,showSearch:!0,onChange:this.selectBranch,popupProps:{className:"ellipsis-label-select-popup"},itemRender:function e(t){return o.a.createElement(st.default,{trigger:o.a.createElement("span",null,t.label),align:"t"},t.label)}},i))}}]),n}(o.a.Component),Pt=n(4),kt=n(13);function It(e){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Nt(){return(Nt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Rt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tt(e,t,n){return t&&Bt(e.prototype,t),n&&Bt(e,n),e}function xt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lt(e,t)}function Lt(e,t){return(Lt=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Dt(e){var t=Ft();return function n(){var r=Ht(e),o;if(t){var a=Ht(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return At(this,o)}}function At(e,t){return!t||"object"!==It(t)&&"function"!=typeof t?Mt(e):t}function Mt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ft(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Ht(e){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zt=window.FORCE.pathResource,Gt=s.Form.Item,qt={labelCol:{span:4},wrapperCol:{span:20}},Vt=function(e){xt(n,e);var t=Dt(n);function n(e){var r;return Rt(this,n),Ut(Mt(r=t.call(this,e)),"getBranches",(function(){var e=r.props,t=e.onChange,n=e.projectId;Promise.all([Object(p.j)(n),Object(p.v)(n)]).then((function(e){var n=e[0]?e[0].slice(1):[],o=e[1]?e[1].default_branch:"";r.setState({allBranches:n,branch:o}),t&&t(o)})).catch((function(e){console.error(e)}))})),Ut(Mt(r),"showModal",(function(){r.setState({isModalOpen:!0})})),Ut(Mt(r),"onClose",(function(){r.setState({isModalOpen:!1}),r.props.onClose()})),Ut(Mt(r),"onHandleSubmit",(function(){r.state.submitting||r.field.validate((function(e){e?r.setState({submitting:!1}):(r.setState({submitting:!0}),r.state.isNeedBranch?r.createBranchByCommit():r.mergeCommit(r.state.branch))}))})),Ut(Mt(r),"mergeCommit",(function(e,t){var n=r.props,o=n.sha,a=n.projectId;Pt.a.fetch({api:"commit.cherry_pick",params:{projectId:a||zt.id,sha:o},data:{branch:e}}).then((function(){r.setState({submitting:!1}),t?t():s.Toast.success({title:"\u63d0\u4ea4\u6210\u529f Cherry-pick \u5230 ".concat(e," \u5206\u652f")}),r.onClose()})).fail((function(e){try{s.Toast.error({title:JSON.parse(e.response).message})}catch(e){console.error(e)}r.setState({submitting:!1})}))})),Ut(Mt(r),"getBranchName",(function(e){var t=r.props,n=t.sha,o=t.projectId;Pt.a.fetch({api:"commit.options_branch_name",params:{projectId:o||zt.id,sha:n},data:{option:"cherry-pick"}}).then((function(t){e&&e(t.newBranchName)})).fail((function(){r.setState({submitting:!1})}))})),Ut(Mt(r),"createBranchByCommit",(function(){var e=r.props,t=e.onChange,n=e.projectId,o=r.state.branch;r.getBranchName((function(e){Pt.a.fetch({api:"project.branches.post.associateTask",data:{project_id:n||zt.id,branch_name:e,ref:o}}).then((function(){r.mergeCommit(e,(function(){t&&t({createMrModalOpen:!0,sourceBranch:e,targetBranch:o})}))})).fail((function(){r.setState({submitting:!1})}))}))})),Ut(Mt(r),"handleBranchChange",(function(e){r.setState({branch:e})})),Ut(Mt(r),"handleCheckboxChange",(function(e){r.setState({isNeedBranch:e})})),r.field=new s.Field(Mt(r)),r.state={isModalOpen:!1,submitting:!1,branch:"",isNeedBranch:!0,allBranches:[]},r}return Tt(n,[{key:"componentDidMount",value:function e(){this.getBranches()}},{key:"render",value:function e(){var t=this.field,n=this.state,r=n.branch,a=n.isNeedBranch,i=n.allBranches,c=this.props.projectId;return o.a.createElement(o.a.Fragment,null,this.state.isModalOpen?o.a.createElement(s.Dialog,{visible:!0,onClose:this.onClose,onCancel:this.onClose,okProps:{loading:this.state.submitting},onOk:this.onHandleSubmit,title:o.a.createElement("div",null,"Cherry-pick",o.a.createElement(s.Balloon.Tooltip,{type:"normal",trigger:o.a.createElement(s.Button.Icon,{type:"secondary",color:"gray",name:"question-o",style:{marginLeft:4,display:"inline-block"}}),align:"t"},"\u5982\u4f55\u4f7f\u7528 ",o.a.createElement("a",{target:"_blank",href:Object(kt.a)("cherry-pick")},"Cherry-pick")," \uff1f")),style:{width:"500px"}},o.a.createElement(s.Form,{labelAlign:"top",field:t,className:"cherry-pick-form"},o.a.createElement(Gt,Nt({label:"\u8bf7\u9009\u62e9\u76ee\u6807\u5206\u652f",required:!0},qt),o.a.createElement(jt,{allBranches:i,value:r,projectId:c||zt.id,onChange:this.handleBranchChange,style:{width:"50%"}})),o.a.createElement(Gt,Nt({label:""},qt),o.a.createElement(s.Checkbox,{checked:a,onChange:this.handleCheckboxChange},"\u521b\u5efa\u4e00\u4e2a\u65b0\u5206\u652f\uff0c\u5e76\u53d1\u8d77\u5408\u5e76\u8bf7\u6c42\u8bc4\u5ba1\u672c\u6b21\u53d8\u66f4")))):null,!!this.props.trigger&&o.a.cloneElement(this.props.trigger,{onClick:this.showModal}))}}],[{key:"getDerivedStateFromProps",value:function e(t){return t.trigger?{}:{isModalOpen:t.isModalOpen}}}]),n}(o.a.Component);function Wt(e){return(Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function $t(){return($t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Kt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zt(e,t,n){return t&&Jt(e.prototype,t),n&&Jt(e,n),e}function Xt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qt(e,t)}function Qt(e,t){return(Qt=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Yt(e){var t=nn();return function n(){var r=rn(e),o;if(t){var a=rn(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return en(this,o)}}function en(e,t){return!t||"object"!==Wt(t)&&"function"!=typeof t?tn(e):t}function tn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function rn(e){return(rn=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function on(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Ut(Vt,"propTypes",{trigger:l.a.element,onCancel:l.a.func,onClose:l.a.func,formSubmit:l.a.func}),Ut(Vt,"defaultProps",{trigger:null});var an=window.FORCE.pathResource,cn=s.Form.Item,ln={labelCol:{span:4},wrapperCol:{span:20}},un=function(e){Xt(n,e);var t=Yt(n);function n(e){var r;return Kt(this,n),on(tn(r=t.call(this,e)),"getBranches",(function(){var e=r.props,t=e.projectId,n=e.branchName;Promise.all([Object(p.j)(t),Object(p.v)(t)]).then((function(e){var t=e[0]?e[0].slice(1):[],o=e[1]?e[1].default_branch:"";r.setState({allBranches:t,branch:n||o})})).catch((function(e){console.error(e)}))})),on(tn(r),"showModal",(function(){r.setState({isModalOpen:!0})})),on(tn(r),"onClose",(function(){r.setState({isModalOpen:!1}),r.props.onClose()})),on(tn(r),"onHandleSubmit",(function(){r.state.submitting||r.field.validate((function(e){e?r.setState({submitting:!1}):(r.setState({submitting:!0}),r.state.isNeedBranch?r.createBranchByCommit():r.mergeCommit(r.state.branch))}))})),on(tn(r),"mergeCommit",(function(e,t){var n=r.props,o=n.sha,a=n.projectId;Pt.a.fetch({api:"commit.revert",params:{projectId:a||an.id,sha:o},data:{branch:e}}).then((function(){r.setState({submitting:!1}),t?t():s.Toast.success({title:"\u63d0\u4ea4\u6210\u529f\u5728 ".concat(e," \u5206\u652f\u4e0a\u88ab\u8fd8\u539f")}),r.onClose()})).fail((function(){r.setState({submitting:!1})}))})),on(tn(r),"getBranchName",(function(e){var t=r.props,n=t.sha,o=t.projectId;Pt.a.fetch({api:"commit.options_branch_name",params:{projectId:o||an.id,sha:n},data:{option:"revert"}}).then((function(t){e&&e(t.newBranchName)})).fail((function(){r.setState({submitting:!1})}))})),on(tn(r),"createBranchByCommit",(function(){var e=r.props,t=e.onChange,n=e.projectId,o=r.state.branch;r.getBranchName((function(e){Pt.a.fetch({api:"project.branches.post.associateTask",data:{project_id:n||an.id,branch_name:e,ref:o}}).then((function(){r.mergeCommit(e,(function(){t&&t({createMrModalOpen:!0,sourceBranch:e,targetBranch:o})}))})).fail((function(){r.setState({submitting:!1})}))}))})),on(tn(r),"handleBranchChange",(function(e){r.setState({branch:e})})),on(tn(r),"handleCheckboxChange",(function(e){r.setState({isNeedBranch:e})})),r.field=new s.Field(tn(r)),r.state={isModalOpen:!1,submitting:!1,branch:"",isNeedBranch:!0,allBranches:[]},r}return Zt(n,[{key:"componentDidMount",value:function e(){this.getBranches()}},{key:"render",value:function e(){var t=this.field,n=this.state,r=n.branch,a=n.isNeedBranch,i=n.allBranches,c=this.props.projectId;return o.a.createElement(o.a.Fragment,null,this.state.isModalOpen?o.a.createElement(s.Dialog,{visible:!0,onClose:this.onClose,onCancel:this.onClose,okProps:{loading:this.state.submitting},onOk:this.onHandleSubmit,title:o.a.createElement("div",null,"Revert",o.a.createElement(s.Balloon.Tooltip,{type:"normal",trigger:o.a.createElement(s.Button.Icon,{type:"secondary",color:"gray",name:"question-o",style:{marginLeft:4,display:"inline-block"}}),align:"t"},"\u5982\u4f55\u4f7f\u7528 ",o.a.createElement("a",{target:"_blank",href:Object(kt.a)("revert")},"Revert")," \uff1f")),style:{width:"500px"}},o.a.createElement(s.Form,{labelAlign:"top",field:t,className:"revert-form"},o.a.createElement(cn,$t({label:"\u8bf7\u9009\u62e9\u76ee\u6807\u5206\u652f",required:!0},ln),o.a.createElement(jt,{allBranches:i,value:r,projectId:c||an.id,onChange:this.handleBranchChange,style:{width:"50%"}})),o.a.createElement(cn,$t({label:""},ln),o.a.createElement(s.Checkbox,{checked:a,onChange:this.handleCheckboxChange},"\u521b\u5efa\u4e00\u4e2a\u65b0\u5206\u652f\uff0c\u5e76\u53d1\u8d77\u5408\u5e76\u8bf7\u6c42\u8bc4\u5ba1\u672c\u6b21\u53d8\u66f4")))):null,!!this.props.trigger&&o.a.cloneElement(this.props.trigger,{onClick:this.showModal}))}}],[{key:"getDerivedStateFromProps",value:function e(t){return t.trigger?{}:{isModalOpen:t.isModalOpen}}}]),n}(o.a.Component);on(un,"propTypes",{trigger:l.a.element,onCancel:l.a.func,onClose:l.a.func,formSubmit:l.a.func}),on(un,"defaultProps",{trigger:null});var sn=n(67),fn=n(1460);function mn(e){return(mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pn(Object(n),!0).forEach((function(t){xn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yn(e){return bn(e)||En(e)||wn(e)||hn()}function hn(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bn(e){if(Array.isArray(e))return e}function gn(e){return On(e)||En(e)||wn(e)||vn()}function vn(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function wn(e,t){if(e){if("string"==typeof e)return _n(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_n(e,t):void 0}}function En(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function On(e){if(Array.isArray(e))return _n(e)}function _n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Sn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jn(e,t,n){return t&&Cn(e.prototype,t),n&&Cn(e,n),e}function Pn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kn(e,t)}function kn(e,t){return(kn=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function In(e){var t=Bn();return function n(){var r=Tn(e),o;if(t){var a=Tn(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Nn(this,o)}}function Nn(e,t){return!t||"object"!==mn(t)&&"function"!=typeof t?Rn(e):t}function Rn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Tn(e){return(Tn=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function xn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ln=window.FORCE,Dn=Ln.pathResource,An=Ln.resourceSubject,Mn=function(e){Pn(n,e);var t=In(n);function n(e){var r;return Sn(this,n),xn(Rn(r=t.call(this,e)),"div",document.createElement("div")),xn(Rn(r),"closeDialog",(function(){r.setState({showBuidlResultVisible:!1,showBuidlResult:null})})),xn(Rn(r),"onChange",(function(e){console.log(e)})),xn(Rn(r),"getRepoFullPath",(function(){var e=r.props.repoUrl,t;return(e?e.replace("".concat(window.location.origin,"/"),""):"")||Dn.fullPath})),xn(Rn(r),"addDocumentEvents",(function(){r._keydownEvents=u.c.on(document,"keydown",r.handleDocumentKeyDown)})),xn(Rn(r),"handleDocumentKeyDown",(function(e){27===e.keyCode&&r.closeDetail()})),xn(Rn(r),"removeDocumentEvents",(function(){r._keydownEvents&&(r._keydownEvents.off(),r._keydownEvents=null)})),xn(Rn(r),"getCommentList",(function(){var e=r.props,t=e.commitId,n=e.projectId,o={sha:t};Object(p.q)(o,n).then((function(e){r.setState({commentList:e.slice(1)})})).catch((function(e){console.error(e)}))})),xn(Rn(r),"postInfo",(function(e,t){var n=r.props.projectId,o;r.state.submitting||(r.setState({submitting:!0}),Object(p.S)(e,n).then((function(){s.Toast.success({title:"\u8bc4\u8bba\u6210\u529f"}),r.setState({submitting:!1}),r.getCommentList(),t()})).catch((function(e){s.Toast.error({title:"\u8bc4\u8bba\u5931\u8d25"}),r.setState({submitting:!1}),console.error(e)})))})),xn(Rn(r),"changeTags",(function(e){var t=r.state.tags;t&&r.setState({tags:[].concat(gn(t),[{name:e.name,message:e.message}])})})),xn(Rn(r),"getBranchAndTagInfo",(function(e){var t=r.props,n=t.commitId,o=t.projectId,a={sha:e||n};Object(p.p)(a,o).then((function(e){r.setState({branches:e.branches,tags:e.tags})})).catch((function(e){console.log(e)}))})),xn(Rn(r),"getCommitInfoAndDiffs",(function(e){var t=r.props,n=t.commitId,o=t.projectId,a=r.state,i=a.isLoadingCommitInfo,c=a.isLoadingDiff,l={sha:e||n,show_signature:!0};i&&c||r.setState({isLoadingCommitInfo:!0,isLoadingDiff:!0}),Object(p.r)(l,o).then((function(e){r.setState({curCommitInfo:e,isLoadingCommitInfo:!1})})).catch((function(){r.setState({isLoadingCommitInfo:!1})})),Object(p.w)(l,o).then((function(e){var t=e.slice(1);t.forEach((function(e){var n="diff --git a/".concat(e.old_path," b/").concat(e.new_path,"\nindex 0299f74..23f1202 ").concat(e.b_mode,"\n");e.diff=n+e.diff,(e.diff.length>w.h.MAX_CR_DIFF_SIZE||t.length>w.h.MAX_DIFF_NUM)&&(e.originalDiff=e.diff,e.diff="$WAITING_FOR_CLICK_BIG_SIZE$")})),r.setState({diffs:t,isLoadingDiff:!1})})).catch((function(e){var t="";try{var n=JSON.parse(e.responseText);t=n.message||n.errorCode}catch(e){t="\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5"}r.setState({isLoadingDiff:!1,errorInfo:t})}))})),xn(Rn(r),"closeDetail",(function(){r.setState({style:{animation:"commitDetailClose .3s forwards"}}),setTimeout((function(){r.props.onChange()}),300)})),xn(Rn(r),"handleChange",(function(e,t){r.setState(xn({},t,e))})),xn(Rn(r),"clickParentId",(function(e,t){e.stopPropagation(),r.getCommitInfoAndDiffs(t),r.getBranchAndTagInfo(t),r.setState({isShowMoreInfoPanel:!1})})),xn(Rn(r),"computeParentIds",(function(e){return e?e.map((function(e){return o.a.createElement("a",{onClick:function t(n){r.clickParentId(n,e)},key:e},e.substr(0,8))})):[]})),xn(Rn(r),"computebranches",(function(e){return e.map((function(e){return o.a.createElement("a",{className:"commit-detail-brach-single-tag-link",href:"/".concat(r.getRepoFullPath(),"/tree/").concat(e),target:"blank"},o.a.createElement(O.a,{type:"branch",biz:"code",className:"branch-icon-color"})," ",e)}))})),xn(Rn(r),"getCurCommitScanBuilds",(function(){var e=r.props,t=e.commitId,n=e.showBuildId,o=e.projectId;Object(p.s)(t,o).then((function(e){e.shift();var t=e.length&&e.find((function(e){return Number(e.id)===Number(n)}))||null;r.setState({showBuidlResult:t})})).catch((function(e){console.log(e)}))})),xn(Rn(r),"getCommitHref",(function(){return"".concat(window.location.origin,"/").concat(r.getRepoFullPath(),"/commit/").concat(r.props.commitId)})),xn(Rn(r),"renderHeader",(function(){var e=r.state,t=e.curCommitInfo,n=e.isShowAllDes,a=t.user||t.author||"",i=a?a.name||a.username:t.author_name,c,l,f=yn((t.message||t.title||"").split("\n")),p=f[0],d,v=f.slice(1).filter((function(e){return""!==e.trim()})),w=n?v:v.slice(0,3),E=[{avatar_url:a.avatar_url||"",name:i||"",date:t.authored_date||""}];a&&t.author_email!==t.committer_email&&E.push({avatar_url:t.committer.avatar_url||"",name:t.committer.name||t.committer.username||t.committer_name,date:t.created_at||""});var _=E.map((function(e,t){return o.a.createElement("div",{className:"user-action-time",style:{marginLeft:t>0?16:0}},o.a.createElement(y.a,{text:e.name||"",image:e.avatar_url||"",size:"xs",radius:"50%",needAddedText:!0}),o.a.createElement("div",{className:"user-action-des"},t>0?"\u63d0\u4ea4\u4e8e":"\u521b\u5efa\u4e8e",u.b.getBeautyTime(e.date).toLowerCase()))})),S=r.props.projectInfo,C=[_,t.id?o.a.createElement("div",{className:"scan-result"},o.a.createElement(lt.a,{container:{target:"commit",id:t.id},projectInfo:S})):null],j=[o.a.createElement(s.Balloon.Tooltip,{trigger:o.a.createElement(m.a,{text:r.getCommitHref(),onCopy:function e(){Object(qe.b)({action:"copy_commit_link",page:"Modal-Commit",type:"",control:""}),s.Toast.success({title:"\u590d\u5236\u6210\u529f"})}},o.a.createElement(s.Button.Icon,{type:"primary",color:"gray",name:"link",style:{marginLeft:20}})),align:"b",text:"\u590d\u5236\u63d0\u4ea4\u94fe\u63a5"}),o.a.createElement(g.a,{commitInfo:t,pathResource:Dn,onClick:function e(){var n="/".concat(r.getRepoFullPath(),"/tree/").concat(t.id);window.location.pathname===n?r.closeDetail():Object(h.d)(n,{state:{forceUpdate:!0}}),Object(qe.b)({action:"view_commit_source_file",page:"Modal-Commit",type:"",control:"navigation"})}}),o.a.createElement(s.Dropdown,{trigger:o.a.createElement(s.Button.Icon,{name:"more",type:"primary",color:"gray",style:{marginLeft:20}}),triggerType:"click",align:"tr br",followTrigger:!0},o.a.createElement("div",{className:"more-btn-dropdown-content"},o.a.createElement("div",null,o.a.createElement(s.Button,{type:"normal",component:"a",color:"gray",onClick:function e(){Object(qe.b)({action:"compare_commits",page:"Modal-Commit",type:"",control:""}),Object(h.d)("/".concat(r.getRepoFullPath(),"/compare?from=").concat(encodeURIComponent(r.props.commitId),"&to=").concat(encodeURIComponent(Dn.defaultBranch)).concat(An.subject?"&tab=".concat(encodeURIComponent(An.subject)):""),{state:{forceUpdate:!0}})},text:!0},"\u6bd4\u8f83")),o.a.createElement("div",null,o.a.createElement(s.Button,{type:"normal",component:"a",color:"gray",onClick:function e(){r.setState({isRevertOpen:!0})},text:!0},"Revert")),o.a.createElement("div",null,o.a.createElement(s.Button,{type:"normal",component:"a",color:"gray",onClick:function e(){r.setState({isCherryPickOpen:!0})},text:!0},"Cherry-pick"))))];return o.a.createElement("div",{className:"commit-detail-header"},o.a.createElement("div",{className:"commit-detail-header-title"},o.a.createElement("div",{className:"commit-detail-header-title-left"},o.a.createElement(s.Balloon.Tooltip,{trigger:o.a.createElement("div",{className:"msg-title one-line-ellipsis"},p),align:"b"},p),o.a.createElement("div",{className:"builds-and-author"},C)),o.a.createElement("div",{className:"commit-detail-header-title-right"},o.a.createElement("div",{style:{marginRight:8}},o.a.createElement(fn.a,{signature:t.signature,author:{name:i||"",avatarUrl:a.avatar_url||""}})),o.a.createElement("div",{className:"commit-detail-header-title-right-context"},o.a.createElement("div",{className:"commit-id-src-group"},o.a.createElement(b.a,{onChange:r.onChange,commitInfo:t,pathResource:Dn,isSrcBtnShow:!1,isCommitIdCursorDefault:!0})),o.a.createElement("div",{className:"commit-detail-header-title-right-split-line"}),o.a.createElement(s.Button,{type:r.state.isShowMoreInfoPanel?"primary":"normal",className:"toggle-more-btn",color:"gray",onClick:function e(){Object(qe.b)({action:"view_commit_detail_info",page:"Modal-Commit",type:"",control:""}),r.setState({isShowMoreInfoPanel:!r.state.isShowMoreInfoPanel})},text:!0},o.a.createElement(O.a,{type:"info-o"}),"\u8be6\u60c5"),o.a.createElement("div",{className:"more-btn"},j),o.a.createElement(s.Dropdown,{trigger:o.a.createElement(s.Button.Icon,{name:"more",type:"primary",className:"more-btn-dropdown-trigger",color:"gray",style:{marginLeft:20}}),triggerType:"click",align:"tr br",followTrigger:!0},o.a.createElement("div",{className:"more-btn-dropdown-content"},o.a.createElement("div",null,o.a.createElement(s.Button,{type:"normal",component:"a",color:"gray",onClick:function e(){Object(qe.b)({action:"compare_commits",page:"Modal-Commit",type:"",control:""}),Object(h.d)("/".concat(r.getRepoFullPath(),"/compare?from=").concat(encodeURIComponent(r.props.commitId),"&to=").concat(encodeURIComponent(Dn.defaultBranch)).concat(An.subject?"&tab=".concat(encodeURIComponent(An.subject)):""),{state:{forceUpdate:!0}})},text:!0},"\u6bd4\u8f83")),o.a.createElement("div",null,o.a.createElement(m.a,{text:r.getCommitHref(),onCopy:function e(){Object(qe.b)({action:"copy_commit_link",page:"Modal-Commit",type:"",control:""}),s.Toast.success({title:"\u590d\u5236\u6210\u529f"})}},o.a.createElement(s.Button,{type:"normal",color:"gray",text:!0,component:"a"},"\u590d\u5236\u94fe\u63a5"))),o.a.createElement("div",null,o.a.createElement(s.Button,{type:"normal",component:"a",color:"gray",onClick:function e(){var n="/".concat(r.getRepoFullPath(),"/tree/").concat(t.id);window.location.pathname===n?r.closeDetail():Object(h.d)(n,{state:{forceUpdate:!0}}),Object(qe.b)({action:"view_commit_source_file",page:"Modal-Commit",type:"",control:"navigation"})},text:!0},"\u67e5\u770b\u6e90\u6587\u4ef6")),o.a.createElement("div",null,o.a.createElement(s.Button,{type:"normal",component:"a",color:"gray",onClick:function e(){r.setState({isRevertOpen:!0})},text:!0},"Revert")),o.a.createElement("div",null,o.a.createElement(s.Button,{type:"normal",component:"a",color:"gray",onClick:function e(){r.setState({isCherryPickOpen:!0})},text:!0},"Cherry-pick")))),o.a.createElement(s.Button.Icon,{name:"remove",type:"primary",className:"remove-btn",onClick:function e(){Object(qe.b)({action:"close_modal",page:"Modal-Commit",type:"",control:""}),r.closeDetail()}})))),o.a.createElement("div",{className:"commit-detail-des"},v.length>0?o.a.createElement("pre",{className:"commit-detail-des-pre"},w.map((function(e){return o.a.createElement("div",{className:"commit-detail-des-pre-item"},e)}))):null),o.a.createElement("div",{className:"toggle-all-des-btn",style:{display:v.length>3?"block":"none"}},o.a.createElement(s.Button,{type:"primary",text:!0,onClick:function e(){r.setState({isShowAllDes:!n})}},o.a.createElement(O.a,{type:n?"chevron-up-s":"chevron-down-s"}),n?"\u6536\u8d77":"\u5c55\u5f00")))})),xn(Rn(r),"renderBody",(function(){var e=r.props.commitId,t=r.state,n=t.diffs,a=t.curCommitInfo,i=t.commentList,c=t.isLoadingDiff,l=t.errorInfo;return o.a.createElement(E.a,{commitId:e,diffs:n,curCommitInfo:a,commentList:i,onChange:r.handleChange,loading:c,isInCommitDetail:!0,errorInfo:l})})),xn(Rn(r),"myRender",(function(){if(!r.props.commitId)return null;var e=r.props,t=e.projectId,n=e.branchName,a=r.state,i=a.isLoadingCommitInfo,c=a.isLoadingDiff,l=a.branches,u=a.tags,f=a.curCommitInfo,m=a.commentList,p=a.showBuidlResultVisible,d=a.showBuidlResult,y=a.isCherryPickOpen,h=a.createMrModalOpen,b=a.sourceBranch,g=a.targetBranch,w=a.crType,E=a.isRevertOpen,O=r.props.style&&r.props.style.zIndex?dn({zIndex:r.props.style.zIndex},r.state.style):r.state.style;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"commit-detail-page ".concat(We.a?"important-zindex-ali":""),style:O},i||c?o.a.createElement("div",{className:"loading-box"},o.a.createElement(v.a,null)):[r.renderHeader(),r.renderBody(),o.a.createElement(s.Animate,{animation:{enter:"slideInRight",leave:"slideOutRight"}},r.state.isShowMoreInfoPanel?o.a.createElement(it,{changeTags:r.changeTags,branches:l,tags:u,curCommitInfo:f,computebranches:r.computebranches,computeParentIds:r.computeParentIds,commentList:m,postInfo:r.postInfo}):null),o.a.createElement(qe.a,{page:"Modal-Commit",pathname:r.getCommitHref()})],p&&d&&o.a.createElement(ut.a,{build:d,close:r.closeDialog,projectId:r.props.projectId})),y&&o.a.createElement(Vt,{isModalOpen:y,onClose:function e(){r.setState({isCherryPickOpen:!1})},projectId:t||window.FORCE.pathResource.id,sha:r.props.commitId,onChange:function e(t){r.setState(dn(dn({},t),{},{crType:"cherry-pick"}))}}),E&&o.a.createElement(un,{isModalOpen:E,onClose:function e(){r.setState({isRevertOpen:!1})},branchName:n||(An?An.revision:""),projectId:t||window.FORCE.pathResource.id,sha:r.props.commitId,onChange:function e(t){r.setState(dn(dn({},t),{},{crType:"revert"}))}}),h&&o.a.createElement(sn.a,{cannotChangeProject:!0,isModalOpen:h,defaultProjectId:t||window.FORCE.pathResource.id,defaultSourceBranch:b,defaultTargetBranch:g,isCherryPick:!0,title:"cherry-pick"===w?'Cherry-pick "'.concat(f.message,'"'):'Revert "'.concat(f.message,'"'),desc:"cherry-pick"===w?"Cherry-pick \u63d0\u4ea4 ".concat(f.id):"\u8fd8\u539f\u63d0\u4ea4 ".concat(f.id),onCloseModal:function e(){r.setState({createMrModalOpen:!1,isCherryPickOpen:!1})}}))})),r.state={curCommitInfo:{},isLoadingCommitInfo:!0,isLoadingDiff:!0,diffs:[],commentList:[],tags:[],branches:[],isShowAllDes:!1,isShowMoreInfoPanel:!1,style:{},showBuidlResultVisible:!!e.showBuildId,showBuidlResult:null,isCherryPickOpen:!1,createMrModalOpen:!1,sourceBranch:"",targetBranch:"",crType:"",errorInfo:""},Object(qe.f)({pathname:r.getCommitHref()}),r}return jn(n,[{key:"componentDidMount",value:function e(){this.props.commitId&&(this.props.container&&this.props.container.appendChild(this.div),this.getCommitInfoAndDiffs(),this.getBranchAndTagInfo(),this.getCommentList(),this.props.showBuildId&&this.getCurCommitScanBuilds(),this.addDocumentEvents(),Object(qe.c)("Modal-Commit",{sendPerf:!1}))}},{key:"componentWillUnmount",value:function e(){this.props.container&&this.props.container.removeChild(this.div),this.removeDocumentEvents()}},{key:"render",value:function e(){return this.props.container?i.a.createPortal(this.myRender(),this.div):this.myRender()}}]),n}(o.a.Component);xn(Mn,"propTypes",{projectInfo:l.a.object,commitId:l.a.string,onChange:l.a.func,container:l.a.node,scanResult:l.a.string,showBuildId:l.a.string}),xn(Mn,"defaultProps",{projectInfo:{},commitId:"",onChange:function e(){},container:null,scanResult:"",showBuildId:""})},1460:function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));var r=n(0),o=n.n(r),a=n(1),i=n.n(a),c=n(8),l=n(13),u=n(166),s=n.n(u),f=n(9),m=n(98),p=n.n(m),d=n(1600),y=n.n(d);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),e}function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}function E(e,t){return(E=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function O(e){var t=C();return function n(){var r=j(e),o;if(t){var a=j(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return _(this,o)}}function _(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?S(e):t}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k="gpg-tag",I="verified",N={unverified:"GPG \u5bc6\u94a5\u9a8c\u7b7e\u672a\u901a\u8fc7",same_user_different_email:"GPG \u5bc6\u94a5\u9a8c\u7b7e\u901a\u8fc7\uff0c\u63d0\u4ea4\u8005\u90ae\u7bb1\uff08committer email) \u5c5e\u4e8e\u5bf9\u5e94\u7684\u4e91\u6548\u7528\u6237\uff0c\u4f46\u4e0e\u8bc1\u4e66\u90ae\u7bb1\u4e0d\u4e00\u81f4",other_user:"GPG \u5bc6\u94a5\u9a8c\u7b7e\u901a\u8fc7\uff0c\u4f46\u63d0\u4ea4\u8005\u90ae\u7bb1\uff08committer email) \u4e0d\u5c5e\u4e8e\u5bf9\u5e94\u4e91\u6548\u7684\u7528\u6237",unverified_key:"GPG \u5bc6\u94a5\u90ae\u7bb1\u4e0d\u5c5e\u4e8e\u5bf9\u5e94\u7684\u4e91\u6548\u7528\u6237",unknown_key:"\u627e\u4e0d\u5230\u5339\u914d\u7684 GPG \u5bc6\u94a5\uff0c"},R=function(e){w(n,e);var t=O(n);function n(){var e;b(this,n);for(var r=arguments.length,i=new Array(r),u=0;u<r;u++)i[u]=arguments[u];return P(S(e=t.call.apply(t,[this].concat(i))),"state",{httpsSetting:!1,personalNavKey:null}),P(S(e),"renderIcon",(function(){var t=e.props.signature,n="",r="";return"verified"===t.verification_status?(n="under-protection",r="green"):"unknown_key"===t.verification_status?(n="ziyuan1",r="gray"):(n="circle-questionbeifen",r="red"),o.a.createElement(c.a,{type:n,biz:"code",className:"".concat(k,"-icon-").concat(r)})})),P(S(e),"renderVerifiedInfo",(function(){var t=e.props,n=t.signature,r=t.author;return o.a.createElement("div",{className:"".concat(k,"-success")},o.a.createElement("div",{className:"".concat(k,"-success-user")},o.a.createElement(s.a,{text:r.name||"",image:r.avatar_url||"",size:"xs",radius:"50%",needAddedText:!0})),o.a.createElement("div",{className:"".concat(k,"-success-key")},"GPG key ID\uff1a",n.gpg_key_id?n.gpg_key_id.toUpperCase():""))})),P(S(e),"renderUnVerifiedInfo",(function(){var t=e.props.signature,n="unknown_key"===t.verification_status;return o.a.createElement("div",{className:"".concat(k,"-error")},t.gpg_key_id&&o.a.createElement("div",null,"GPG key ID\uff1a",t.gpg_key_id.toUpperCase()),o.a.createElement("div",null,N[t.verification_status],n&&f.c&&o.a.createElement("a",{className:"no-href-with-click",onClick:function t(){e.setState({httpsSetting:!0,personalNavKey:"gpg"})}},"\u7acb\u5373\u6dfb\u52a0")))})),P(S(e),"renderPopup",(function(){var t=e.props.signature,n="verified"===t.verification_status,r="",i="";return"verified"===t.verification_status?(r="green",i="\u5f53\u524d\u63d0\u4ea4\u5df2\u901a\u8fc7\u9a8c\u8bc1"):"unknown_key"===t.verification_status?(r="gray",i="\u672a\u77e5\u7684 GPG \u5bc6\u94a5"):(r="red",i="\u5f53\u524d\u63d0\u4ea4\u672a\u901a\u8fc7\u9a8c\u8bc1"),o.a.createElement("div",{className:"".concat(k,"-popup")},o.a.createElement("div",{className:"".concat(k,"-bar ").concat(r)}),o.a.createElement("div",{className:"".concat(k,"-popup-header")},o.a.createElement("div",{className:"".concat(k,"-popup-title")},o.a.createElement("div",null,i),o.a.createElement(a.Balloon.Tooltip,{type:"normal",trigger:o.a.createElement(a.Button.Icon,{type:"secondary",style:{padding:0},color:"gray",name:"question-o"}),align:"t"},o.a.createElement("a",{target:"_blank",href:Object(l.a)("gpg")},"\u5982\u4f55\u4f7f\u7528 GPG \u7b7e\u540d\u9a8c\u8bc1\uff1f")))),o.a.createElement("div",{className:"".concat(k,"-popup-detail")},n?e.renderVerifiedInfo():e.renderUnVerifiedInfo()))})),e}return v(n,[{key:"render",value:function e(){var t=this,n;if(!this.props.signature)return null;var r=this.state,i=r.personalNavKey,c=r.httpsSetting;return o.a.createElement(o.a.Fragment,null,f.c&&o.a.createElement(p.a,{code:!0,uiless_config:window.UILessConfig,selectedNavKey:i,visible:c,noTitle:!0,onClose:function e(){return t.setState({httpsSetting:!1})},dingtalk:!0,sessionTime:!0}),o.a.createElement(a.Overlay.Popup,{trigger:this.renderIcon(),triggerType:"hover",align:"tr br"},this.renderPopup()))}}]),n}(o.a.PureComponent)},1464:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var r=n(0),o=n.n(r),a=n(3),i=n.n(a),c=n(1),l=n.n(c),u=n(291),s=n.n(u),f=n(6),m=n(1522),p=n.n(m),d=n(8),y=n(1523),h=n(5);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),e}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}function O(e,t){return(O=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function _(e){var t=j();return function n(){var r=P(e),o;if(t){var a=P(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return S(this,o)}}function S(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?C(e):t}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=c.Balloon.Tooltip,N=function(e){E(n,e);var t=_(n);function n(){return g(this,n),t.apply(this,arguments)}return w(n,[{key:"render",value:function e(){var t=this.props,n=t.commitInfo,r=t.inCommitDetail,a=t.resourcePath,i=t.pathResource,l=t.onChange,u=t.isSrcBtnShow,m=t.isCommitIdCursorDefault,p=t.trackPage;return o.a.createElement(o.a.Fragment,null,o.a.createElement(c.Button.Group,{className:"commit-id-btns",size:"small"},o.a.createElement(c.Button,{type:"normal",component:"a",onClick:l,size:"small",className:"commit-id-link-btn font-menlo",style:{cursor:m?"default":"pointer"}},n.sha?n.sha.slice(0,8):n.id&&n.id.slice(0,8)||""),o.a.createElement(I,{trigger:o.a.createElement(s.a,{text:n.id,onCopy:function e(){return c.Toast.success({title:"\u590d\u5236\u6210\u529f"})}},o.a.createElement(c.Button,{type:"normal",size:"small",className:"commit-id-copy-btn",onClick:function e(){Object(f.b)({action:"copy_commitid",page:p})}},o.a.createElement(d.a,{type:"copy",biz:"code"}))),align:"b",text:"".concat(h.a.file_copy," commit id")})),u?o.a.createElement("div",{className:"src-btn-wrapper"},o.a.createElement(y.a,{inCommitDetail:r,commitInfo:n,pathResource:i,resourcePath:a,trackPage:p})):null)}}]),n}(o.a.Component);k(N,"propTypes",{commitInfo:i.a.object,pathResource:i.a.object,resourcePath:i.a.string,trackPage:i.a.string,onChange:i.a.func,isSrcBtnShow:i.a.bool,isCommitIdCursorDefault:i.a.bool}),k(N,"defaultProps",{commitInfo:{},pathResource:{},resourcePath:"",onChange:function e(){},isSrcBtnShow:!1,isCommitIdCursorDefault:!1,trackPage:""})},1465:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n(0),o=n.n(r),a=n(2),i=n(13),c=n(19),l=n(1),u=n.n(l),s=n(1467),f=n.n(s),m=n(6);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),e}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}function g(e,t){return(g=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function v(e){var t=O();return function n(){var r=_(e),o;if(t){var a=_(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return w(this,o)}}function w(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?E(e):t}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C=l.Tag.Colorable,j=function(e){b(n,e);var t=v(n);function n(){var e;d(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return S(E(e=t.call.apply(t,[this].concat(o))),"goSetting",(function(){var e=window.FORCE.pathResource;window.open("/".concat(e.fullPath,"/settings/lfs"),"_blank"),Object(m.b)({action:"view_lfs_file",page:"",type:"",control:"tag"})})),e}return h(n,[{key:"render",value:function e(){var t=this.props.role;return o.a.createElement(l.Balloon.Tooltip,{align:"t",type:"normal",trigger:o.a.createElement("span",{className:"lfs-tag"},o.a.createElement(C,{color:"blue"},"Git LFS"))},"\u6587\u4ef6\u901a\u8fc7 Git LFS\uff08Large File Storage\uff09\u5b58\u50a8\uff0c",Object(c.a)(a.d,t)?o.a.createElement("a",{className:"no-href-with-click",onClick:this.goSetting},"\u67e5\u770b\u5f53\u524d\u5e93\u5168\u90e8 Git LFS \u6587\u4ef6"):o.a.createElement("a",{href:Object(i.a)("lfs"),target:"_blank",onClick:function e(){Object(m.b)({action:"view_lfs_instruction",page:"",type:"",control:"tag"})}},"\u4e86\u89e3\u5927\u6587\u4ef6\u5b58\u50a8\u670d\u52a1"))}}]),n}(o.a.Component)},1467:function(e,t,n){},1472:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(1486),i=n.n(a);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var n=u(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function u(e,t){if(null==e)return{};var n={},r=Object.keys(e),o,a;for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}var s=function e(t){var n=t.className,r=l(t,["className"]);return o.a.createElement("div",c({className:"file-panel ".concat(n||"")},r))};s.Header=function(e){return o.a.createElement("div",{className:"file-panel-header ".concat(e.className||"")},e.children)},s.Body=function(e){var t=e.noPadding,n=e.onlyPaddingBottom,r=e.className,a=e.children;return o.a.createElement("div",{className:"file-panel-body ".concat(r||""," ").concat(n?"onlyPaddingBottom":""," ").concat(t?"noPadding":"")},a)},t.a=s},1485:function(e,t,n){},1486:function(e,t,n){},1487:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(0),o=n.n(r),a=n(1),i=n.n(a),c=n(8),l=n(5),u=n(17),s=n(1488),f=n.n(s);function m(e){var t=e.item,n=e.onChange,r=o.a.createElement("div",{className:"file-name-filename"},o.a.createElement(a.Button.Icon,{type:"primary",color:"gray",onClick:n,className:"file-name-filename-arrow"},o.a.createElement(c.a,{type:"triangle-".concat(t.isHidden?"right":"down","-s")})),o.a.createElement(u.a,{path:t.new_path,style:{maxWidth:200,marginRight:8}}),t.a_mode!==t.b_mode?o.a.createElement(a.Balloon.Tooltip,{trigger:o.a.createElement("span",{className:"file-name-filename-line-diff"},o.a.createElement("span",null,"\xb7"),o.a.createElement("span",null,t.a_mode),o.a.createElement(c.a,{type:"sharp-right",biz:"code",size:"small",style:{marginRight:6}}),o.a.createElement("span",null,t.b_mode)),align:"t",text:l.a.file_permission_changed}):null);return o.a.createElement("div",null,o.a.createElement("div",{className:"file-name"},o.a.createElement("div",{className:"file-name-left"},r,t.new_path===t.old_path?null:o.a.createElement("div",{className:"rename-from"},l.a.projects_cr_renamed_from," ",t.old_path))))}},1488:function(e,t,n){},1489:function(e,t,n){"use strict";var r=n(292);function o(e){return l(e)||c(e)||i(e)||a()}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function c(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function l(e){if(Array.isArray(e))return u(e)}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s={getDiffsCount:function e(t){var n,a=t.map((function(e){"$WAITING_FOR_CLICK_BIG_SIZE$"===e.diff&&(n=!0);var t=Object(r.e)(e.diff),a,i;return t[0]?t[0].hunks.reduce((function(e,t){var n=t.changes;return[].concat(o(e),o(n))}),[]):[]}));if(n)return null;var i=[];a.forEach((function(e){i=i.concat(e)}));var c=0,l=0;return i.forEach((function(e){"insert"===e.type?c+=1:"delete"===e.type&&(l+=1)})),{additions:c,deletions:l}},getSingleDiffsCount:function e(t){var n;"$WAITING_FOR_CLICK_BIG_SIZE$"===t.diff&&(n=!0);var a=Object(r.e)(t.diff),i,c;a[0]?i=a[0].hunks.reduce((function(e,t){var n=t.changes;return[].concat(o(e),o(n))}),[]):i=[];if(n)return null;var l=0,u=0;return i.forEach((function(e){"insert"===e.type?l+=1:"delete"===e.type&&(u+=1)})),{additions:l,deletions:u}}};t.a=s},1490:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var r=n(0),o=n.n(r),a=n(13),i=n(1),c=n.n(i),l=n(1467),u=n.n(l),s=n(6);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function b(e){var t=w();return function n(){var r=E(e),o;if(t){var a=E(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return g(this,o)}}function g(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?v(e):t}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var O=i.Tag.Colorable,_=function(e){y(n,e);var t=b(n);function n(){return m(this,n),t.apply(this,arguments)}return d(n,[{key:"render",value:function e(){return o.a.createElement(i.Balloon.Tooltip,{align:"t",type:"normal",trigger:o.a.createElement("span",{className:"lfs-tag delete"},o.a.createElement(O,{color:"gray"},o.a.createElement("span",{className:"lfs-tag-left"},"Git LFS"),o.a.createElement("span",{className:"lfs-tag-line"}),o.a.createElement("span",null,"\u5df2\u5220\u9664")))},"\u6e90\u6587\u4ef6\u5df2\u5220\u9664\uff0c\u4f46 LFS \u6587\u4ef6\u8d44\u6e90\u672a\u91ca\u653e\uff0c",o.a.createElement("a",{href:Object(a.a)("lfs-delete"),target:"_blank",onClick:function e(){Object(s.b)({action:"clean_lfs_file",page:"",type:"",control:"tag"})}},"\u5982\u4f55\u5f7b\u5e95\u6e05\u7406LFS\u6587\u4ef6"))}}]),n}(o.a.PureComponent)},1522:function(e,t,n){},1523:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var r=n(0),o=n.n(r),a=n(3),i=n.n(a),c=n(1),l=n.n(c),u=n(6),s=n(11),f=n(1522),m=n.n(f),p=n(8);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}function v(e,t){return(v=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function w(e){var t=_();return function n(){var r=S(e),o;if(t){var a=S(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return E(this,o)}}function E(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?O(e):t}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j=c.Balloon.Tooltip,P=function(e){g(n,e);var t=w(n);function n(){return y(this,n),t.apply(this,arguments)}return b(n,[{key:"render",value:function e(){var t=this.props,n=t.commitInfo,r=t.resourcePath,a=t.pathResource,i=t.onClick,l=t.inCommitDetail,f=t.trackPage,m=null;return m=l?o.a.createElement(c.Button.Icon,{type:"primary",color:"gray",component:"a",className:"src-btn",onClick:function e(){Object(u.b)({action:"view_commit_source_file",page:f}),Object(s.d)(r?"/".concat(a.fullPath,"/tree/").concat(n.id,"/").concat(r):"/".concat(a.fullPath,"/tree/").concat(n.id),{state:{forceUpdate:!0}}),i&&i()}},o.a.createElement(p.a,{type:"folder-open",biz:"code"})):o.a.createElement(c.Button,{type:"normal",component:"a",className:"src-btn",size:"small",style:{minWidth:0,width:32,padding:0},onClick:function e(){Object(u.b)({action:"view_commit_source_file",page:f}),Object(s.d)(r?"/".concat(a.fullPath,"/tree/").concat(n.id,"/").concat(r):"/".concat(a.fullPath,"/tree/").concat(n.id),{state:{forceUpdate:!0}}),i&&i()}},o.a.createElement(p.a,{type:"folder-open",biz:"code"})),o.a.createElement(j,{trigger:m,align:"b",text:"\u67e5\u770b\u6e90\u6587\u4ef6"})}}]),n}(o.a.Component);C(P,"propTypes",{commitInfo:i.a.object,pathResource:i.a.object,resourcePath:i.a.string,trackPage:i.a.string,onClick:i.a.func,inCommitDetail:i.a.bool}),C(P,"defaultProps",{commitInfo:{},pathResource:{},resourcePath:"",trackPage:"",inCommitDetail:!0})},1524:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),o=n.n(r),a=n(1595),i=n.n(a);function c(e){var t=e.filterText,n=e.name;if(!n)return null;if(!t||-1===n.toLowerCase().indexOf(t.toLowerCase()))return n;var r=n.toLowerCase().indexOf(t.toLowerCase()),a=t.length,i=n.slice(r,r+a),c;return n.split(i).map((function(e,t){return o.a.createElement(o.a.Fragment,null,t>0&&o.a.createElement("span",{className:"filter-selected-text"},i),o.a.createElement("span",null,e))}))}},1525:function(e,t,n){},1526:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var r=n(0),o=n.n(r),a=n(6),i=n(1443),c=n.n(i);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e,t){if(null==e)return{};var n=d(e,t),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function d(e,t){if(null==e)return{};var n={},r=Object.keys(e),o,a;for(a=0;a<r.length;a++)o=r[a],t.indexOf(o)>=0||(n[o]=e[o]);return n}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}function v(e,t){return(v=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function w(e){var t=_();return function n(){var r=S(e),o;if(t){var a=S(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return E(this,o)}}function E(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?O(e):t}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var C=function(e){g(n,e);var t=w(n);function n(){return y(this,n),t.apply(this,arguments)}return b(n,[{key:"render",value:function e(){var t=this.props,n=t.identifier,r=t.plugin,i=t.container,l=p(t,["identifier","plugin","container"]);return o.a.createElement(c.a,u({plugin:f({type:"task",appId:window.UILessConfig.appId,label:"\u5173\u8054\u5185\u5bb9",tbHost:window.UILessConfig.tbHost},r),container:f({type:"codeup",projectId:window.FORCE.pathResource.id},i),uiless_config:f(f({},window.UILessConfig),{},{codeupTrack:a.b})},l))}}]),n}(o.a.Component)},1546:function(e,t,n){"use strict";n.d(t,"a",(function(){return De}));var r=n(0),o=n.n(r),a=n(3),i=n.n(a),c=n(7),l=n(1),u=n(8),s=n(10),f=n(166),m=n.n(f),p=n(292),d=n(5),y=n(45),h=n.n(y),b=n(728),g=n(1485);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e,t,n){return t&&E(e.prototype,t),n&&E(e,n),e}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}function S(e,t){return(S=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function C(e){var t=k();return function n(){var r=I(e),o;if(t){var a=I(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return j(this,o)}}function j(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?P(e):t}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=function(e){_(n,e);var t=C(n);function n(){var e;w(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return N(P(e=t.call.apply(t,[this].concat(a))),"manualLoadDiff",(function(t){e.props.manualLoadDiff(t)})),N(P(e),"renderHunk",(function(t){var n=null;if("STUB"!==t.content){var r=e.props.diff,a=Object(p.e)(r.diff,{stubHunk:!0})[0],i=t.content,c=a.hunks.findIndex((function(e){return e.content===i})),l,s,f=a.hunks[c-1],m=f?f.newStart+f.newLines:0,y=o.a.createElement("div",{className:"load-more-lines-btn-gutter",onClick:function n(){l=t.newStart-21>0?t.newStart-21:1,s=t.newStart-1,c>0&&l<m&&(l=m),e.props.loadMoreLines({from:l,to:s,hunk:t,diff:a})}},o.a.createElement(u.a,{type:"more"})),h=o.a.createElement("div",{className:"load-more-lines-btns"},o.a.createElement("a",{className:"load-more-lines-btn",onClick:function n(){l=t.newStart-21>0?t.newStart-21:1,s=t.newStart-1,c>0&&l<m&&(l=m),e.props.loadMoreLines({from:l,to:s,hunk:t,diff:a})}},o.a.createElement("span",{className:"load-more-lines-btn-icon"},"\u25b2"),d.a.cr_show_more_lines),o.a.createElement("a",{className:"load-more-lines-btn",onClick:function n(){l=m||1,s=t.newStart-1,e.props.loadMoreLines({from:l,to:s,hunk:t,diff:a})}},d.a.cr_show_all_lines),c>0?o.a.createElement("a",{className:"load-more-lines-btn",onClick:function n(){(s=(l=m||1)+20)>t.newStart-1&&(s=t.newStart-1),e.props.loadMoreLines({from:l,to:s,hunk:t,diff:a,isAddToEnd:!0})}},o.a.createElement("span",{className:"load-more-lines-btn-icon"},"\u25bc"),d.a.cr_show_more_lines):null);n=1!==t.newStart&&t.newStart>m&&!r.deleted_file&&!r.new_file?[y,h]:null}else{var b=e.props.diff,g=Object(p.e)(b.diff,{stubHunk:!0})[0],v=t.content,w=g.hunks.findIndex((function(e){return e.content===v})),E=g.hunks[w-1],O=E?E.newStart+E.newLines:0,_,S,C=o.a.createElement("div",{className:"load-more-lines-btn-gutter",onClick:function n(){_=b.lastLineNum||t.newStart,S=(b.lastLineNum||t.newStart)+20,w>0&&_<O&&(_=O),e.props.loadMoreLines({from:_,to:S,hunk:t,diff:g})}},o.a.createElement(u.a,{type:"more"})),j=o.a.createElement("div",{className:"load-more-lines-btns"},o.a.createElement("a",{className:"load-more-lines-btn",onClick:function n(){_=b.lastLineNum||t.newStart,S=null,e.props.loadMoreLines({from:_,to:S,hunk:t,diff:g,isLoadEndFinished:!0})}},d.a.cr_show_all_lines),w>0?o.a.createElement("a",{className:"load-more-lines-btn",onClick:function n(){_=b.lastLineNum||t.newStart,S=(b.lastLineNum||t.newStart)+20,w>0&&_<O&&(_=O),e.props.loadMoreLines({from:_,to:S,hunk:t,diff:g})}},o.a.createElement("span",{className:"load-more-lines-btn-icon"},"\u25bc"),d.a.cr_show_more_lines):null);n=b.loadEndFinished||b.deleted_file||b.new_file?null:[C,j]}return o.a.createElement(p.b,{key:t.content,hunk:t,header:n})})),e}return O(n,[{key:"render",value:function e(){var t=this,n=this.props,r=n.diff,a=n.viewType,i=Object(p.e)(r.diff,{stubHunk:!0});return"$WAITING_FOR_CLICK_BIG_SIZE$"===r.diff?o.a.createElement("div",{className:"manual-load-diff-holder",onClick:this.manualLoadDiff.bind(null,r)},d.a.projects_cr_manual_load_text):o.a.createElement("div",null,i.map((function(e,n){var r=e.hunks,i=e.newPath;return o.a.createElement(p.a,{key:n,viewType:a||"unified",markEdits:Object(p.d)({threshold:100,markLongDistanceDiff:!1}),onRenderCode:function e(t){var n=i.split("/")[i.split("/").length-1],r="";n.indexOf(".")&&(r=n.split(".")[n.split(".").length-1]);var o=t.getAttribute("class");return t.setAttribute("class","".concat(o," ").concat(r)),h.a.highlightBlock(t),t}},r.map(t.renderHunk))})))}}]),n}(o.a.Component);N(R,"propTypes",{}),N(R,"defaultProps",{});var B=n(23),T=n(1472),x=n(1487),L=n(1489),D=n(47),A=n.n(D),M=n(300),F=n.n(M);
/*!
 * 将平铺的文件数组数据转换成树形结构，clone自 https://github.com/nknapp/tree-from-paths
 *
 * tree-from-paths <https://github.com/nknapp/tree-from-paths>
 *
 * Copyright (c) 2017 Nils Knappmeier.
 * Released under the MIT license.
 */
function H(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return{label:r.label||"",nodes:U(e,t,n,e,t)}}function U(e,t,n,r,o){var a=F()(e,(function(e){return e.match(/^[^/]*\/?/)}));return Object.keys(a).map((function(e){var i=a[e],c=i.indexOf(e)>=0,l=-1;return c&&(l=r.indexOf(t.replace(o,"")+e)),{label:n(t,e,c,c?l:-1),nodes:U(i.map((function(t){return t.substr(e.length)})).filter((function(e){return e})),t+e,n,r,o)}}))}var z=H,G=n(1524),q=n(1596);function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function W(e){return Z(e)||J(e)||K(e)||$()}function $(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function K(e,t){if(e){if("string"==typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?X(e,t):void 0}}function J(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Z(e){if(Array.isArray(e))return X(e)}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ee(e,t,n){return t&&Y(e.prototype,t),n&&Y(e,n),e}function te(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ne(e,t)}function ne(e,t){return(ne=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function re(e){var t=ie();return function n(){var r=ce(e),o;if(t){var a=ce(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return oe(this,o)}}function oe(e,t){return!t||"object"!==V(t)&&"function"!=typeof t?ae(e):t}function ae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ie(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ue=function(e){te(n,e);var t=re(n);function n(e){var r;return Q(this,n),le(ae(r=t.call(this,e)),"toggleTreeCollapse",(function(e){var t=W(r.state.collapseTreeItemArr),n=t.findIndex((function(t){return t===e}));n>-1?t.splice(n,1):t.push(e),r.setState({collapseTreeItemArr:t})})),le(ae(r),"renderTree",(function(e,t,n){return e.length?o.a.createElement("div",null,r.treeLoop(t)):n?o.a.createElement("div",{className:"diff-loading"},o.a.createElement(l.Loading,{visible:!0,style:{height:"100px"}})):o.a.createElement("div",{className:"no-data"},o.a.createElement(B.a,{content:"\u6ca1\u6709\u6587\u4ef6\u6539\u52a8",imgType:"data"}))})),r.state={searchText:"",collapseTreeItemArr:[]},r}return ee(n,[{key:"componentDidMount",value:function e(){var t,n=document.querySelector(".has-aonel-notice")?70:45,r=Math.max(document.documentElement.clientHeight,window.innerHeight||0),o=42,a=15,i=document.querySelector(".changes-left");i&&(i.style["max-height"]="".concat(r-42-15-n,"px"))}},{key:"treeLoop",value:function e(t){var n=this,r=this.props,a=r.diffs,i=r.diffsSha1Map,c=r.hash,s=r.isShowReadMark,f=c.file,m=f?i[f]:a[0].new_path;return t.nodes.length?o.a.createElement("div",null,t.nodes.map((function(e){var t=a.find((function(t){return t.new_path===e.label.path})),r=n.state.collapseTreeItemArr.find((function(t){return t===e.label.name})),i;return e.label.isFile&&(i=t.new_file?o.a.createElement(u.a,{size:"small",biz:"code",type:"file-addition",className:"file-icon-add changes-tree-item-icon"}):t.deleted_file?o.a.createElement(u.a,{size:"small",biz:"code",type:"file-deletion",className:"file-icon-delete changes-tree-item-icon"}):o.a.createElement(u.a,{size:"small",type:"file-change",biz:"code",className:"file-icon-modify changes-tree-item-icon"})),o.a.createElement("div",{className:"changes-tree-item"},e.label.isFile?o.a.createElement("div",{className:"changes-tree-item-file"},o.a.createElement("a",{id:"tree_".concat(A()(e.label.path)),className:"changes-tree-item-file-name one-line-ellipsis text-black ".concat(m===e.label.path?"active":""),onClick:function t(){n.props.setHash(A()(e.label.path))},href:"#anchor_file_".concat(A()(e.label.path))},i,o.a.createElement(G.a,{name:e.label.name,filterText:n.state.searchText})),s&&!e.nodes.length?o.a.createElement("span",{className:"changes-tree-item-right"},t.add_lines?o.a.createElement(l.Balloon.Tooltip,{trigger:o.a.createElement("span",{className:"changes-tree-item-right-item add-lines"},"+",t.add_lines),align:"t",text:"\u589e\u52a0\u4e86".concat(t.add_lines,"\u884c")}):null,t.del_lines?o.a.createElement(l.Balloon.Tooltip,{trigger:o.a.createElement("span",{className:"changes-tree-item-right-item del-lines"},"-",t.del_lines),align:"t",text:"\u5220\u9664\u4e86".concat(t.del_lines,"\u884c")}):null,t.read?o.a.createElement(l.Balloon.Tooltip,{trigger:o.a.createElement(u.a,{className:"changes-tree-item-right-item mark-read-btn-read",type:"tick-o",size:"small",onClick:function e(){n.props.markFileAsUnRead(t.new_object_id)}}),align:"t",text:"\u6807\u8bb0\u4e3a\u672a\u8bfb"}):o.a.createElement(l.Balloon.Tooltip,{trigger:o.a.createElement(u.a,{className:"changes-tree-item-right-item mark-read-btn-unread",type:"circle",size:"small",onClick:function e(){n.props.markFileAsRead(t.new_object_id)}}),align:"t",text:"\u6807\u8bb0\u4e3a\u5df2\u8bfb"})):null):o.a.createElement("div",null,o.a.createElement("div",{className:"changes-tree-item-folder",title:e.label.name,onClick:function t(){n.toggleTreeCollapse(e.label.name)}},o.a.createElement(u.a,{type:"triangle-".concat(r?"right":"down","-s"),className:"changes-tree-item-folder-toggle",style:{marginLeft:12}}),o.a.createElement(u.a,{type:"folder",biz:"code",className:"changes-tree-item-icon",style:{fontSize:"14px",marginLeft:"2px",marginRight:"5px",verticalAlign:"text-bottom"}}),e.label.name),r?null:o.a.createElement("div",{className:"changes-tree-item-folder-children"},n.treeLoop(e))))}))):null}},{key:"render",value:function e(){var t=this.props,n=t.diffs,r=t.loading,a=this.state.searchText,i=n.filter((function(e){return-1!==e.new_path.toLowerCase().indexOf(a.toLowerCase())})),c=z(i.map((function(e){return e.new_path})),"",(function(e,t,n){return{path:"".concat(e).concat(t),name:"".concat(t),isFile:n}})),l=function e(t){!t.label||t.label.isFile||1!==t.nodes.length||t.nodes[0].label.isFile?t.nodes.length&&t.nodes.forEach((function(t){e(t)})):(t.label={path:t.nodes[0].label.path,name:t.label.name+t.nodes[0].label.name,isFile:t.nodes[0].label.isFile},t.nodes=t.nodes[0].nodes,e(t))};return c.nodes.length&&c.nodes.forEach((function(e){l(e)})),o.a.createElement("div",{className:"commit-change-tree changes-tree"},this.renderTree(i,c,r))}}]),n}(r.Component);le(ue,"propTypes",{diffs:i.a.array,diffsSha1Map:i.a.object,loading:i.a.bool,hash:i.a.object,markFileAsUnRead:i.a.func,markFileAsRead:i.a.func,isShowReadMark:i.a.bool,setHash:i.a.func}),le(ue,"defaultProps",{diffs:[],diffsSha1Map:{},loading:!1,hash:{},markFileAsUnRead:function e(){},markFileAsRead:function e(){},isShowReadMark:!1,setHash:function e(){}});var se=n(1597),fe=n(6),me=n(1490),pe=n(1465);function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function ye(){return(ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function he(e){return we(e)||ve(e)||ge(e)||be()}function be(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ge(e,t){if(e){if("string"==typeof e)return Ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ee(e,t):void 0}}function ve(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function we(e){if(Array.isArray(e))return Ee(e)}function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(n),!0).forEach((function(t){xe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function je(e,t,n){return t&&Ce(e.prototype,t),n&&Ce(e,n),e}function Pe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ke(e,t)}function ke(e,t){return(ke=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function Ie(e){var t=Be();return function n(){var r=Te(e),o;if(t){var a=Te(this).constructor;o=Reflect.construct(r,arguments,a)}else o=r.apply(this,arguments);return Ne(this,o)}}function Ne(e,t){return!t||"object"!==de(t)&&"function"!=typeof t?Re(e):t}function Re(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Be(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Te(e){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Le=l.Tag.Colorable,De=function(e){Pe(n,e);var t=Ie(n);function n(e){var r;return Se(this,n),xe(Re(r=t.call(this,e)),"onScroll",(function(){for(var e=document.querySelectorAll(".commit-right-content .diff-panel-wrapper"),t=r.getDistance(),n=e[0],o=0;o<e.length;o++){var a=e[o],i=a.getBoundingClientRect(),c;if(i.top>t||i.bottom>t){n=a;break}}if(n){var l=n.getAttribute("id"),u=l?l.replace("anchor_file_",""):"";document.querySelectorAll(".changes-tree-item-file-name.active").forEach((function(e){return e.classList.remove("active")})),document.getElementById("tree_".concat(u)).classList.add("active")}})),xe(Re(r),"getDistance",(function(){var e=0;if(r.props.isInCommitDetail){var t=document.querySelector(".commit-detail-header"),n=document.querySelector(".commit-right-content-title");e=(t?t.offsetHeight:0)+(n?n.offsetHeight:0)}else{var o=document.querySelector(".tb-navigator-container"),a=document.querySelector(".project-fix-tab");e=(o?o.offsetHeight:0)+(a?a.offsetHeight:0)}return e})),xe(Re(r),"setHash",(function(e){r.setState({hash:_e(_e({},r.state.hash),{},{file:e})})})),xe(Re(r),"computeHeight",(function(){var e=document.querySelector(".left-tree-content");if(e)if(r.props.showCommentList){var t=document.querySelector(".commit-detail-page"),n=document.querySelector(".commit-detail-header"),o=document.querySelector("#comment-wrapper"),a=o&&o.offsetHeight||0,i=t&&t.offsetHeight||0,c=n&&n.offsetHeight||0,l=20;e.style.height="".concat(i-a-c-20,"px")}else e.style.borderBottom="0px"})),xe(Re(r),"loadMoreLines",(function(e){var t=_e(_e({},e),{},{commitId:r.props.commitId});Object(s.A)(t).then((function(t){var n=e.hunk,o=e.diff,a=e.from,i=e.to,c=e.isAddToEnd,l=e.isLoadEndFinished,u={hunk:n,diff:o,blob:t.content,from:a,to:i,isAddToEnd:c,isLoadEndFinished:l};r.handleReceiveLines(u)})).catch((function(e){console.error(e)}))})),xe(Re(r),"handleReceiveLines",(function(e){var t=e.blob,n=e.hunk,o=e.diff,a=e.isAddToEnd,i=e.isLoadEndFinished,c=o.newPath,l=he(r.props.diffs),u=t.replace(/\n$/,"").split("\n"),s=u.length,f=u.join("\n "),m=n.newLines,p=n.newStart,d=n.oldLines,y=n.oldStart;l.forEach((function(e){if(e.new_path===c){var t,r=e.diff.split("\n").find((function(e){return 0===e.indexOf(n.content)}));if("STUB"===n.content)u.length<20?(e.loadEndFinished=!0,f&&(e.diff="".concat(e.diff,"\n ").concat(f))):(e.diff="".concat(e.diff,"\n ").concat(f),e.lastLineNum=e.lastLineNum?e.lastLineNum+s:p+s,i&&(e.loadEndFinished=!0));else if(a){var l=e.diff.split(r),h=o.hunks.findIndex((function(e){return 0===r.indexOf(e.content)}))-1,b=o.hunks[h],g=b.content,v=l[0].split(g),w="@@ -".concat(b.oldStart,",").concat(b.oldLines+s," +").concat(b.newStart,",").concat(b.newLines+s," @@");e.diff="".concat(v[0]).concat(w).concat(v[1],"\n ").concat(f,"\n").concat(r).concat(l[1])}else{var E="@@ -".concat(y-s>0?y-s:1,",").concat(d+s," +").concat(p-s>0?p-s:1,",").concat(m+s," @@"),O=e.diff.split(r);e.diff="".concat(O[0]).concat(E,"\n ").concat(f).concat(O[1])}}})),r.props.onChange(l,"diffs")})),xe(Re(r),"toggleViewType",(function(e){r.setState({forceDiffViewType:e}),c.b.setCachedData("forceDiffViewType",e)})),xe(Re(r),"manualLoadDiff",(function(e){var t=he(r.props.diffs);t.forEach((function(t){t.new_path===e.new_path&&(t.diff=t.originalDiff)})),r.props.onChange(t,"diffs")})),xe(Re(r),"handleHidePanel",(function(e,t){e.stopPropagation(),e.preventDefault();var n=he(r.state.hideArray);n[t]=!n[t],r.setState({hideArray:n})})),xe(Re(r),"renderImgJsx",(function(e,t,n){var r=window.FORCE.pathResource;return o.a.createElement("div",{className:"diff-single-img ".concat(n)},o.a.createElement("img",{src:"/".concat(r.fullPath,"/raw/").concat(c.b.revisionEncodeURI(e),"/").concat(t),style:{maxWidth:"90%"}}))})),xe(Re(r),"renderBinary",(function(e){var t=r.props,n=t.fromBranch,a=t.commitId,i=t.isInCommitDetail,l=t.curCommitInfo,u=n,s;return i&&l.parent_ids&&l.parent_ids.length&&(u=l.parent_ids[0]),e.is_binary&&c.b.isImageSuffix(e.deleted_file?e.old_path:e.new_path)&&u?e.deleted_file?r.renderImgJsx(u,e.old_path,"delete"):e.new_file?r.renderImgJsx(a,e.new_path,"new"):o.a.createElement("div",{className:"diff-img-wraper"},r.renderImgJsx(u,e.old_path,"delete"),r.renderImgJsx(a,e.new_path,"new")):e.is_old_lfs||e.is_new_lfs?r.renderLfsFile():o.a.createElement("div",{className:"binary-placeholder"},"\u6587\u4ef6\u5185\u5bb9\u8fc7\u5927\u6216\u4e3a\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u6682\u4e0d\u652f\u6301\u6bd4\u8f83")})),xe(Re(r),"renderLfsFile",(function(){return o.a.createElement("div",{className:"binary-placeholder"},"\u6682\u4e0d\u652f\u6301Git LFS\u6587\u4ef6\u6bd4\u8f83")})),xe(Re(r),"renderDiffContent",(function(){var e=r.state.forceDiffViewType,t=r.props,n=t.diffs,a=t.curCommitInfo,i=t.commitId,c={viewType:e,loadMoreLines:r.loadMoreLines,manualLoadDiff:r.manualLoadDiff};return n.map((function(t,n){var s=t.deleted_file&&a.parent_ids?a.parent_ids[0]:a.sha||a.id||i,f=L.a.getSingleDiffsCount(t),m=r.state.hideArray;t.isHidden=m&&m[n];var p=t.is_new_lfs||t.is_old_lfs,d=window.FORCE,y=d.pathResource,h=d.resourceSubject;return o.a.createElement(T.a,{id:"anchor_file_".concat(A()(t.new_path)),className:"diff-panel-wrapper"},o.a.createElement(T.a.Header,null,o.a.createElement("div",{className:"commit-detail-file-header"},o.a.createElement("div",{className:"commit-detail-file-header-left ".concat(e)},o.a.createElement("a",{className:"text-black"},o.a.createElement(x.a,{item:t,onChange:function e(t){r.handleHidePanel(t,n)}})),p&&!t.deleted_file&&o.a.createElement(pe.a,{role:h&&"compare"===h.subject?y.role:""}),p&&t.deleted_file&&o.a.createElement(me.a,null)),o.a.createElement("div",{className:"commit-detail-file-header-right"},f?o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{className:"add-num"},"+ ",f.additions),o.a.createElement("span",{className:"delete-num"},"- ",f.deletions)):null,!t.deleted_file&&s?o.a.createElement(l.Button.Icon,{type:"secondary",component:"a",color:"gray",href:"/".concat(y.fullPath,"/blob/").concat(s,"/").concat(t.new_path),target:"_blank",onClick:function e(){r.props.isInCommitDetail&&Object(fe.b)({action:"view_commit_source_file",page:"Modal-Commit",type:"",control:"file"})}},o.a.createElement(u.a,{type:"folder-open",biz:"code"})):null))),o.a.createElement(T.a.Body,{noPadding:!0},o.a.createElement("div",{style:{display:t.isHidden?"none":"block"}},t.is_binary?r.renderBinary(t):o.a.createElement(o.a.Fragment,null,p?r.renderLfsFile():o.a.createElement(R,ye({},c,{diff:t}))))))}))})),xe(Re(r),"renderComment",(function(){var e=r.props.commentList;return o.a.createElement(o.a.Fragment,null,e.map((function(e){return o.a.createElement("div",{className:"comment-item"},o.a.createElement("div",{className:"comment-image"},o.a.createElement(m.a,{text:e.username,image:e.avatar_url,size:"xs",radius:"50%"}),o.a.createElement(u.a,{type:"tick-o-fill"})),o.a.createElement("div",{className:"comment-content"},o.a.createElement("div",{className:"comment-content-note"},e.note),o.a.createElement("div",{className:"comment-content-time"},o.a.createElement("span",null,c.b.getBeautyTime(e.created_at))," ",o.a.createElement("span",{className:"apply-btn"},"\u56de\u590d"))))})))})),xe(Re(r),"getDiffsSha1Map",(function(e){if(!e||!e.length)return{};var t={};return e.forEach((function(e){t[A()(e.new_path)]=e.new_path})),t})),r.state={forceDiffViewType:c.b.getCachedData("forceDiffViewType")||"unified",hideArray:null,hash:{}},r}return je(n,[{key:"componentDidMount",value:function e(){if(this.computeHeight(),this.props.isInCommitDetail){var t=document.querySelector(".commit-right-content");t&&t.addEventListener("scroll",this.onScroll)}}},{key:"componentDidUpdate",value:function e(t,n){var r=this.state.hash.file;if(r!==n.hash.file){var o=document.querySelector("#anchor_file_".concat(r)),a=o.offsetTop-this.getDistance();o&&(this.props.isInCommitDetail?document.querySelector(".commit-right-content").scrollTop=a:document.scrollingElement.scrollTop=a)}else{var i=document.querySelectorAll(".changes-tree-item-file-name.active");i&&i.forEach((function(e){return e.classList.remove("active")}));var c=document.getElementById("tree_".concat(r));if(c)c.classList.add("active");else{if(!this.props.diffs[0])return;var l=A()(this.props.diffs[0].new_path),u;document.getElementById("tree_".concat(l)).classList.add("active")}}}},{key:"render",value:function e(){var t=this,n=this.state,r=n.forceDiffViewType,a=n.hash,i=this.props,c=i.diffs,u=i.loading,s=i.errorInfo,f=L.a.getDiffsCount(c),m=this.getDiffsSha1Map(c);return s?o.a.createElement(B.a,{content:s,imgType:"data"}):c.length?o.a.createElement("div",{className:"commit-detail-bottom"},o.a.createElement("div",{className:"commit-left-tree"},o.a.createElement("div",{className:"left-tree-content"},o.a.createElement("div",{className:"tree-wrapper"},o.a.createElement("div",{className:"left-tree-bottom"},o.a.createElement(ue,{diffs:c,loading:u,diffsSha1Map:m,hash:a,setHash:this.setHash}))))),o.a.createElement("div",{className:"commit-right-content"},o.a.createElement("div",{className:"commit-right-content-title"},o.a.createElement("div",{className:"commit-right-content-title-left"},o.a.createElement("span",{className:"tree-title"},"\u6539\u52a8\u6587\u4ef6\xa0(",c.length,")"),f?o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{className:"add-num"},o.a.createElement(Le,{color:"green"},"+",f.additions)),o.a.createElement("span",{className:"delete-num"},o.a.createElement(Le,{color:"red"},"-",f.deletions))):null),o.a.createElement(l.Tab,{size:"small",shape:"capsule",activeKey:r,style:{width:"inherit"}},o.a.createElement(l.Tab.Item,{key:"unified",title:"\u5355\u680f",onClick:function e(){t.toggleViewType("unified")}}),o.a.createElement(l.Tab.Item,{key:"split",title:"\u53cc\u680f",onClick:function e(){t.toggleViewType("split")}}))),this.renderDiffContent(),o.a.createElement("div",null))):o.a.createElement(B.a,{content:"\u6ca1\u6709\u6587\u4ef6\u6539\u52a8",imgType:"data"})}}],[{key:"getDerivedStateFromProps",value:function e(t,n){var r;if(!n.hideArray)return{hideArray:t.diffs.map((function(e,t){return t>9}))}}}]),n}(o.a.Component);xe(De,"propTypes",{commitId:i.a.string,onChange:i.a.func,diffs:i.a.array,curCommitInfo:i.a.object,isInCommitDetail:i.a.bool,fromBranch:i.a.string}),xe(De,"defaultProps",{commitId:"",onChange:function e(){},diffs:[],curCommitInfo:{},isInCommitDetail:!1,fromBranch:""})},1595:function(e,t,n){},1596:function(e,t,n){},1597:function(e,t,n){},1598:function(e,t,n){},1599:function(e,t,n){},1600:function(e,t,n){}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{1448:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n(0),a=n.n(r),o=n(3),c=n.n(o),i=n(1),u=n.n(i),l=n(1451),s=n.n(l);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function f(e,t){if(null==e)return{};var n=m(e,t),r,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function m(e,t){if(null==e)return{};var n={},r=Object.keys(e),a,o;for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t,n){return t&&y(e.prototype,t),n&&y(e,n),e}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}function g(e,t){return(g=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function v(e){var t=E();return function n(){var r=j(e),a;if(t){var o=j(this).constructor;a=Reflect.construct(r,arguments,o)}else a=r.apply(this,arguments);return _(this,a)}}function _(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?w(e):t}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=function(e){h(n,e);var t=v(n);function n(){var e;d(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return O(w(e=t.call.apply(t,[this].concat(a))),"prefix","code-popup"),e}return b(n,[{key:"render",value:function e(){var t=this.props,n=t.footer,r=t.children,o=f(t,["footer","children"]);return a.a.createElement(i.Overlay.Popup,o,a.a.createElement("div",{className:this.prefix},a.a.createElement("div",{className:"".concat(this.prefix,"-body")},r),n?a.a.createElement("div",{className:"".concat(this.prefix,"-footer")},n):null))}}]),n}(a.a.Component);O(S,"propTypes",{footer:c.a.node})},1449:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(0),a=n.n(r);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function s(e,t){return(s=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function p(e){var t=d();return function n(){var r=y(e),a;if(t){var o=y(this).constructor;a=Reflect.construct(r,arguments,o)}else a=r.apply(this,arguments);return f(this,a)}}function f(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?m(e):t}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){return function(t){l(r,t);var n=p(r);function r(){var e;c(this,r);for(var t=arguments.length,a=new Array(t),o=0;o<t;o++)a[o]=arguments[o];return b(m(e=n.call.apply(n,[this].concat(a))),"state",{show:!1}),e}return u(r,[{key:"componentDidMount",value:function e(){var t=this;setTimeout((function(){t.setState({show:!0})}),300)}},{key:"render",value:function t(){var n;return this.state.show?a.a.createElement(e,this.props):null}}]),r}(a.a.Component)}},1450:function(e,t,n){},1451:function(e,t,n){},1470:function(e,t,n){"use strict";n.d(t,"a",(function(){return V}));var r=n(0),a=n.n(r),o=n(3),c=n.n(o),i=n(1),u=n.n(i),l=n(8),s=n(7),p=n(165),f=n(1421),m=n.n(f),d=n(11),y=n(1568),b=n.n(y),h=n(289),g=n(9),v=n(13),_=n(6),w=n(1471);function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t,n){return t&&O(e.prototype,t),n&&O(e,n),e}function T(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}function R(e,t){return(R=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function C(e){var t=D();return function n(){var r=A(e),a;if(t){var o=A(this).constructor;a=Reflect.construct(r,arguments,o)}else a=r.apply(this,arguments);return P(this,a)}}function P(e,t){return!t||"object"!==E(t)&&"function"!=typeof t?k(e):t}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=i.Balloon.Tooltip,x=window.FORCE.pathResource,F=i.Tag.Colorable,N={opened:"green",reopened:"green",accepted:"green",merged:"gray",closed:"red"},X={opened:"mr-waiting",reopened:"mr-waiting",accepted:"pull-request-pass",merged:"merge",closed:"pull-request-closed"},K={opened:"\u5df2\u5f00\u542f\xb7\u672a\u8fbe\u5230\u5408\u5e76\u8981\u6c42",reopened:"\u5df2\u5f00\u542f\xb7\u672a\u8fbe\u5230\u5408\u5e76\u8981\u6c42",accepted:"\u5df2\u5f00\u542f\xb7\u53ef\u5408\u5e76",merged:"\u5df2\u5408\u5e76",closed:"\u5df2\u5173\u95ed"},V=function(e){T(n,e);var t=C(n);function n(){return j(this,n),t.apply(this,arguments)}return S(n,[{key:"getTag",value:function e(t){var n;switch(t.state){case"opened":case"reopened":return a.a.createElement(I,{trigger:a.a.createElement(l.a,{type:"info-o"}),align:"t",text:"\u672a\u8fbe\u5230\u5408\u5e76\u8981\u6c42"});case"accepted":return a.a.createElement(I,{trigger:a.a.createElement(l.a,{type:"tick-o"}),align:"t",text:"\u53ef\u5408\u5e76"});default:return""}}},{key:"getCRContentByType",value:function e(t,n){return"COMMIT"===n?s.b.showShortSha(t):t}},{key:"render",value:function e(){var t=this.props,n=t.codeReview,r=t.projectInfo,o,c;if(!n)return!1;if(n.assignees.forEach((function(e){switch(e.avatar_url&&(e.avatarUrl=e.avatar_url),e.status){case"approved":e.statusText="\u5df2\u901a\u8fc7",e.marker=a.a.createElement("div",{className:"mr-overview-avatar-marker commented"},a.a.createElement("img",{src:"https://img.alicdn.com/tfs/TB1.4QPii_1gK0jSZFqXXcpaXXa-24-24.png",alt:""}));break;case"comment":e.statusText="\u5df2\u8bc4\u8bba",e.marker=a.a.createElement("div",{className:"mr-overview-avatar-marker reviewed"},a.a.createElement("img",{src:"https://img.alicdn.com/tfs/TB1THZNieL2gK0jSZPhXXahvXXa-24-24.png",alt:""}));break;case"pending":e.statusText="\u672a\u901a\u8fc7",e.marker=a.a.createElement("div",{className:"mr-overview-avatar-marker not-reviewed"},a.a.createElement("img",{src:"https://img.alicdn.com/tfs/TB1kVgRihv1gK0jSZFFXXb0sXXa-24-24.png",alt:""}));break;default:e.statusText="",e.marker=null}})),n.repoPath)c="/".concat(n.repoPath),o=a.a.createElement("span",{className:"media-secondary-info-item"},a.a.createElement("a",{href:c,target:"_blank"},n.repoPath));else if(!x||!x.id||x&&"GROUP"===x.type){var u,f=new URL(n.web_url).pathname;c=f,o=a.a.createElement(I,{trigger:a.a.createElement("span",{className:"media-secondary-info-item"},a.a.createElement("span",{href:"".concat(f),className:"cr-list-item-repo",target:"_blank"},g.a?n.name_with_namespace:s.b.getGroupPath(n.name_with_namespace)))},"\u4ee3\u7801\u5e93\uff1a",g.a?n.name_with_namespace:s.b.getGroupPath(n.name_with_namespace))}else c="/".concat(x.fullPath);var y="".concat(c,"/merge_request/").concat(n.id),b=n.attributes&&n.attributes.length&&"merge_request_time"===n.attributes[0].attributeType?JSON.parse(n.attributes[0].attributeInfo).time_doc:"",E=!0===n.is_auto_create||"true"===n.is_auto_create,j=[o||null,a.a.createElement(I,{trigger:a.a.createElement("span",{className:"cr-list-item-branch-container"},a.a.createElement("span",{href:"".concat(c,"/tree/").concat(s.b.revisionEncodeURI(n.source_branch)),className:"cr-list-item-branch",target:"_blank"},this.getCRContentByType(n.source_branch,n.source_type))," ",a.a.createElement(l.a,{type:"sharp-right",biz:"code",size:"small",className:"cr-list-icon"})," ",a.a.createElement("span",{href:"".concat(c,"/tree/").concat(s.b.revisionEncodeURI(n.target_branch)),className:"cr-list-item-branch",target:"_blank"},this.getCRContentByType(n.target_branch,n.target_type))),closable:!1},a.a.createElement("span",null,"\u4ece"," ",this.getCRContentByType(n.source_branch,n.source_type)," ","\u5408\u5e76\u5230"," ",this.getCRContentByType(n.target_branch,n.target_type))),a.a.createElement("span",{title:"".concat(E?"\u4e91\u8c46 bot":n.author.name," \u521b\u5efa\u4e8e ").concat(s.b.getBeautyTime(n.created_at,window.FORCE.locale,"simple"))},a.a.createElement("a",null,E?a.a.createElement(w.a,null):n.author.name),a.a.createElement("span",null," ","\u521b\u5efa\u4e8e"," ",s.b.getBeautyTime(n.created_at,window.FORCE.locale,"simple")))],O=null;b&&(O="unsupported"===b?a.a.createElement(i.Balloon.Tooltip,{trigger:a.a.createElement("span",null,"\u6682\u65e0\u9884\u4f30"),align:"t"},"\u6587\u4ef6\u7c7b\u578b\u6682\u4e0d\u652f\u6301\u9884\u4f30\uff0c\u67e5\u770b",a.a.createElement("a",{href:Object(v.a)("\u8bc4\u5ba1\u8017\u65f6\u9884\u4f30"),target:"_blank",style:{color:"#488ee2"}},"\u670d\u52a1\u8bf4\u660e")):b.startsWith(">")?a.a.createElement(i.Balloon.Tooltip,{trigger:a.a.createElement("span",null,"\u5927\u4e8e ".concat(b.slice(1)," \u5206\u949f")),align:"t"},"\u9884\u4f30\u8bc4\u5ba1\u8017\u65f6\u5927\u4e8e ",b.slice(1)," \u5206\u949f"):a.a.createElement(i.Balloon.Tooltip,{trigger:a.a.createElement("span",null,"\u7ea6 ".concat(b," \u5206\u949f")),align:"t"},"\u9884\u4f30\u8bc4\u5ba1\u8017\u65f6\u7ea6 ",b," \u5206\u949f"));var S={left:a.a.createElement(I,{trigger:a.a.createElement("div",{className:"cr-left"},a.a.createElement(l.a,{type:X[n.state],style:{color:"".concat(N[n.state])},biz:"code"})),align:"t",text:K[n.state]}),body:{title:[a.a.createElement("span",{className:"cr-title"},n.title),b?a.a.createElement("span",{style:{marginLeft:8}},a.a.createElement(F,{color:"blue",style:{margin:0}},a.a.createElement(l.a,{type:"clock"})," ",O)):null,a.a.createElement("span",{onClick:function e(t){t.preventDefault()}},a.a.createElement(h.a,{container:{target:"merge_request",id:n.id,projectId:n.project_id},projectInfo:r}))],description:j},right:{items:[n.assignees?a.a.createElement("span",{onClick:function e(){Object(d.d)(y)}},a.a.createElement(m.a,{dataSource:n.assignees})):null],timeItems:[a.a.createElement("span",{style:{lineHeight:"42px"},onClick:function e(){Object(d.d)(y)}},"\u66f4\u65b0\u4e8e"," ",s.b.getBeautyTime(n.updated_at,window.FORCE.locale,"simple"))]},container:d.a,containerProps:{to:"".concat(c,"/merge_request/").concat(n.id),onClick:function e(){Object(_.b)({action:"open_mr",page:"Repo-MR-changes",type:"",control:"",mr_id:n.id,user_id:window.FORCE.user?window.FORCE.user.codeUserId:"",tb_user_id:window.FORCE.user?window.FORCE.user.id:""})}}};return a.a.createElement(p.default.Item,{className:"cr-list-item",dataSource:S})}}]),n}(a.a.Component);B(V,"propTypes",{codeReview:c.a.arrayOf(c.a.object),projectInfo:c.a.object})},1471:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n(0),a=n.n(r),o=n(1),c=n.n(o),i=n(166),u=n.n(i),l=n(1481),s=n.n(l);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),e}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}function b(e,t){return(b=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function h(e){var t=_();return function n(){var r=w(e),a;if(t){var o=w(this).constructor;a=Reflect.construct(r,arguments,o)}else a=r.apply(this,arguments);return g(this,a)}}function g(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?v(e):t}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var E=o.Tag.Colorable,j=function(e){y(n,e);var t=h(n);function n(){return f(this,n),t.apply(this,arguments)}return d(n,[{key:"render",value:function e(){var t;return this.props.hasAvatar?a.a.createElement(a.a.Fragment,null,a.a.createElement(u.a,{image:"https://img.alicdn.com/tfs/TB1WYSpIQL0gK0jSZFtXXXQCXXa-400-401.png",text:"\u4e91\u8c46",needAddedText:!0,size:"xs"}),a.a.createElement("span",{className:"log-item-title-author-tag"},a.a.createElement(E,{color:"gray"},"bot"))):a.a.createElement("span",{className:"yundou-name-inline"},"\u4e91\u8c46",a.a.createElement("span",{className:"log-item-title-author-tag"},a.a.createElement(E,{color:"gray"},"bot")))}}]),n}(a.a.PureComponent)},1481:function(e,t,n){},1482:function(e,t,n){"use strict";n.d(t,"a",(function(){return U}));var r=n(0),a=n.n(r),o=n(1),c=n.n(o),i=n(8),u=n(5),l=n(30),s=n(1448),p=n(6),f=n(4),m=n(17),d=n(7),y=n(9),b=n(727),h=n.n(b);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function _(e){return O(e)||j(e)||E(e)||w()}function w(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function E(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function j(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function O(e){if(Array.isArray(e))return S(e)}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t,n){return t&&R(e.prototype,t),n&&R(e,n),e}function P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}function k(e,t){return(k=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function D(e){var t=I();return function n(){var r=x(e),a;if(t){var o=x(this).constructor;a=Reflect.construct(r,arguments,o)}else a=r.apply(this,arguments);return A(this,a)}}function A(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?B(e):t}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var N=window.FORCE,X=N.user,K=N.pathResource,V=o.Balloon.Tooltip,G=[{name:X.nickname||X.realName,_userId:X.id}],L={labelCol:{span:6},wrapperCol:{fixedSpan:12}},M=function e(t,n){var a=r.createElement("span",null,"".concat(t.length,"/").concat(n.length)),o=t.map((function(e){return e.label}));return r.createElement(V,{trigger:a},o.join(", "))},U=function(e){P(n,e);var t=D(n);function n(e){var r;return T(this,n),F(B(r=t.call(this,e)),"dataTrack",(function(){var e=r.state.pageType;"project"===e?Object(p.b)({action:"filter_mr",page:"Repo-MRs"}):"group"===e?Object(p.b)({action:"filter_mr",page:"Group-MRs"}):Object(p.b)({action:"filter_mr",page:"Organization-MRs-All"})})),F(B(r),"setAdvancedSearchDataAndDoSearch",(function(){r.field.validate((function(e){if(!e){var t=r.field.getValues();t.author_tb_ids&&(t.author_tb_ids=t.author_tb_ids.join(",")),"project"===r.state.pageType?t.project_ids=K.id:"group"===r.state.pageType?(t.group_ids=K.id,t.project_ids&&(t.project_ids=t.project_ids.join(","))):(t.project_ids&&(t.project_ids=t.project_ids.join(",")),t.group_ids&&(t.group_ids=t.group_ids.join(","))),t.assignee_tb_ids&&(t.assignee_tb_ids=t.assignee_tb_ids.join(",")),r.props.setAdvancedSearch(t)}}))})),F(B(r),"resetFormByNavKeyAndTabkey",(function(){var e=r.props,t=e.navKey,n=e.tabKey,a;if("project"===r.state.pageType)a={state:n,project_ids:null,author_tb_ids:null,assignee_tb_ids:null},r.field.setValues(a),r.setState({authorData:[],assigneeData:[],subscriberData:[],initFormValues:a});else if("group"===r.state.pageType)a={state:n,project_ids:null,author_tb_ids:null,assignee_tb_ids:null,group_ids:null},r.field.setValues(a),r.setState({authorData:[],assigneeData:[],subscriberData:[],initFormValues:a});else{var o=G.map((function(e){return e._userId||e.tb_user_id}));a={state:n,project_ids:null,author_tb_ids:"created"===t?o:null,assignee_tb_ids:"reviewed"===t?o:null},r.field.setValues(a);var c=[],i=[],u=[];"created"===t?(c=G,r.setState({couldChangeAuthor:!1})):(c=[],r.setState({couldChangeAuthor:!0})),"all"===t&&(c=1===r.state.authorData.length&&r.state.authorData[0]._userId===X.id?[]:r.state.authorData),"reviewed"===t?(i=G,r.setState({couldChangeAssignee:!1})):(i=[],r.setState({couldChangeAssignee:!0})),"all"===t&&(i=1===r.state.assigneeData.length&&r.state.assigneeData[0]._userId===X.id?[]:r.state.assigneeData),"cc"===t&&(u=r.state.subscriberData),"all"===t&&(u=1===r.state.subscriberData.length&&r.state.subscriberData[0]._userId===X.id?[]:r.state.subscriberData),r.setState({authorData:c,assigneeData:i,subscriberData:u,initFormValues:a})}})),F(B(r),"onAuthorChange",(function(e){r.setState({authorData:e}),r.field.setValue("author_tb_ids",e.map((function(e){return e._userId}))),r.setAdvancedSearchDataAndDoSearch()})),F(B(r),"onSubscriberChange",(function(e){r.setState({subscriberData:e}),r.field.setValue("subscriber_tb_ids",e.map((function(e){return e._userId}))),r.setAdvancedSearchDataAndDoSearch()})),F(B(r),"onAssigneeChange",(function(e){r.setState({assigneeData:e}),r.field.setValue("assignee_tb_ids",e.map((function(e){return e._userId}))),r.setAdvancedSearchDataAndDoSearch()})),F(B(r),"onProjectList",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;f.a.fetch({api:"projects.authorizedList",data:{contains_sub_projects:!0,search:e,size:t,order_by:"last_activity_at"}}).then((function(e){e.shift();var n=[{label:"\u6700\u8fd1\u66f4\u65b0",children:[]}],a;e&&e.length&&(a=n[0].children).push.apply(a,_(e.slice(0,t).map((function(e){return{label:y.a?d.b.getGroupPath(e.name_with_namespace):e.name,value:e.id,name_with_namespace:y.a?e.name_with_namespace:d.b.getGroupPath(e.name_with_namespace)}}))));r.setState({repoDataSource:n})}))})),F(B(r),"onGroupSubProjectList",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;f.a.fetch({api:"groups.all.subprojects",data:{namespace_id:K.id,search:e,size:t,order_by:"last_activity_at"}}).then((function(e){e.shift();var n=[{label:"\u6700\u8fd1\u66f4\u65b0",children:[]}],a;e&&e.length&&(a=n[0].children).push.apply(a,_(e.slice(0,t).map((function(e){return{label:y.a?d.b.getGroupPath(e.name_with_namespace):e.name,value:e.id,name_with_namespace:y.a?e.name_with_namespace:d.b.getGroupPath(e.name_with_namespace)}}))));r.setState({repoDataSource:n})}))})),F(B(r),"onResetClick",(function(){r.resetFormByNavKeyAndTabkey(),r.setAdvancedSearchDataAndDoSearch()})),F(B(r),"getBadgeDot",(function(){var e=r.field.getValues(),t=r.state.initFormValues;return!!e&&!h()(e,t)})),r.field=new o.Field(B(r),{onChange:function e(){r.dataTrack(),r.setAdvancedSearchDataAndDoSearch()}}),r.state={pageType:null,authorData:G,couldChangeAuthor:!0,assigneeData:G,couldChangeAssignee:!0,subscriberData:G,repoDataSource:[],initFormValues:{}},r}return C(n,[{key:"componentDidMount",value:function e(){K&&"PROJECT"===K.type?(this.setState({pageType:"project"}),this.resetFormByNavKeyAndTabkey()):K&&"GROUP"===K.type?(this.setState({pageType:"group"}),this.onGroupSubProjectList(),this.resetFormByNavKeyAndTabkey()):(this.setState({pageType:"dashboard"}),this.onProjectList(),this.resetFormByNavKeyAndTabkey())}},{key:"componentDidUpdate",value:function e(t){"pmr"!==this.props.addr&&(this.props.navKey===t.navKey&&this.props.tabKey===t.tabKey||this.resetFormByNavKeyAndTabkey())}},{key:"render",value:function e(){var t=this,n=this.field,a=n.init,c=this.state,p=c.pageType,f=c.repoDataSource,d=K&&K.fullName?K.fullName.replace(" / ","/"):"",b=d.split("/")||[],h=this.getBadgeDot();return r.createElement(s.a,{trigger:r.createElement(o.Badge,{dot:h,className:"tab-extra-bar-item"},r.createElement(o.Button.Icon,{name:"filter",type:"primary",color:"gray"})),triggerType:"click",align:"tr br",footer:r.createElement(o.Form.Item,{style:{marginBottom:"0px"}},r.createElement(o.Form.Reset,{text:!0,type:"primary",style:{border:0},onClick:this.onResetClick,toDefault:!0,className:"advanced-search-form-btn"},r.createElement(i.a,{type:"trashbin"})," \u6e05\u9664\u6240\u6709\u7b5b\u9009\u6761\u4ef6"))},r.createElement(o.Form,v({},L,{labelTextAlign:"left",field:n}),"group"===p?r.createElement(o.Form.Item,{label:u.a.group},r.createElement(o.Input,{readOnly:!0,disabled:!0,value:y.a?d:b[1]||""})):null,r.createElement(o.Form.Item,{label:u.a.repository},"project"===p?r.createElement(o.Input,{readOnly:!0,disabled:!0,value:y.a?d:b[1]||""}):r.createElement(o.Select,v({},a("project_ids"),{mode:"multiple",showSearch:!0,followTrigger:!0,maxTagCount:4,placeholder:u.a.projects_cr_project_search,dataSource:f,onSearch:function e(n){t.dataTrack(),"group"===p?t.onGroupSubProjectList(n):t.onProjectList(n)},maxTagPlaceholder:M,popupProps:{className:"at-path-select-popup"},itemRender:function e(t){var n=t.name_with_namespace;return r.createElement(m.a,{path:n})}}))),r.createElement(o.Form.Item,{label:u.a.cr_author},this.state.couldChangeAuthor?r.createElement("div",{ref:function e(n){t.aucontainer=n}},r.createElement(l.a,{onChange:function e(n){t.dataTrack(),t.onAuthorChange(n)},value:this.state.authorData,container:function e(){return t.aucontainer},multiple:!0})):r.createElement(o.Input,{disabled:!0,value:this.state.authorData[0].name})),r.createElement(o.Form.Item,{label:u.a.projects_cr_reviewers},this.state.couldChangeAssignee?r.createElement("div",{ref:function e(n){t.recontainer=n}},r.createElement(l.a,{onChange:function e(n){t.dataTrack(),t.onAssigneeChange(n)},value:this.state.assigneeData,container:function e(){return t.recontainer},multiple:!0})):r.createElement(o.Input,{disabled:!0,value:this.state.assigneeData[0].name})),y.a&&r.createElement(o.Form.Item,{label:u.a.cr_subscriber},r.createElement("div",{ref:function e(n){t.sucontainer=n}},r.createElement(l.a,{onChange:function e(n){t.dataTrack(),t.onSubscriberChange(n)},value:this.state.subscriberData,container:function e(){return t.sucontainer},multiple:!0})))))}}]),n}(r.Component)},1568:function(e,t,n){}}]);